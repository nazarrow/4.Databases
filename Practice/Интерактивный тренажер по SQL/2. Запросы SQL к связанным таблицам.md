# 2. –ó–∞–ø—Ä–æ—Å—ã SQL –∫ —Å–≤—è–∑–∞–Ω–Ω—ã–º —Ç–∞–±–ª–∏—Ü–∞–º

## 2.1 –°–≤—è–∑–∏ –º–µ–∂–¥—É —Ç–∞–±–ª–∏—Ü–∞–º–∏

‚ú≥ –®–∞–≥ 6. 

‚ùì*–ó–∞–¥–∞–Ω–∏–µ. –°–æ–∑–¥–∞—Ç—å —Ç–∞–±–ª–∏—Ü—É author —Å–ª–µ–¥—É—é—â–µ–π —Å—Ç—Ä—É–∫—Ç—É—Ä—ã:*

|–ü–æ–ª–µ	|–¢–∏–ø, –æ–ø–∏—Å–∞–Ω–∏–µ|
|:---------------:|:---------------:|
|author_id	|INT PRIMARY KEY AUTO_INCREMENT|
|name_author	|VARCHAR(50)|

‚úî`–†–ï–®–ï–ù–ò–ï` ‚§µÔ∏è

```sql
CREATE TABLE author(
  author_id INT PRIMARY KEY AUTO_INCREMENT, 
  name_author VARCHAR(50)
);
```

üîé `–†–ï–ó–£–õ–¨–¢–ê–¢` ‚§µÔ∏è

`Affected rows: 0`

---

‚ú≥ –®–∞–≥ 7. 

‚ùì*–ó–∞–¥–∞–Ω–∏–µ. –ó–∞–ø–æ–ª–Ω–∏—Ç—å —Ç–∞–±–ª–∏—Ü—É author. –í –Ω–µ–µ –≤–∫–ª—é—á–∏—Ç—å —Å–ª–µ–¥—É—é—â–∏—Ö –∞–≤—Ç–æ—Ä–æ–≤:
-–ë—É–ª–≥–∞–∫–æ–≤ –ú.–ê.  
-–î–æ—Å—Ç–æ–µ–≤—Å–∫–∏–π –§.–ú.  
-–ï—Å–µ–Ω–∏–Ω –°.–ê.  
-–ü–∞—Å—Ç–µ—Ä–Ω–∞–∫ –ë.–õ.*

‚úî`–†–ï–®–ï–ù–ò–ï` ‚§µÔ∏è

```sql
INSERT INTO author (name_author) 
VALUES 
  ("–ë—É–ª–≥–∞–∫–æ–≤ –ú.–ê."), 
  (
    "–î–æ—Å—Ç–æ–µ–≤—Å–∫–∏–π –§.–ú."
  ), 
  ("–ï—Å–µ–Ω–∏–Ω –°.–ê."), 
  ("–ü–∞—Å—Ç–µ—Ä–Ω–∞–∫ –ë.–õ.");
SELECT 
  * 
FROM 
  author;
```

üîé `–†–ï–ó–£–õ–¨–¢–ê–¢` ‚§µÔ∏è

| author_id | name_author      |
|:---------------:|:---------------:|
| 1         | –ë—É–ª–≥–∞–∫–æ–≤ –ú.–ê.    |
| 2         | –î–æ—Å—Ç–æ–µ–≤—Å–∫–∏–π –§.–ú. |
| 3         | –ï—Å–µ–Ω–∏–Ω –°.–ê.      |
| 4         | –ü–∞—Å—Ç–µ—Ä–Ω–∞–∫ –ë.–õ.   |

---

‚ú≥ –®–∞–≥ 8. –°–æ–∑–¥–∞–Ω–∏–µ —Ç–∞–±–ª–∏—Ü—ã —Å –≤–Ω–µ—à–Ω–∏–º–∏ –∫–ª—é—á–∞–º–∏

‚ùì*–ó–∞–¥–∞–Ω–∏–µ. –ü–µ—Ä–µ–ø–∏—à–∏—Ç–µ –∑–∞–ø—Ä–æ—Å –Ω–∞ —Å–æ–∑–¥–∞–Ω–∏–µ —Ç–∞–±–ª–∏—Ü—ã book , —á—Ç–æ–±—ã –µ–µ —Å—Ç—Ä—É–∫—Ç—É—Ä–∞ —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤–æ–≤–∞–ª–∞ —Å—Ç—Ä—É–∫—Ç—É—Ä–µ, –ø–æ–∫–∞–∑–∞–Ω–Ω–æ–π –Ω–∞ –ª–æ–≥–∏—á–µ—Å–∫–æ–π —Å—Ö–µ–º–µ (—Ç–∞–±–ª–∏—Ü–∞ genre —É–∂–µ —Å–æ–∑–¥–∞–Ω–∞, –ø–æ—Ä—è–¥–æ–∫ —Å–ª–µ–¥–æ–≤–∞–Ω–∏—è —Å—Ç–æ–ª–±—Ü–æ–≤ - –∫–∞–∫ –Ω–∞ –ª–æ–≥–∏—á–µ—Å–∫–æ–π —Å—Ö–µ–º–µ –≤ —Ç–∞–±–ª–∏—Ü–µ book, genre_id  - –≤–Ω–µ—à–Ω–∏–π –∫–ª—é—á) . –î–ª—è genre_id –æ–≥—Ä–∞–Ω–∏—á–µ–Ω–∏–µ –æ –Ω–µ–¥–æ–ø—É—Å—Ç–∏–º–æ—Å—Ç–∏ –ø—É—Å—Ç—ã—Ö –∑–Ω–∞—á–µ–Ω–∏–π –Ω–µ –∑–∞–¥–∞–≤–∞—Ç—å. –í –∫–∞—á–µ—Å—Ç–≤–µ –≥–ª–∞–≤–Ω–æ–π —Ç–∞–±–ª–∏—Ü—ã –¥–ª—è –æ–ø–∏—Å–∞–Ω–∏—è –ø–æ–ª—è  genre_id–∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å —Ç–∞–±–ª–∏—Ü—É genre —Å–ª–µ–¥—É—é—â–µ–π —Å—Ç—Ä—É–∫—Ç—É—Ä—ã:*

|–ü–æ–ª–µ	|–¢–∏–ø, –æ–ø–∏—Å–∞–Ω–∏–µ|
|:---------------:|:---------------:|
|genre_id	|INT PRIMARY KEY AUTO_INCREMENT|
|name_genre	|VARCHAR(30)|

*–õ–æ–≥–∏—á–µ—Å–∫–∞—è —Å—Ö–µ–º–∞ (–Ω—É–∂–Ω–æ —Å–æ–∑–¥–∞—Ç—å —Ç–æ–ª—å–∫–æ —Ç–∞–±–ª–∏—Ü—É book):*

![](https://ucarecdn.com/95045d96-412d-4e10-88f2-7ac6b13fada6/)

‚úî`–†–ï–®–ï–ù–ò–ï` ‚§µÔ∏è

```sql
CREATE TABLE book (
  book_id INT PRIMARY KEY AUTO_INCREMENT, 
  title VARCHAR(50), 
  author_id INT NOT NULL, 
  genre_id INT, 
  price DECIMAL(8, 2), 
  amount INT, 
  FOREIGN KEY (author_id) REFERENCES author (author_id), 
  FOREIGN KEY (genre_id) REFERENCES genre (genre_id)
);
```

üîé `–†–ï–ó–£–õ–¨–¢–ê–¢` ‚§µÔ∏è

`Affected rows: 0`

---

‚ú≥ –®–∞–≥ 9. –î–µ–π—Å—Ç–≤–∏—è –ø—Ä–∏ —É–¥–∞–ª–µ–Ω–∏–∏ –∑–∞–ø–∏—Å–∏ –≥–ª–∞–≤–Ω–æ–π —Ç–∞–±–ª–∏—Ü—ã

‚ùì*–ó–∞–¥–∞–Ω–∏–µ. –°–æ–∑–¥–∞—Ç—å —Ç–∞–±–ª–∏—Ü—É book —Ç–æ–π –∂–µ —Å—Ç—Ä—É–∫—Ç—É—Ä—ã, —á—Ç–æ –∏ –Ω–∞ –ø—Ä–µ–¥—ã–¥—É—â–µ–º —à–∞–≥–µ. –ë—É–¥–µ–º —Å—á–∏—Ç–∞—Ç—å, —á—Ç–æ –ø—Ä–∏ —É–¥–∞–ª–µ–Ω–∏–∏ –∞–≤—Ç–æ—Ä–∞ –∏–∑ —Ç–∞–±–ª–∏—Ü—ã author, –¥–æ–ª–∂–Ω—ã —É–¥–∞–ª—è—Ç—å—Å—è –≤—Å–µ –∑–∞–ø–∏—Å–∏ –æ –∫–Ω–∏–≥–∞—Ö –∏–∑ —Ç–∞–±–ª–∏—Ü—ã book, –Ω–∞–ø–∏—Å–∞–Ω–Ω—ã–µ —ç—Ç–∏–º –∞–≤—Ç–æ—Ä–æ–º. –ê –ø—Ä–∏ —É–¥–∞–ª–µ–Ω–∏–∏ –∂–∞–Ω—Ä–∞ –∏–∑ —Ç–∞–±–ª–∏—Ü—ã genre –¥–ª—è —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤—É—é—â–µ–π –∑–∞–ø–∏—Å–∏ book —É—Å—Ç–∞–Ω–æ–≤–∏—Ç—å –∑–Ω–∞—á–µ–Ω–∏–µ Null –≤ —Å—Ç–æ–ª–±—Ü–µ genre_id.*

‚úî`–†–ï–®–ï–ù–ò–ï` ‚§µÔ∏è

```sql
CREATE TABLE book (
  book_id INT PRIMARY KEY AUTO_INCREMENT, 
  title VARCHAR(50), 
  author_id INT NOT NULL, 
  genre_id INT, 
  price DECIMAL(8, 2), 
  amount INT, 
  FOREIGN KEY (author_id) REFERENCES author (author_id) ON DELETE CASCADE, 
  FOREIGN KEY (genre_id) REFERENCES genre (genre_id) ON DELETE 
  SET 
    NULL
);
```

üîé `–†–ï–ó–£–õ–¨–¢–ê–¢` ‚§µÔ∏è

`Affected rows: 0`

---

‚ú≥ –®–∞–≥ 11. 

‚ùì*–ó–∞–¥–∞–Ω–∏–µ. –î–æ–±–∞–≤—å—Ç–µ —Ç—Ä–∏ –ø–æ—Å–ª–µ–¥–Ω–∏–µ –∑–∞–ø–∏—Å–∏ (—Å –∫–ª—é—á–µ–≤—ã–º–∏ –∑–Ω–∞—á–µ–Ω–∏—è–º–∏ 6, 7, 8) –≤ —Ç–∞–±–ª–∏—Ü—É book, –ø–µ—Ä–≤—ã–µ 5 –∑–∞–ø–∏—Å–µ–π —É–∂–µ –¥–æ–±–∞–≤–ª–µ–Ω—ã:*

|book_id	|title	|author_id	|genre_id	|price	|amount|
|:---------------:|:---------------:|:---------------:|:---------------:|:---------------:|:---------------:|
|1	|–ú–∞—Å—Ç–µ—Ä –∏ –ú–∞—Ä–≥–∞—Ä–∏—Ç–∞	|1	|1	|670.99	|3|
|2	|–ë–µ–ª–∞—è –≥–≤–∞—Ä–¥–∏—è	|1	|1	|540.50	|5|
|3	|–ò–¥–∏–æ—Ç	|2	|1	|460.00	|10|
|4	|–ë—Ä–∞—Ç—å—è –ö–∞—Ä–∞–º–∞–∑–æ–≤—ã	|2	|1	|799.01	|3|
|5	|–ò–≥—Ä–æ–∫	|2	|1	|480.50	|10|
|6	|–°—Ç–∏—Ö–æ—Ç–≤–æ—Ä–µ–Ω–∏—è –∏ –ø–æ—ç–º—ã	|3	|2	|650.00	|15|
|7	|–ß–µ—Ä–Ω—ã–π —á–µ–ª–æ–≤–µ–∫	|3	|2	|570.20	|6|
|8	|–õ–∏—Ä–∏–∫–∞	|4	|2	|518.99	|2|

*–õ–æ–≥–∏—á–µ—Å–∫–∞—è —Å—Ö–µ–º–∞ –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö:*

![–õ–æ–≥–∏—á–µ—Å–∫–∞—è —Å—Ö–µ–º–∞ –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö](https://ucarecdn.com/26d5d90a-3e95-46bc-807d-10fb53d10f25/)

‚úî`–†–ï–®–ï–ù–ò–ï` ‚§µÔ∏è

```sql
INSERT INTO book(
  title, author_id, genre_id, price, 
  amount
) 
VALUES 
  (
    "–°—Ç–∏—Ö–æ—Ç–≤–æ—Ä–µ–Ω–∏—è –∏ –ø–æ—ç–º—ã", 
    3, 2, 650.00, 15
  ), 
  (
    "–ß–µ—Ä–Ω—ã–π —á–µ–ª–æ–≤–µ–∫", 3, 
    2, 570.20, 6
  ), 
  ("–õ–∏—Ä–∏–∫–∞", 4, 2, 518.99, 2);
SELECT 
  * 
FROM 
  book;
```

üîé `–†–ï–ó–£–õ–¨–¢–ê–¢` ‚§µÔ∏è

| book_id | title                 | author_id | genre_id | price  | amount |
|:---------------:|:---------------:|:---------------:|:---------------:|:---------------:|:---------------:|
| 1       | –ú–∞—Å—Ç–µ—Ä –∏ –ú–∞—Ä–≥–∞—Ä–∏—Ç–∞    | 1         | 1        | 670.99 | 3      |
| 2       | –ë–µ–ª–∞—è –≥–≤–∞—Ä–¥–∏—è         | 1         | 1        | 540.50 | 5      |
| 3       | –ò–¥–∏–æ—Ç                 | 2         | 1        | 460.00 | 10     |
| 4       | –ë—Ä–∞—Ç—å—è –ö–∞—Ä–∞–º–∞–∑–æ–≤—ã     | 2         | 1        | 799.01 | 3      |
| 5       | –ò–≥—Ä–æ–∫                 | 2         | 1        | 480.50 | 10     |
| 6       | –°—Ç–∏—Ö–æ—Ç–≤–æ—Ä–µ–Ω–∏—è –∏ –ø–æ—ç–º—ã | 3         | 2        | 650.00 | 15     |
| 7       | –ß–µ—Ä–Ω—ã–π —á–µ–ª–æ–≤–µ–∫        | 3         | 2        | 570.20 | 6      |
| 8       | –õ–∏—Ä–∏–∫–∞                | 4         | 2        | 518.99 | 2      |

---

## 2.2 –ó–∞–ø—Ä–æ—Å—ã –Ω–∞ –≤—ã–±–æ—Ä–∫—É, —Å–æ–µ–¥–∏–Ω–µ–Ω–∏–µ —Ç–∞–±–ª–∏—Ü

‚ú≥ –®–∞–≥ 2. –°–æ–µ–¥–∏–Ω–µ–Ω–∏–µ INNER JOIN

‚ùì*–ó–∞–¥–∞–Ω–∏–µ. –í—ã–≤–µ—Å—Ç–∏ –Ω–∞–∑–≤–∞–Ω–∏–µ, –∂–∞–Ω—Ä –∏ —Ü–µ–Ω—É —Ç–µ—Ö –∫–Ω–∏–≥, –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –∫–æ—Ç–æ—Ä—ã—Ö –±–æ–ª—å—à–µ 8, –≤ –æ—Ç—Å–æ—Ä—Ç–∏—Ä–æ–≤–∞–Ω–Ω–æ–º –ø–æ —É–±—ã–≤–∞–Ω–∏—é —Ü–µ–Ω—ã –≤–∏–¥–µ.*

*–õ–æ–≥–∏—á–µ—Å–∫–∞—è —Å—Ö–µ–º–∞ –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö:*

![–õ–æ–≥–∏—á–µ—Å–∫–∞—è —Å—Ö–µ–º–∞ –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö](https://ucarecdn.com/26d5d90a-3e95-46bc-807d-10fb53d10f25/)

*–°—Ç—Ä—É–∫—Ç—É—Ä–∞ –∏ –Ω–∞–ø–æ–ª–Ω–µ–Ω–∏–µ —Ç–∞–±–ª–∏—Ü:*

*–¢–∞–±–ª–∏—Ü–∞ genre:*

| genre_id | name_genre  |
|:---------------:|:---------------:|
| 1        | –†–æ–º–∞–Ω       |
| 2        | –ü–æ—ç–∑–∏—è      |
| 3        | –ü—Ä–∏–∫–ª—é—á–µ–Ω–∏—è |

*–¢–∞–±–ª–∏—Ü–∞ author:*

| author_id | name_author      |
|:---------------:|:---------------:|
| 1         | –ë—É–ª–≥–∞–∫–æ–≤ –ú.–ê.    |
| 2         | –î–æ—Å—Ç–æ–µ–≤—Å–∫–∏–π –§.–ú. |
| 3         | –ï—Å–µ–Ω–∏–Ω –°.–ê.      |
| 4         | –ü–∞—Å—Ç–µ—Ä–Ω–∞–∫ –ë.–õ.   |
| 5         | –õ–µ—Ä–º–æ–Ω—Ç–æ–≤ –ú.–Æ.   |

*–¢–∞–±–ª–∏—Ü–∞ book:*

| book_id | title                 | author_id | genre_id | price  | amount |
|:---------------:|:---------------:|:---------------:|:---------------:|:---------------:|:---------------:|
| 1       | –ú–∞—Å—Ç–µ—Ä –∏ –ú–∞—Ä–≥–∞—Ä–∏—Ç–∞    | 1         | 1        | 670.99 | 3      |
| 2       | –ë–µ–ª–∞—è –≥–≤–∞—Ä–¥–∏—è         | 1         | 1        | 540.50 | 5      |
| 3       | –ò–¥–∏–æ—Ç                 | 2         | 1        | 460.00 | 10     |
| 4       | –ë—Ä–∞—Ç—å—è –ö–∞—Ä–∞–º–∞–∑–æ–≤—ã     | 2         | 1        | 799.01 | 3      |
| 5       | –ò–≥—Ä–æ–∫                 | 2         | 1        | 480.50 | 10     |
| 6       | –°—Ç–∏—Ö–æ—Ç–≤–æ—Ä–µ–Ω–∏—è –∏ –ø–æ—ç–º—ã | 3         | 2        | 650.00 | 15     |
| 7       | –ß–µ—Ä–Ω—ã–π —á–µ–ª–æ–≤–µ–∫        | 3         | 2        | 570.20 | 6      |
| 8       | –õ–∏—Ä–∏–∫–∞                | 4         | 2        | 518.99 | 2      |

‚úî`–†–ï–®–ï–ù–ò–ï` ‚§µÔ∏è

```sql
SELECT 
  title, 
  name_genre, 
  price 
FROM 
  book 
  INNER JOIN genre ON book.genre_id = genre.genre_id 
WHERE 
  book.amount > 8 
ORDER BY 
  3 DESC;
```

üîé `–†–ï–ó–£–õ–¨–¢–ê–¢` ‚§µÔ∏è

| title                 | name_genre | price  |
|:---------------:|:---------------:|:---------------:|
| –°—Ç–∏—Ö–æ—Ç–≤–æ—Ä–µ–Ω–∏—è –∏ –ø–æ—ç–º—ã | –ü–æ—ç–∑–∏—è     | 650.00 |
| –ò–≥—Ä–æ–∫                 | –†–æ–º–∞–Ω      | 480.50 |
| –ò–¥–∏–æ—Ç                 | –†–æ–º–∞–Ω      | 460.00 |

---

‚ú≥ –®–∞–≥ 3. –í–Ω–µ—à–Ω–µ–µ —Å–æ–µ–¥–∏–Ω–µ–Ω–∏–µ LEFT –∏ RIGHT OUTER JOIN

‚ùì*–ó–∞–¥–∞–Ω–∏–µ. –í—ã–≤–µ—Å—Ç–∏ –≤—Å–µ –∂–∞–Ω—Ä—ã, –∫–æ—Ç–æ—Ä—ã–µ –Ω–µ –ø—Ä–µ–¥—Å—Ç–∞–≤–ª–µ–Ω—ã –≤ –∫–Ω–∏–≥–∞—Ö –Ω–∞ —Å–∫–ª–∞–¥–µ.*

*–õ–æ–≥–∏—á–µ—Å–∫–∞—è —Å—Ö–µ–º–∞ –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö:*

![–õ–æ–≥–∏—á–µ—Å–∫–∞—è —Å—Ö–µ–º–∞ –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö](https://ucarecdn.com/26d5d90a-3e95-46bc-807d-10fb53d10f25/)

*–°—Ç—Ä—É–∫—Ç—É—Ä–∞ –∏ –Ω–∞–ø–æ–ª–Ω–µ–Ω–∏–µ —Ç–∞–±–ª–∏—Ü:*

*–¢–∞–±–ª–∏—Ü–∞ genre:*

| genre_id | name_genre  |
|:---------------:|:---------------:|
| 1        | –†–æ–º–∞–Ω       |
| 2        | –ü–æ—ç–∑–∏—è      |
| 3        | –ü—Ä–∏–∫–ª—é—á–µ–Ω–∏—è |

*–¢–∞–±–ª–∏—Ü–∞ author:*

| author_id | name_author      |
|:---------------:|:---------------:|
| 1         | –ë—É–ª–≥–∞–∫–æ–≤ –ú.–ê.    |
| 2         | –î–æ—Å—Ç–æ–µ–≤—Å–∫–∏–π –§.–ú. |
| 3         | –ï—Å–µ–Ω–∏–Ω –°.–ê.      |
| 4         | –ü–∞—Å—Ç–µ—Ä–Ω–∞–∫ –ë.–õ.   |
| 5         | –õ–µ—Ä–º–æ–Ω—Ç–æ–≤ –ú.–Æ.   |

*–¢–∞–±–ª–∏—Ü–∞ book:*

| book_id | title                 | author_id | genre_id | price  | amount |
|:---------------:|:---------------:|:---------------:|:---------------:|:---------------:|:---------------:|
| 1       | –ú–∞—Å—Ç–µ—Ä –∏ –ú–∞—Ä–≥–∞—Ä–∏—Ç–∞    | 1         | 1        | 670.99 | 3      |
| 2       | –ë–µ–ª–∞—è –≥–≤–∞—Ä–¥–∏—è         | 1         | 1        | 540.50 | 5      |
| 3       | –ò–¥–∏–æ—Ç                 | 2         | 1        | 460.00 | 10     |
| 4       | –ë—Ä–∞—Ç—å—è –ö–∞—Ä–∞–º–∞–∑–æ–≤—ã     | 2         | 1        | 799.01 | 3      |
| 5       | –ò–≥—Ä–æ–∫                 | 2         | 1        | 480.50 | 10     |
| 6       | –°—Ç–∏—Ö–æ—Ç–≤–æ—Ä–µ–Ω–∏—è –∏ –ø–æ—ç–º—ã | 3         | 2        | 650.00 | 15     |
| 7       | –ß–µ—Ä–Ω—ã–π —á–µ–ª–æ–≤–µ–∫        | 3         | 2        | 570.20 | 6      |
| 8       | –õ–∏—Ä–∏–∫–∞                | 4         | 2        | 518.99 | 2      |

‚úî`–†–ï–®–ï–ù–ò–ï` ‚§µÔ∏è

```sql
SELECT 
  name_genre 
FROM 
  genre 
  LEFT JOIN book ON genre.genre_id = book.genre_id 
WHERE 
  book.genre_id IS NULL;
```

üîé `–†–ï–ó–£–õ–¨–¢–ê–¢` ‚§µÔ∏è

| name_genre  |
|:---------------:|
| –ü—Ä–∏–∫–ª—é—á–µ–Ω–∏—è |

---

‚ú≥ –®–∞–≥ 4. –ü–µ—Ä–µ–∫—Ä–µ—Å—Ç–Ω–æ–µ —Å–æ–µ–¥–∏–Ω–µ–Ω–∏–µ CROSS JOIN

‚ùì*–ó–∞–¥–∞–Ω–∏–µ. –ï—Å—Ç—å —Å–ø–∏—Å–æ–∫ –≥–æ—Ä–æ–¥–æ–≤, —Ö—Ä–∞–Ω—è—â–∏–π—Å—è –≤ —Ç–∞–±–ª–∏—Ü–µ city:*

|city_id	|name_city|
|:---------------:|:---------------:|
|1	|–ú–æ—Å–∫–≤–∞|
|2	|–°–∞–Ω–∫—Ç-–ü–µ—Ç–µ—Ä–±—É—Ä–≥|
|3	|–í–ª–∞–¥–∏–≤–æ—Å—Ç–æ–∫|

*–ù–µ–æ–±—Ö–æ–¥–∏–º–æ –≤ –∫–∞–∂–¥–æ–º –≥–æ—Ä–æ–¥–µ –ø—Ä–æ–≤–µ—Å—Ç–∏ –≤—ã—Å—Ç–∞–≤–∫—É –∫–Ω–∏–≥ –∫–∞–∂–¥–æ–≥–æ –∞–≤—Ç–æ—Ä–∞ –≤ —Ç–µ—á–µ–Ω–∏–µ 2020 –≥–æ–¥–∞. –î–∞—Ç—É –ø—Ä–æ–≤–µ–¥–µ–Ω–∏—è –≤—ã—Å—Ç–∞–≤–∫–∏ –≤—ã–±—Ä–∞—Ç—å —Å–ª—É—á–∞–π–Ω—ã–º –æ–±—Ä–∞–∑–æ–º. –°–æ–∑–¥–∞—Ç—å –∑–∞–ø—Ä–æ—Å, –∫–æ—Ç–æ—Ä—ã–π –≤—ã–≤–µ–¥–µ—Ç –≥–æ—Ä–æ–¥, –∞–≤—Ç–æ—Ä–∞ –∏ –¥–∞—Ç—É –ø—Ä–æ–≤–µ–¥–µ–Ω–∏—è –≤—ã—Å—Ç–∞–≤–∫–∏. –ü–æ—Å–ª–µ–¥–Ω–∏–π —Å—Ç–æ–ª–±–µ—Ü –Ω–∞–∑–≤–∞—Ç—å –î–∞—Ç–∞. –ò–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é –≤—ã–≤–µ—Å—Ç–∏, –æ—Ç—Å–æ—Ä—Ç–∏—Ä–æ–≤–∞–≤ —Å–Ω–∞—á–∞–ª–∞ –≤ –∞–ª—Ñ–∞–≤–∏—Ç–Ω–æ–º –ø–æ—Ä—è–¥–∫–µ –ø–æ –Ω–∞–∑–≤–∞–Ω–∏—è–º –≥–æ—Ä–æ–¥–æ–≤, –∞ –ø–æ—Ç–æ–º –ø–æ —É–±—ã–≤–∞–Ω–∏—é –¥–∞—Ç –ø—Ä–æ–≤–µ–¥–µ–Ω–∏—è –≤—ã—Å—Ç–∞–≤–æ–∫.*

*–°—Ç—Ä—É–∫—Ç—É—Ä–∞ —Ç–∞–±–ª–∏—Ü—ã:*

![–°—Ç—Ä—É–∫—Ç—É—Ä–∞ —Ç–∞–±–ª–∏—Ü—ã:](https://ucarecdn.com/4d2b7a6d-ef2f-4597-a12f-87b3af48494e/)

*–°—Ç—Ä—É–∫—Ç—É—Ä–∞ –∏ –Ω–∞–ø–æ–ª–Ω–µ–Ω–∏–µ —Ç–∞–±–ª–∏—Ü:*

*–¢–∞–±–ª–∏—Ü–∞ genre:*

| genre_id | name_genre  |
|:---------------:|:---------------:|
| 1        | –†–æ–º–∞–Ω       |
| 2        | –ü–æ—ç–∑–∏—è      |
| 3        | –ü—Ä–∏–∫–ª—é—á–µ–Ω–∏—è |

*–¢–∞–±–ª–∏—Ü–∞ author:*

| author_id | name_author      |
|:---------------:|:---------------:|
| 1         | –ë—É–ª–≥–∞–∫–æ–≤ –ú.–ê.    |
| 2         | –î–æ—Å—Ç–æ–µ–≤—Å–∫–∏–π –§.–ú. |
| 3         | –ï—Å–µ–Ω–∏–Ω –°.–ê.      |
| 4         | –ü–∞—Å—Ç–µ—Ä–Ω–∞–∫ –ë.–õ.   |
| 5         | –õ–µ—Ä–º–æ–Ω—Ç–æ–≤ –ú.–Æ.   |

*–¢–∞–±–ª–∏—Ü–∞ city:*

| city_id | name_city       |
|:---------------:|:---------------:|
| 1       | –ú–æ—Å–∫–≤–∞          |
| 2       | –°–∞–Ω–∫—Ç-–ü–µ—Ç–µ—Ä–±—É—Ä–≥ |
| 3       | –í–ª–∞–¥–∏–≤–æ—Å—Ç–æ–∫     |

‚úî`–†–ï–®–ï–ù–ò–ï` ‚§µÔ∏è

```sql
SELECT 
  name_city, 
  name_author, 
  (
    DATE_ADD(
      "2020-01-01", 
      INTERVAL FLOOR(
        RAND() * 365
      ) DAY
    )
  ) AS –î–∞—Ç–∞ 
FROM 
  author CROSS 
  JOIN city 
ORDER BY 
  1 ASC, 
  –î–∞—Ç–∞ DESC;
```

üîé `–†–ï–ó–£–õ–¨–¢–ê–¢` ‚§µÔ∏è

| name_city       | name_author      | –î–∞—Ç–∞       |
|:---------------:|:---------------:|:---------------:|
| –í–ª–∞–¥–∏–≤–æ—Å—Ç–æ–∫     | –ï—Å–µ–Ω–∏–Ω –°.–ê.      | 2020-11-29 |
| –í–ª–∞–¥–∏–≤–æ—Å—Ç–æ–∫     | –õ–µ—Ä–º–æ–Ω—Ç–æ–≤ –ú.–Æ.   | 2020-09-28 |
| –í–ª–∞–¥–∏–≤–æ—Å—Ç–æ–∫     | –î–æ—Å—Ç–æ–µ–≤—Å–∫–∏–π –§.–ú. | 2020-06-11 |
| –í–ª–∞–¥–∏–≤–æ—Å—Ç–æ–∫     | –ë—É–ª–≥–∞–∫–æ–≤ –ú.–ê.    | 2020-03-18 |
| –í–ª–∞–¥–∏–≤–æ—Å—Ç–æ–∫     | –ü–∞—Å—Ç–µ—Ä–Ω–∞–∫ –ë.–õ.   | 2020-02-08 |
| –ú–æ—Å–∫–≤–∞          | –î–æ—Å—Ç–æ–µ–≤—Å–∫–∏–π –§.–ú. | 2020-12-07 |
| –ú–æ—Å–∫–≤–∞          | –õ–µ—Ä–º–æ–Ω—Ç–æ–≤ –ú.–Æ.   | 2020-07-11 |
| –ú–æ—Å–∫–≤–∞          | –ë—É–ª–≥–∞–∫–æ–≤ –ú.–ê.    | 2020-04-28 |
| –ú–æ—Å–∫–≤–∞          | –ü–∞—Å—Ç–µ—Ä–Ω–∞–∫ –ë.–õ.   | 2020-02-14 |
| –ú–æ—Å–∫–≤–∞          | –ï—Å–µ–Ω–∏–Ω –°.–ê.      | 2020-01-30 |
| –°–∞–Ω–∫—Ç-–ü–µ—Ç–µ—Ä–±—É—Ä–≥ | –ï—Å–µ–Ω–∏–Ω –°.–ê.      | 2020-10-06 |
| –°–∞–Ω–∫—Ç-–ü–µ—Ç–µ—Ä–±—É—Ä–≥ | –ë—É–ª–≥–∞–∫–æ–≤ –ú.–ê.    | 2020-05-23 |
| –°–∞–Ω–∫—Ç-–ü–µ—Ç–µ—Ä–±—É—Ä–≥ | –õ–µ—Ä–º–æ–Ω—Ç–æ–≤ –ú.–Æ.   | 2020-05-08 |
| –°–∞–Ω–∫—Ç-–ü–µ—Ç–µ—Ä–±—É—Ä–≥ | –ü–∞—Å—Ç–µ—Ä–Ω–∞–∫ –ë.–õ.   | 2020-04-14 |
| –°–∞–Ω–∫—Ç-–ü–µ—Ç–µ—Ä–±—É—Ä–≥ | –î–æ—Å—Ç–æ–µ–≤—Å–∫–∏–π –§.–ú. | 2020-04-02 |

---

‚ú≥ –®–∞–≥ 5. –ó–∞–ø—Ä–æ—Å—ã –Ω–∞ –≤—ã–±–æ—Ä–∫—É –∏–∑ –Ω–µ—Å–∫–æ–ª—å–∫–∏—Ö —Ç–∞–±–ª–∏—Ü

‚ùì*–ó–∞–¥–∞–Ω–∏–µ. –í—ã–≤–µ—Å—Ç–∏ –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é –æ –∫–Ω–∏–≥–∞—Ö (–∂–∞–Ω—Ä, –∫–Ω–∏–≥–∞, –∞–≤—Ç–æ—Ä), –æ—Ç–Ω–æ—Å—è—â–∏—Ö—Å—è –∫ –∂–∞–Ω—Ä—É, –≤–∫–ª—é—á–∞—é—â–µ–º—É —Å–ª–æ–≤–æ ¬´—Ä–æ–º–∞–Ω¬ª –≤ –æ—Ç—Å–æ—Ä—Ç–∏—Ä–æ–≤–∞–Ω–Ω–æ–º –ø–æ –Ω–∞–∑–≤–∞–Ω–∏—è–º –∫–Ω–∏–≥ –≤–∏–¥–µ.*

*–õ–æ–≥–∏—á–µ—Å–∫–∞—è —Å—Ö–µ–º–∞ –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö:*

![–õ–æ–≥–∏—á–µ—Å–∫–∞—è —Å—Ö–µ–º–∞ –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö](https://ucarecdn.com/26d5d90a-3e95-46bc-807d-10fb53d10f25/)

*–°—Ç—Ä—É–∫—Ç—É—Ä–∞ –∏ –Ω–∞–ø–æ–ª–Ω–µ–Ω–∏–µ —Ç–∞–±–ª–∏—Ü:*

*–¢–∞–±–ª–∏—Ü–∞ genre:*

| genre_id | name_genre  |
|:---------------:|:---------------:|
| 1        | –†–æ–º–∞–Ω       |
| 2        | –ü–æ—ç–∑–∏—è      |
| 3        | –ü—Ä–∏–∫–ª—é—á–µ–Ω–∏—è |

*–¢–∞–±–ª–∏—Ü–∞ author:*

| author_id | name_author      |
|:---------------:|:---------------:|
| 1         | –ë—É–ª–≥–∞–∫–æ–≤ –ú.–ê.    |
| 2         | –î–æ—Å—Ç–æ–µ–≤—Å–∫–∏–π –§.–ú. |
| 3         | –ï—Å–µ–Ω–∏–Ω –°.–ê.      |
| 4         | –ü–∞—Å—Ç–µ—Ä–Ω–∞–∫ –ë.–õ.   |
| 5         | –õ–µ—Ä–º–æ–Ω—Ç–æ–≤ –ú.–Æ.   |

*–¢–∞–±–ª–∏—Ü–∞ book:*

| book_id | title                 | author_id | genre_id | price  | amount |
|:---------------:|:---------------:|:---------------:|:---------------:|:---------------:|:---------------:|
| 1       | –ú–∞—Å—Ç–µ—Ä –∏ –ú–∞—Ä–≥–∞—Ä–∏—Ç–∞    | 1         | 1        | 670.99 | 3      |
| 2       | –ë–µ–ª–∞—è –≥–≤–∞—Ä–¥–∏—è         | 1         | 1        | 540.50 | 5      |
| 3       | –ò–¥–∏–æ—Ç                 | 2         | 1        | 460.00 | 10     |
| 4       | –ë—Ä–∞—Ç—å—è –ö–∞—Ä–∞–º–∞–∑–æ–≤—ã     | 2         | 1        | 799.01 | 3      |
| 5       | –ò–≥—Ä–æ–∫                 | 2         | 1        | 480.50 | 10     |
| 6       | –°—Ç–∏—Ö–æ—Ç–≤–æ—Ä–µ–Ω–∏—è –∏ –ø–æ—ç–º—ã | 3         | 2        | 650.00 | 15     |
| 7       | –ß–µ—Ä–Ω—ã–π —á–µ–ª–æ–≤–µ–∫        | 3         | 2        | 570.20 | 6      |
| 8       | –õ–∏—Ä–∏–∫–∞                | 4         | 2        | 518.99 | 2      |


‚úî`–†–ï–®–ï–ù–ò–ï` ‚§µÔ∏è

```sql
SELECT 
  name_genre, 
  title, 
  name_author 
FROM 
  book 
  JOIN genre ON book.genre_id = genre.genre_id 
  JOIN author ON book.author_id = author.author_id 
WHERE 
  name_genre = "–†–æ–º–∞–Ω" 
ORDER BY 
  2;
```

üîé `–†–ï–ó–£–õ–¨–¢–ê–¢` ‚§µÔ∏è

| name_genre | title              | name_author      |
|:---------------:|:---------------:|:---------------:|
| –†–æ–º–∞–Ω      | –ë–µ–ª–∞—è –≥–≤–∞—Ä–¥–∏—è      | –ë—É–ª–≥–∞–∫–æ–≤ –ú.–ê.    |
| –†–æ–º–∞–Ω      | –ë—Ä–∞—Ç—å—è –ö–∞—Ä–∞–º–∞–∑–æ–≤—ã  | –î–æ—Å—Ç–æ–µ–≤—Å–∫–∏–π –§.–ú. |
| –†–æ–º–∞–Ω      | –ò–≥—Ä–æ–∫              | –î–æ—Å—Ç–æ–µ–≤—Å–∫–∏–π –§.–ú. |
| –†–æ–º–∞–Ω      | –ò–¥–∏–æ—Ç              | –î–æ—Å—Ç–æ–µ–≤—Å–∫–∏–π –§.–ú. |
| –†–æ–º–∞–Ω      | –ú–∞—Å—Ç–µ—Ä –∏ –ú–∞—Ä–≥–∞—Ä–∏—Ç–∞ | –ë—É–ª–≥–∞–∫–æ–≤ –ú.–ê.    |

---

‚ú≥ –®–∞–≥ 6. –ó–∞–ø—Ä–æ—Å—ã –¥–ª—è –Ω–µ—Å–∫–æ–ª—å–∫–∏—Ö —Ç–∞–±–ª–∏—Ü —Å –≥—Ä—É–ø–ø–∏—Ä–æ–≤–∫–æ–π

‚ùì*–ó–∞–¥–∞–Ω–∏–µ. –ü–æ—Å—á–∏—Ç–∞—Ç—å –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ —ç–∫–∑–µ–º–ø–ª—è—Ä–æ–≤  –∫–Ω–∏–≥ –∫–∞–∂–¥–æ–≥–æ –∞–≤—Ç–æ—Ä–∞ –∏–∑ —Ç–∞–±–ª–∏—Ü—ã author.  –í—ã–≤–µ—Å—Ç–∏ —Ç–µ—Ö –∞–≤—Ç–æ—Ä–æ–≤,  –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –∫–Ω–∏–≥ –∫–æ—Ç–æ—Ä—ã—Ö –º–µ–Ω—å—à–µ 10, –≤ –æ—Ç—Å–æ—Ä—Ç–∏—Ä–æ–≤–∞–Ω–Ω–æ–º –ø–æ –≤–æ–∑—Ä–∞—Å—Ç–∞–Ω–∏—é –∫–æ–ª–∏—á–µ—Å—Ç–≤–∞ –≤–∏–¥–µ. –ü–æ—Å–ª–µ–¥–Ω–∏–π —Å—Ç–æ–ª–±–µ—Ü –Ω–∞–∑–≤–∞—Ç—å –ö–æ–ª–∏—á–µ—Å—Ç–≤–æ.*

*–õ–æ–≥–∏—á–µ—Å–∫–∞—è —Å—Ö–µ–º–∞ –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö:*

![–õ–æ–≥–∏—á–µ—Å–∫–∞—è —Å—Ö–µ–º–∞ –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö](https://ucarecdn.com/26d5d90a-3e95-46bc-807d-10fb53d10f25/)

*–°—Ç—Ä—É–∫—Ç—É—Ä–∞ –∏ –Ω–∞–ø–æ–ª–Ω–µ–Ω–∏–µ —Ç–∞–±–ª–∏—Ü:*

*–¢–∞–±–ª–∏—Ü–∞ genre:*

| genre_id | name_genre  |
|:---------------:|:---------------:|
| 1        | –†–æ–º–∞–Ω       |
| 2        | –ü–æ—ç–∑–∏—è      |
| 3        | –ü—Ä–∏–∫–ª—é—á–µ–Ω–∏—è |

*–¢–∞–±–ª–∏—Ü–∞ author:*

| author_id | name_author      |
|:---------------:|:---------------:|
| 1         | –ë—É–ª–≥–∞–∫–æ–≤ –ú.–ê.    |
| 2         | –î–æ—Å—Ç–æ–µ–≤—Å–∫–∏–π –§.–ú. |
| 3         | –ï—Å–µ–Ω–∏–Ω –°.–ê.      |
| 4         | –ü–∞—Å—Ç–µ—Ä–Ω–∞–∫ –ë.–õ.   |
| 5         | –õ–µ—Ä–º–æ–Ω—Ç–æ–≤ –ú.–Æ.   |

*–¢–∞–±–ª–∏—Ü–∞ book:*

| book_id | title                 | author_id | genre_id | price  | amount |
|:---------------:|:---------------:|:---------------:|:---------------:|:---------------:|:---------------:|
| 1       | –ú–∞—Å—Ç–µ—Ä –∏ –ú–∞—Ä–≥–∞—Ä–∏—Ç–∞    | 1         | 1        | 670.99 | 3      |
| 2       | –ë–µ–ª–∞—è –≥–≤–∞—Ä–¥–∏—è         | 1         | 1        | 540.50 | 5      |
| 3       | –ò–¥–∏–æ—Ç                 | 2         | 1        | 460.00 | 10     |
| 4       | –ë—Ä–∞—Ç—å—è –ö–∞—Ä–∞–º–∞–∑–æ–≤—ã     | 2         | 1        | 799.01 | 3      |
| 5       | –ò–≥—Ä–æ–∫                 | 2         | 1        | 480.50 | 10     |
| 6       | –°—Ç–∏—Ö–æ—Ç–≤–æ—Ä–µ–Ω–∏—è –∏ –ø–æ—ç–º—ã | 3         | 2        | 650.00 | 15     |
| 7       | –ß–µ—Ä–Ω—ã–π —á–µ–ª–æ–≤–µ–∫        | 3         | 2        | 570.20 | 6      |
| 8       | –õ–∏—Ä–∏–∫–∞                | 4         | 2        | 518.99 | 2      |


‚úî`–†–ï–®–ï–ù–ò–ï` ‚§µÔ∏è

```sql
SELECT 
  name_author, 
  SUM(amount) AS –ö–æ–ª–∏—á–µ—Å—Ç–≤–æ 
FROM 
  author AS a 
  LEFT JOIN book AS b ON a.author_id = b.author_id 
GROUP BY 
  name_author 
HAVING 
  –ö–æ–ª–∏—á–µ—Å—Ç–≤–æ < 10 
  OR –ö–æ–ª–∏—á–µ—Å—Ç–≤–æ IS NULL 
ORDER BY 
  –ö–æ–ª–∏—á–µ—Å—Ç–≤–æ ASC;
```

üîé `–†–ï–ó–£–õ–¨–¢–ê–¢` ‚§µÔ∏è

| name_author    | –ö–æ–ª–∏—á–µ—Å—Ç–≤–æ |
|:----------:|:---------------:|
| –õ–µ—Ä–º–æ–Ω—Ç–æ–≤ –ú.–Æ. | NULL       |
| –ü–∞—Å—Ç–µ—Ä–Ω–∞–∫ –ë.–õ. | 2          |
| –ë—É–ª–≥–∞–∫–æ–≤ –ú.–ê.  | 8          |

---

‚ú≥ –®–∞–≥ 7. –ó–∞–ø—Ä–æ—Å—ã –¥–ª—è –Ω–µ—Å–∫–æ–ª—å–∫–∏—Ö —Ç–∞–±–ª–∏—Ü —Å–æ –≤–ª–æ–∂–µ–Ω–Ω—ã–º–∏ –∑–∞–ø—Ä–æ—Å–∞–º–∏

‚ùì*–ó–∞–¥–∞–Ω–∏–µ. –í—ã–≤–µ—Å—Ç–∏ –≤ –∞–ª—Ñ–∞–≤–∏—Ç–Ω–æ–º –ø–æ—Ä—è–¥–∫–µ –≤—Å–µ—Ö –∞–≤—Ç–æ—Ä–æ–≤, –∫–æ—Ç–æ—Ä—ã–µ –ø–∏—à—É—Ç —Ç–æ–ª—å–∫–æ –≤ –æ–¥–Ω–æ–º –∂–∞–Ω—Ä–µ. –ü–æ—Å–∫–æ–ª—å–∫—É —É –Ω–∞—Å –≤ —Ç–∞–±–ª–∏—Ü–∞—Ö —Ç–∞–∫ –∑–∞–Ω–µ—Å–µ–Ω—ã –¥–∞–Ω–Ω—ã–µ, —á—Ç–æ —É –∫–∞–∂–¥–æ–≥–æ –∞–≤—Ç–æ—Ä–∞ –∫–Ω–∏–≥–∏ —Ç–æ–ª—å–∫–æ –≤ –æ–¥–Ω–æ–º –∂–∞–Ω—Ä–µ,  –¥–ª—è —ç—Ç–æ–≥–æ –∑–∞–ø—Ä–æ—Å–∞ –≤–Ω–µ—Å–µ–º –∏–∑–º–µ–Ω–µ–Ω–∏—è –≤ —Ç–∞–±–ª–∏—Ü—É book. –ü—É—Å—Ç—å —É –Ω–∞—Å  –∫–Ω–∏–≥–∞ –ï—Å–µ–Ω–∏–Ω–∞ ¬´–ß–µ—Ä–Ω—ã–π —á–µ–ª–æ–≤–µ–∫¬ª –æ—Ç–Ω–æ—Å–∏—Ç—Å—è –∫ –∂–∞–Ω—Ä—É ¬´–†–æ–º–∞–Ω¬ª, –∞ –∫–Ω–∏–≥–∞ –ë—É–ª–≥–∞–∫–æ–≤–∞ ¬´–ë–µ–ª–∞—è –≥–≤–∞—Ä–¥–∏—è¬ª –∫ ¬´–ü—Ä–∏–∫–ª—é—á–µ–Ω–∏—è–º¬ª (—ç—Ç–∏ –∏–∑–º–µ–Ω–µ–Ω–∏—è –≤ —Ç–∞–±–ª–∏—Ü—ã —É–∂–µ –≤–Ω–µ—Å–µ–Ω—ã).*

*–õ–æ–≥–∏—á–µ—Å–∫–∞—è —Å—Ö–µ–º–∞ –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö:*

![–õ–æ–≥–∏—á–µ—Å–∫–∞—è —Å—Ö–µ–º–∞ –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö](https://ucarecdn.com/26d5d90a-3e95-46bc-807d-10fb53d10f25/)

*–°—Ç—Ä—É–∫—Ç—É—Ä–∞ –∏ –Ω–∞–ø–æ–ª–Ω–µ–Ω–∏–µ —Ç–∞–±–ª–∏—Ü:*

*–¢–∞–±–ª–∏—Ü–∞ genre:*

| genre_id | name_genre  |
|:---------------:|:---------------:|
| 1        | –†–æ–º–∞–Ω       |
| 2        | –ü–æ—ç–∑–∏—è      |
| 3        | –ü—Ä–∏–∫–ª—é—á–µ–Ω–∏—è |

*–¢–∞–±–ª–∏—Ü–∞ author:*

| author_id | name_author      |
|:---------------:|:---------------:|
| 1         | –ë—É–ª–≥–∞–∫–æ–≤ –ú.–ê.    |
| 2         | –î–æ—Å—Ç–æ–µ–≤—Å–∫–∏–π –§.–ú. |
| 3         | –ï—Å–µ–Ω–∏–Ω –°.–ê.      |
| 4         | –ü–∞—Å—Ç–µ—Ä–Ω–∞–∫ –ë.–õ.   |
| 5         | –õ–µ—Ä–º–æ–Ω—Ç–æ–≤ –ú.–Æ.   |

*–¢–∞–±–ª–∏—Ü–∞ book:*

| book_id | title                 | author_id | genre_id | price  | amount |
|:---------------:|:---------------:|:---------------:|:---------------:|:---------------:|:---------------:|
| 1       | –ú–∞—Å—Ç–µ—Ä –∏ –ú–∞—Ä–≥–∞—Ä–∏—Ç–∞    | 1         | 1        | 670.99 | 3      |
| 2       | –ë–µ–ª–∞—è –≥–≤–∞—Ä–¥–∏—è         | 1         | 3        | 540.50 | 5      |
| 3       | –ò–¥–∏–æ—Ç                 | 2         | 1        | 460.00 | 10     |
| 4       | –ë—Ä–∞—Ç—å—è –ö–∞—Ä–∞–º–∞–∑–æ–≤—ã     | 2         | 1        | 799.01 | 3      |
| 5       | –ò–≥—Ä–æ–∫                 | 2         | 1        | 480.50 | 10     |
| 6       | –°—Ç–∏—Ö–æ—Ç–≤–æ—Ä–µ–Ω–∏—è –∏ –ø–æ—ç–º—ã | 3         | 2        | 650.00 | 15     |
| 7       | –ß–µ—Ä–Ω—ã–π —á–µ–ª–æ–≤–µ–∫        | 3         | 1        | 570.20 | 6      |
| 8       | –õ–∏—Ä–∏–∫–∞                | 4         | 2        | 518.99 | 2      |

‚úî`–†–ï–®–ï–ù–ò–ï` ‚§µÔ∏è

```sql
SELECT 
  name_author 
FROM 
  author AS a 
  JOIN book AS b ON b.author_id = a.author_id 
  JOIN genre AS g ON g.genre_id = b.genre_id 
GROUP BY 
  name_author 
HAVING 
  COUNT(
    DISTINCT(name_genre)
  ) = 1;
```

üîé `–†–ï–ó–£–õ–¨–¢–ê–¢` ‚§µÔ∏è

| name_author      |
|:---------------:|
| –î–æ—Å—Ç–æ–µ–≤—Å–∫–∏–π –§.–ú. |
| –ü–∞—Å—Ç–µ—Ä–Ω–∞–∫ –ë.–õ.   |

---

‚ú≥ –®–∞–≥ 8. –í–ª–æ–∂–µ–Ω–Ω—ã–µ –∑–∞–ø—Ä–æ—Å—ã –≤ –æ–ø–µ—Ä–∞—Ç–æ—Ä–∞—Ö —Å–æ–µ–¥–∏–Ω–µ–Ω–∏—è

‚ùì*–ó–∞–¥–∞–Ω–∏–µ. –í—ã–≤–µ—Å—Ç–∏ –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é –æ –∫–Ω–∏–≥–∞—Ö (–Ω–∞–∑–≤–∞–Ω–∏–µ –∫–Ω–∏–≥–∏, —Ñ–∞–º–∏–ª–∏—é –∏ –∏–Ω–∏—Ü–∏–∞–ª—ã –∞–≤—Ç–æ—Ä–∞, –Ω–∞–∑–≤–∞–Ω–∏–µ –∂–∞–Ω—Ä–∞, —Ü–µ–Ω—É –∏ –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ —ç–∫–∑–µ–º–ø–ª—è—Ä–æ–≤ –∫–Ω–∏–≥–∏), –Ω–∞–ø–∏—Å–∞–Ω–Ω—ã—Ö –≤ —Å–∞–º—ã—Ö –ø–æ–ø—É–ª—è—Ä–Ω—ã—Ö –∂–∞–Ω—Ä–∞—Ö, –≤ –æ—Ç—Å–æ—Ä—Ç–∏—Ä–æ–≤–∞–Ω–Ω–æ–º –≤ –∞–ª—Ñ–∞–≤–∏—Ç–Ω–æ–º –ø–æ—Ä—è–¥–∫–µ –ø–æ –Ω–∞–∑–≤–∞–Ω–∏—é –∫–Ω–∏–≥ –≤–∏–¥–µ. –°–∞–º—ã–º –ø–æ–ø—É–ª—è—Ä–Ω—ã–º —Å—á–∏—Ç–∞—Ç—å –∂–∞–Ω—Ä, –æ–±—â–µ–µ –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ —ç–∫–∑–µ–º–ø–ª—è—Ä–æ–≤ –∫–Ω–∏–≥ –∫–æ—Ç–æ—Ä–æ–≥–æ –Ω–∞ —Å–∫–ª–∞–¥–µ –º–∞–∫—Å–∏–º–∞–ª—å–Ω–æ.*

*–õ–æ–≥–∏—á–µ—Å–∫–∞—è —Å—Ö–µ–º–∞ –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö:*

![–õ–æ–≥–∏—á–µ—Å–∫–∞—è —Å—Ö–µ–º–∞ –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö](https://ucarecdn.com/26d5d90a-3e95-46bc-807d-10fb53d10f25/)

*–°—Ç—Ä—É–∫—Ç—É—Ä–∞ –∏ –Ω–∞–ø–æ–ª–Ω–µ–Ω–∏–µ —Ç–∞–±–ª–∏—Ü:*

*–¢–∞–±–ª–∏—Ü–∞ genre:*

| genre_id | name_genre  |
|:---------------:|:---------------:|
| 1        | –†–æ–º–∞–Ω       |
| 2        | –ü–æ—ç–∑–∏—è      |
| 3        | –ü—Ä–∏–∫–ª—é—á–µ–Ω–∏—è |

*–¢–∞–±–ª–∏—Ü–∞ author:*

| author_id | name_author      |
|:---------------:|:---------------:|
| 1         | –ë—É–ª–≥–∞–∫–æ–≤ –ú.–ê.    |
| 2         | –î–æ—Å—Ç–æ–µ–≤—Å–∫–∏–π –§.–ú. |
| 3         | –ï—Å–µ–Ω–∏–Ω –°.–ê.      |
| 4         | –ü–∞—Å—Ç–µ—Ä–Ω–∞–∫ –ë.–õ.   |
| 5         | –õ–µ—Ä–º–æ–Ω—Ç–æ–≤ –ú.–Æ.   |

*–¢–∞–±–ª–∏—Ü–∞ book:*

| book_id | title                 | author_id | genre_id | price  | amount |
|:---------------:|:---------------:|:---------------:|:---------------:|:---------------:|:---------------:|
| 1       | –ú–∞—Å—Ç–µ—Ä –∏ –ú–∞—Ä–≥–∞—Ä–∏—Ç–∞    | 1         | 1        | 670.99 | 3      |
| 2       | –ë–µ–ª–∞—è –≥–≤–∞—Ä–¥–∏—è         | 1         | 1        | 540.50 | 5      |
| 3       | –ë—Ä–∞—Ç—å—è –ö–∞—Ä–∞–º–∞–∑–æ–≤—ã     | 2         | 1        | 799.01 | 3      |
| 4       | –ò–≥—Ä–æ–∫                 | 2         | 1        | 480.50 | 10     |
| 5       | –°—Ç–∏—Ö–æ—Ç–≤–æ—Ä–µ–Ω–∏—è –∏ –ø–æ—ç–º—ã | 3         | 2        | 650.00 | 15     |
| 6       | –ß–µ—Ä–Ω—ã–π —á–µ–ª–æ–≤–µ–∫        | 3         | 2        | 570.20 | 6      |
| 7       | –õ–∏—Ä–∏–∫–∞                | 4         | 2        | 518.99 | 10     |
| 8       | –ò–¥–∏–æ—Ç                 | 2         | 1        | 460.00 | 10     |
| 9       | –ì–µ—Ä–æ–π –Ω–∞—à–µ–≥–æ –≤—Ä–µ–º–µ–Ω–∏  | 5         | 3        | 570.59 | 2      |
| 10      | –î–æ–∫—Ç–æ—Ä –ñ–∏–≤–∞–≥–æ         | 4         | 3        | 740.50 | 5      |

‚úî`–†–ï–®–ï–ù–ò–ï` ‚§µÔ∏è

```sql
SELECT 
  title, 
  name_author, 
  name_genre, 
  price, 
  amount 
FROM 
  book 
  JOIN genre ON book.genre_id = genre.genre_id 
  JOIN author ON book.author_id = author.author_id 
WHERE 
  book.genre_id IN(
    SELECT 
      query_in_2.genre_id 
    FROM 
      (
        SELECT 
          genre.genre_id, 
          SUM(amount) AS sum_amount 
        FROM 
          genre 
          JOIN book ON genre.genre_id = book.genre_id 
        GROUP BY 
          book.genre_id 
        ORDER BY 
          sum_amount DESC 
        LIMIT 
          1
      ) query_in_1 
      JOIN (
        SELECT 
          genre.genre_id, 
          SUM(amount) AS sum_amount 
        FROM 
          genre 
          JOIN book ON genre.genre_id = book.genre_id 
        GROUP BY 
          book.genre_id 
        ORDER BY 
          sum_amount DESC
      ) query_in_2 ON query_in_1.sum_amount = query_in_2.sum_amount
  ) 
ORDER BY 
  title;
```

üîé `–†–ï–ó–£–õ–¨–¢–ê–¢` ‚§µÔ∏è

| title                 | name_author      | name_genre | price  | amount |
|:---------------:|:---------------:|:---------------:|:---------------:|:---------------:|
| –ë–µ–ª–∞—è –≥–≤–∞—Ä–¥–∏—è         | –ë—É–ª–≥–∞–∫–æ–≤ –ú.–ê.    | –†–æ–º–∞–Ω      | 540.50 | 5      |
| –ë—Ä–∞—Ç—å—è –ö–∞—Ä–∞–º–∞–∑–æ–≤—ã     | –î–æ—Å—Ç–æ–µ–≤—Å–∫–∏–π –§.–ú. | –†–æ–º–∞–Ω      | 799.01 | 3      |
| –ò–≥—Ä–æ–∫                 | –î–æ—Å—Ç–æ–µ–≤—Å–∫–∏–π –§.–ú. | –†–æ–º–∞–Ω      | 480.50 | 10     |
| –ò–¥–∏–æ—Ç                 | –î–æ—Å—Ç–æ–µ–≤—Å–∫–∏–π –§.–ú. | –†–æ–º–∞–Ω      | 460.00 | 10     |
| –õ–∏—Ä–∏–∫–∞                | –ü–∞—Å—Ç–µ—Ä–Ω–∞–∫ –ë.–õ.   | –ü–æ—ç–∑–∏—è     | 518.99 | 10     |
| –ú–∞—Å—Ç–µ—Ä –∏ –ú–∞—Ä–≥–∞—Ä–∏—Ç–∞    | –ë—É–ª–≥–∞–∫–æ–≤ –ú.–ê.    | –†–æ–º–∞–Ω      | 670.99 | 3      |
| –°—Ç–∏—Ö–æ—Ç–≤–æ—Ä–µ–Ω–∏—è –∏ –ø–æ—ç–º—ã | –ï—Å–µ–Ω–∏–Ω –°.–ê.      | –ü–æ—ç–∑–∏—è     | 650.00 | 15     |
| –ß–µ—Ä–Ω—ã–π —á–µ–ª–æ–≤–µ–∫        | –ï—Å–µ–Ω–∏–Ω –°.–ê.      | –ü–æ—ç–∑–∏—è     | 570.20 | 6      |

---

‚ú≥ –®–∞–≥ 9. –û–ø–µ—Ä–∞—Ü–∏—è —Å–æ–µ–¥–∏–Ω–µ–Ω–∏–µ, –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ USING()

‚ùì*–ó–∞–¥–∞–Ω–∏–µ. –ï—Å–ª–∏ –≤ —Ç–∞–±–ª–∏—Ü–∞—Ö supply  –∏ book –µ—Å—Ç—å –æ–¥–∏–Ω–∞–∫–æ–≤—ã–µ –∫–Ω–∏–≥–∏, –∫–æ—Ç–æ—Ä—ã–µ –∏–º–µ—é—Ç —Ä–∞–≤–Ω—É—é —Ü–µ–Ω—É,  –≤—ã–≤–µ—Å—Ç–∏ –∏—Ö –Ω–∞–∑–≤–∞–Ω–∏–µ –∏ –∞–≤—Ç–æ—Ä–∞, –∞ —Ç–∞–∫–∂–µ –ø–æ—Å—á–∏—Ç–∞—Ç—å –æ–±—â–µ–µ –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ —ç–∫–∑–µ–º–ø–ª—è—Ä–æ–≤ –∫–Ω–∏–≥ –≤ —Ç–∞–±–ª–∏—Ü–∞—Ö supply –∏ book,  —Å—Ç–æ–ª–±—Ü—ã –Ω–∞–∑–≤–∞—Ç—å –ù–∞–∑–≤–∞–Ω–∏–µ, –ê–≤—Ç–æ—Ä  –∏ –ö–æ–ª–∏—á–µ—Å—Ç–≤–æ.*

*–°—Ö–µ–º–∞ –¥–∞–Ω–Ω—ã—Ö:*

![–°—Ö–µ–º–∞ –¥–∞–Ω–Ω—ã—Ö:](https://ucarecdn.com/6de130b3-aac2-4216-82bb-7421c2a614ad/)

*–°—Ç—Ä—É–∫—Ç—É—Ä–∞ –∏ –Ω–∞–ø–æ–ª–Ω–µ–Ω–∏–µ —Ç–∞–±–ª–∏—Ü:*

*–¢–∞–±–ª–∏—Ü–∞ supply:*

| supply_id | title          | author           | price  | amount |
|:---------------:|:---------------:|:---------------:|:---------------:|:---------------:|
| 1         | –î–æ–∫—Ç–æ—Ä –ñ–∏–≤–∞–≥–æ  | –ü–∞—Å—Ç–µ—Ä–Ω–∞–∫ –ë.–õ.   | 618.99 | 3      |
| 2         | –ß–µ—Ä–Ω—ã–π —á–µ–ª–æ–≤–µ–∫ | –ï—Å–µ–Ω–∏–Ω –°.–ê.      | 570.20 | 6      |
| 3         | –ï–≤–≥–µ–Ω–∏–π –û–Ω–µ–≥–∏–Ω | –ü—É—à–∫–∏–Ω –ê.–°.      | 440.80 | 5      |
| 4         | –ò–¥–∏–æ—Ç          | –î–æ—Å—Ç–æ–µ–≤—Å–∫–∏–π –§.–ú. | 360.80 | 3      |

*–¢–∞–±–ª–∏—Ü–∞ author:*

| author_id | name_author      |
|:---------------:|:---------------:|
| 1         | –ë—É–ª–≥–∞–∫–æ–≤ –ú.–ê.    |
| 2         | –î–æ—Å—Ç–æ–µ–≤—Å–∫–∏–π –§.–ú. |
| 3         | –ï—Å–µ–Ω–∏–Ω –°.–ê.      |
| 4         | –ü–∞—Å—Ç–µ—Ä–Ω–∞–∫ –ë.–õ.   |
| 5         | –õ–µ—Ä–º–æ–Ω—Ç–æ–≤ –ú.–Æ.   |

*–¢–∞–±–ª–∏—Ü–∞ book:*

| book_id | title                 | author_id | genre_id | price  | amount |
|:---------------:|:---------------:|:---------------:|:---------------:|:---------------:|:---------------:|
| 1       | –ú–∞—Å—Ç–µ—Ä –∏ –ú–∞—Ä–≥–∞—Ä–∏—Ç–∞    | 1         | 1        | 670.99 | 3      |
| 2       | –ë–µ–ª–∞—è –≥–≤–∞—Ä–¥–∏—è         | 1         | 1        | 540.50 | 5      |
| 3       | –ò–¥–∏–æ—Ç                 | 2         | 1        | 460.00 | 10     |
| 4       | –ë—Ä–∞—Ç—å—è –ö–∞—Ä–∞–º–∞–∑–æ–≤—ã     | 2         | 1        | 799.01 | 3      |
| 5       | –ò–≥—Ä–æ–∫                 | 2         | 1        | 480.50 | 10     |
| 6       | –°—Ç–∏—Ö–æ—Ç–≤–æ—Ä–µ–Ω–∏—è –∏ –ø–æ—ç–º—ã | 3         | 2        | 650.00 | 15     |
| 7       | –ß–µ—Ä–Ω—ã–π —á–µ–ª–æ–≤–µ–∫        | 3         | 2        | 570.20 | 6      |
| 8       | –õ–∏—Ä–∏–∫–∞                | 4         | 2        | 518.99 | 2      |

‚úî`–†–ï–®–ï–ù–ò–ï` ‚§µÔ∏è

```sql
SELECT 
  title AS –ù–∞–∑–≤–∞–Ω–∏–µ, 
  name_author AS –ê–≤—Ç–æ—Ä, 
  SUM(book.amount + supply.amount) AS –ö–æ–ª–∏—á–µ—Å—Ç–≤–æ 
FROM 
  supply 
  INNER JOIN book USING(price, title) 
  INNER JOIN author ON author.name_author = supply.author 
GROUP BY 
  author.name_author, 
  book.title;
```

üîé `–†–ï–ó–£–õ–¨–¢–ê–¢` ‚§µÔ∏è

| –ù–∞–∑–≤–∞–Ω–∏–µ       | –ê–≤—Ç–æ—Ä       | –ö–æ–ª–∏—á–µ—Å—Ç–≤–æ |
|:---------------:|:---------------:|:---------------:|
| –ß–µ—Ä–Ω—ã–π —á–µ–ª–æ–≤–µ–∫ | –ï—Å–µ–Ω–∏–Ω –°.–ê. | 12         |

---

## 2.3 –ó–∞–ø—Ä–æ—Å—ã –∫–æ—Ä—Ä–µ–∫—Ç–∏—Ä–æ–≤–∫–∏, —Å–æ–µ–¥–∏–Ω–µ–Ω–∏–µ —Ç–∞–±–ª–∏—Ü

*–ö–æ–Ω—Ü–µ–ø—Ç—É–∞–ª—å–Ω–∞—è —Å—Ö–µ–º–∞ –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö:*

![](https://ucarecdn.com/f95c8b49-0d5c-45e0-9e35-6261f7cbbbe8/)

*–õ–æ–≥–∏—á–µ—Å–∫–∞—è —Å—Ö–µ–º–∞ –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö:*

![](https://ucarecdn.com/95045d96-412d-4e10-88f2-7ac6b13fada6/)

‚ú≥ –®–∞–≥ 2. –ó–∞–ø—Ä–æ—Å—ã –Ω–∞ –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ, —Å–≤—è–∑–∞–Ω–Ω—ã–µ —Ç–∞–±–ª–∏—Ü—ã

‚ùì*–ó–∞–¥–∞–Ω–∏–µ. –î–ª—è –∫–Ω–∏–≥, –∫–æ—Ç–æ—Ä—ã–µ —É–∂–µ –µ—Å—Ç—å –Ω–∞ —Å–∫–ª–∞–¥–µ (–≤ —Ç–∞–±–ª–∏—Ü–µ book), –Ω–æ –ø–æ –¥—Ä—É–≥–æ–π —Ü–µ–Ω–µ, —á–µ–º –≤ –ø–æ—Å—Ç–∞–≤–∫–µ (supply),  –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ –≤ —Ç–∞–±–ª–∏—Ü–µ book —É–≤–µ–ª–∏—á–∏—Ç—å –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –Ω–∞ –∑–Ω–∞—á–µ–Ω–∏–µ, —É–∫–∞–∑–∞–Ω–Ω–æ–µ –≤ –ø–æ—Å—Ç–∞–≤–∫–µ,  –∏ –ø–µ—Ä–µ—Å—á–∏—Ç–∞—Ç—å —Ü–µ–Ω—É. –ê –≤ —Ç–∞–±–ª–∏—Ü–µ  supply –æ–±–Ω—É–ª–∏—Ç—å –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ —ç—Ç–∏—Ö –∫–Ω–∏–≥. –§–æ—Ä–º—É–ª–∞ –¥–ª—è –ø–µ—Ä–µ—Å—á–µ—Ç–∞ —Ü–µ–Ω—ã:*  
*price = (p1‚àók1 + p2‚àók2) / (k1+k2)*  
*–≥–¥–µ  p1, p2 - —Ü–µ–Ω–∞ –∫–Ω–∏–≥–∏ –≤ —Ç–∞–±–ª–∏—Ü–∞—Ö book –∏ supply;*  
*k1, k2 - –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –∫–Ω–∏–≥ –≤ —Ç–∞–±–ª–∏—Ü–∞—Ö book –∏ supply.*

*–°—Ç—Ä—É–∫—Ç—É—Ä–∞ –∏ –Ω–∞–ø–æ–ª–Ω–µ–Ω–∏–µ —Ç–∞–±–ª–∏—Ü:*

*–¢–∞–±–ª–∏—Ü–∞ book*

| book_id | title                 | author_id | genre_id | price  | amount |
|:---------------:|:---------------:|:---------------:|:---------------:|:---------------:|:---------------:|
| 1       | –ú–∞—Å—Ç–µ—Ä –∏ –ú–∞—Ä–≥–∞—Ä–∏—Ç–∞    | 1         | 1        | 670.99 | 3      |
| 2       | –ë–µ–ª–∞—è –≥–≤–∞—Ä–¥–∏—è         | 1         | 1        | 540.50 | 5      |
| 3       | –ò–¥–∏–æ—Ç                 | 2         | 1        | 460.00 | 10     |
| 4       | –ë—Ä–∞—Ç—å—è –ö–∞—Ä–∞–º–∞–∑–æ–≤—ã     | 2         | 1        | 799.01 | 3      |
| 5       | –ò–≥—Ä–æ–∫                 | 2         | 1        | 480.50 | 10     |
| 6       | –°—Ç–∏—Ö–æ—Ç–≤–æ—Ä–µ–Ω–∏—è –∏ –ø–æ—ç–º—ã | 3         | 2        | 650.00 | 15     |
| 7       | –ß–µ—Ä–Ω—ã–π —á–µ–ª–æ–≤–µ–∫        | 3         | 2        | 570.20 | 6      |
| 8       | –õ–∏—Ä–∏–∫–∞                | 4         | 2        | 518.99 | 2      |

*–¢–∞–±–ª–∏—Ü–∞ supply*

| supply_id | title                 | author           | price  | amount |
|:---------------:|:---------------:|:---------------:|:---------------:|:---------------:|
| 1         | –î–æ–∫—Ç–æ—Ä –ñ–∏–≤–∞–≥–æ         | –ü–∞—Å—Ç–µ—Ä–Ω–∞–∫ –ë.–õ.   | 380.80 | 4      |
| 2         | –ß–µ—Ä–Ω—ã–π —á–µ–ª–æ–≤–µ–∫        | –ï—Å–µ–Ω–∏–Ω –°.–ê.      | 570.20 | 6      |
| 3         | –ë–µ–ª–∞—è –≥–≤–∞—Ä–¥–∏—è         | –ë—É–ª–≥–∞–∫–æ–≤ –ú.–ê.    | 540.50 | 7      |
| 4         | –ò–¥–∏–æ—Ç                 | –î–æ—Å—Ç–æ–µ–≤—Å–∫–∏–π –§.–ú. | 360.80 | 3      |
| 5         | –°—Ç–∏—Ö–æ—Ç–≤–æ—Ä–µ–Ω–∏—è –∏ –ø–æ—ç–º—ã | –õ–µ—Ä–º–æ–Ω—Ç–æ–≤ –ú.–Æ.   | 255.90 | 4      |
| 6         | –û—Å—Ç—Ä–æ–≤ —Å–æ–∫—Ä–æ–≤–∏—â       | –°—Ç–∏–≤–µ–Ω—Å–æ–Ω –†.–õ.   | 599.99 | 5      |

*–¢–∞–±–ª–∏—Ü–∞ author*                          
	
| author_id | name_author      |			
|:---------------:|:---------------:|		
| 1         | –ë—É–ª–≥–∞–∫–æ–≤ –ú.–ê.    |
| 2         | –î–æ—Å—Ç–æ–µ–≤—Å–∫–∏–π –§.–ú. |
| 3         | –ï—Å–µ–Ω–∏–Ω –°.–ê.      |
| 4         | –ü–∞—Å—Ç–µ—Ä–Ω–∞–∫ –ë.–õ.   |				
| 5         | –õ–µ—Ä–º–æ–Ω—Ç–æ–≤ –ú.–Æ.   |

*–¢–∞–±–ª–∏—Ü–∞ genre*

| genre_id | name_genre  |	
|:---------------:|:---------------:|		
| 1        | –†–æ–º–∞–Ω       |			
| 2        | –ü–æ—ç–∑–∏—è      |			
| 3        | –ü—Ä–∏–∫–ª—é—á–µ–Ω–∏—è |		

‚úî`–†–ï–®–ï–ù–ò–ï` ‚§µÔ∏è

```sql
UPDATE 
  book 
  JOIN author ON author.author_id = book.author_id 
  JOIN supply ON book.title = supply.title 
  AND supply.author = author.name_author 
SET 
  book.amount = book.amount + supply.amount, 
  book.price = (
    book.price * book.amount + supply.price * supply.amount
  ) / (book.amount + supply.amount), 
  supply.amount = 0 
WHERE 
  book.price <> supply.price;
SELECT 
  * 
FROM 
  book;
SELECT 
  * 
FROM 
  supply;
```

üîé `–†–ï–ó–£–õ–¨–¢–ê–¢` ‚§µÔ∏è

| book_id | title                 | author_id | genre_id | price  | amount |
|:---------------:|:---------------:|:---------------:|:---------------:|:---------------:|:---------------:|
| 1       | –ú–∞—Å—Ç–µ—Ä –∏ –ú–∞—Ä–≥–∞—Ä–∏—Ç–∞    | 1         | 1        | 670.99 | 3      |
| 2       | –ë–µ–ª–∞—è –≥–≤–∞—Ä–¥–∏—è         | 1         | 1        | 540.50 | 5      |
| 3       | –ò–¥–∏–æ—Ç                 | 2         | 1        | 437.11 | 13     |
| 4       | –ë—Ä–∞—Ç—å—è –ö–∞—Ä–∞–º–∞–∑–æ–≤—ã     | 2         | 1        | 799.01 | 3      |
| 5       | –ò–≥—Ä–æ–∫                 | 2         | 1        | 480.50 | 10     |
| 6       | –°—Ç–∏—Ö–æ—Ç–≤–æ—Ä–µ–Ω–∏—è –∏ –ø–æ—ç–º—ã | 3         | 2        | 650.00 | 15     |
| 7       | –ß–µ—Ä–Ω—ã–π —á–µ–ª–æ–≤–µ–∫        | 3         | 2        | 570.20 | 6      |
| 8       | –õ–∏—Ä–∏–∫–∞                | 4         | 2        | 518.99 | 2      |

| supply_id | title                 | author           | price  | amount |
|:---------------:|:---------------:|:---------------:|:---------------:|:---------------:|
| 1         | –î–æ–∫—Ç–æ—Ä –ñ–∏–≤–∞–≥–æ         | –ü–∞—Å—Ç–µ—Ä–Ω–∞–∫ –ë.–õ.   | 380.80 | 4      |
| 2         | –ß–µ—Ä–Ω—ã–π —á–µ–ª–æ–≤–µ–∫        | –ï—Å–µ–Ω–∏–Ω –°.–ê.      | 570.20 | 6      |
| 3         | –ë–µ–ª–∞—è –≥–≤–∞—Ä–¥–∏—è         | –ë—É–ª–≥–∞–∫–æ–≤ –ú.–ê.    | 540.50 | 7      |
| 4         | –ò–¥–∏–æ—Ç                 | –î–æ—Å—Ç–æ–µ–≤—Å–∫–∏–π –§.–ú. | 360.80 | 0      |
| 5         | –°—Ç–∏—Ö–æ—Ç–≤–æ—Ä–µ–Ω–∏—è –∏ –ø–æ—ç–º—ã | –õ–µ—Ä–º–æ–Ω—Ç–æ–≤ –ú.–Æ.   | 255.90 | 4      |
| 6         | –û—Å—Ç—Ä–æ–≤ —Å–æ–∫—Ä–æ–≤–∏—â       | –°—Ç–∏–≤–µ–Ω—Å–æ–Ω –†.–õ.   | 599.99 | 5      |

---

‚ú≥ –®–∞–≥ 3. –ó–∞–ø—Ä–æ—Å—ã –Ω–∞ –¥–æ–±–∞–≤–ª–µ–Ω–∏–µ, —Å–≤—è–∑–∞–Ω–Ω—ã–µ —Ç–∞–±–ª–∏—Ü—ã

‚ùì*–ó–∞–¥–∞–Ω–∏–µ. –í–∫–ª—é—á–∏—Ç—å –Ω–æ–≤—ã—Ö –∞–≤—Ç–æ—Ä–æ–≤ –≤ —Ç–∞–±–ª–∏—Ü—É author —Å –ø–æ–º–æ—â—å—é –∑–∞–ø—Ä–æ—Å–∞ –Ω–∞ –¥–æ–±–∞–≤–ª–µ–Ω–∏–µ, –∞ –∑–∞—Ç–µ–º –≤—ã–≤–µ—Å—Ç–∏ –≤—Å–µ –¥–∞–Ω–Ω—ã–µ –∏–∑ —Ç–∞–±–ª–∏—Ü—ã author.  –ù–æ–≤—ã–º–∏ —Å—á–∏—Ç–∞—é—Ç—Å—è –∞–≤—Ç–æ—Ä—ã, –∫–æ—Ç–æ—Ä—ã–µ –µ—Å—Ç—å –≤ —Ç–∞–±–ª–∏—Ü–µ supply, –Ω–æ –Ω–µ—Ç –≤ —Ç–∞–±–ª–∏—Ü–µ author.*  

*–°—Ç—Ä—É–∫—Ç—É—Ä–∞ –∏ –Ω–∞–ø–æ–ª–Ω–µ–Ω–∏–µ —Ç–∞–±–ª–∏—Ü:*

*–¢–∞–±–ª–∏—Ü–∞ book*

| book_id | title                 | author_id | genre_id | price  | amount |
|:---------------:|:---------------:|:---------------:|:---------------:|:---------------:|:---------------:|
| 1       | –ú–∞—Å—Ç–µ—Ä –∏ –ú–∞—Ä–≥–∞—Ä–∏—Ç–∞    | 1         | 1        | 670.99 | 3      |
| 2       | –ë–µ–ª–∞—è –≥–≤–∞—Ä–¥–∏—è         | 1         | 1        | 540.50 | 5      |
| 3       | –ò–¥–∏–æ—Ç                 | 2         | 1        | 460.00 | 10     |
| 4       | –ë—Ä–∞—Ç—å—è –ö–∞—Ä–∞–º–∞–∑–æ–≤—ã     | 2         | 1        | 799.01 | 3      |
| 5       | –ò–≥—Ä–æ–∫                 | 2         | 1        | 480.50 | 10     |
| 6       | –°—Ç–∏—Ö–æ—Ç–≤–æ—Ä–µ–Ω–∏—è –∏ –ø–æ—ç–º—ã | 3         | 2        | 650.00 | 15     |
| 7       | –ß–µ—Ä–Ω—ã–π —á–µ–ª–æ–≤–µ–∫        | 3         | 2        | 570.20 | 6      |
| 8       | –õ–∏—Ä–∏–∫–∞                | 4         | 2        | 518.99 | 2      |

*–¢–∞–±–ª–∏—Ü–∞ supply*

| supply_id | title                 | author           | price  | amount |
|:---------------:|:---------------:|:---------------:|:---------------:|:---------------:|
| 1         | –î–æ–∫—Ç–æ—Ä –ñ–∏–≤–∞–≥–æ         | –ü–∞—Å—Ç–µ—Ä–Ω–∞–∫ –ë.–õ.   | 380.80 | 4      |
| 2         | –ß–µ—Ä–Ω—ã–π —á–µ–ª–æ–≤–µ–∫        | –ï—Å–µ–Ω–∏–Ω –°.–ê.      | 570.20 | 6      |
| 3         | –ë–µ–ª–∞—è –≥–≤–∞—Ä–¥–∏—è         | –ë—É–ª–≥–∞–∫–æ–≤ –ú.–ê.    | 540.50 | 7      |
| 4         | –ò–¥–∏–æ—Ç                 | –î–æ—Å—Ç–æ–µ–≤—Å–∫–∏–π –§.–ú. | 360.80 | 3      |
| 5         | –°—Ç–∏—Ö–æ—Ç–≤–æ—Ä–µ–Ω–∏—è –∏ –ø–æ—ç–º—ã | –õ–µ—Ä–º–æ–Ω—Ç–æ–≤ –ú.–Æ.   | 255.90 | 4      |
| 6         | –û—Å—Ç—Ä–æ–≤ —Å–æ–∫—Ä–æ–≤–∏—â       | –°—Ç–∏–≤–µ–Ω—Å–æ–Ω –†.–õ.   | 599.99 | 5      |

*–¢–∞–±–ª–∏—Ü–∞ author*                          
	
| author_id | name_author      |			
|:---------------:|:---------------:|		
| 1         | –ë—É–ª–≥–∞–∫–æ–≤ –ú.–ê.    |
| 2         | –î–æ—Å—Ç–æ–µ–≤—Å–∫–∏–π –§.–ú. |
| 3         | –ï—Å–µ–Ω–∏–Ω –°.–ê.      |
| 4         | –ü–∞—Å—Ç–µ—Ä–Ω–∞–∫ –ë.–õ.   |				
| 5         | –õ–µ—Ä–º–æ–Ω—Ç–æ–≤ –ú.–Æ.   |

*–¢–∞–±–ª–∏—Ü–∞ genre*

| genre_id | name_genre  |	
|:---------------:|:---------------:|		
| 1        | –†–æ–º–∞–Ω       |			
| 2        | –ü–æ—ç–∑–∏—è      |			
| 3        | –ü—Ä–∏–∫–ª—é—á–µ–Ω–∏—è |		

‚úî`–†–ï–®–ï–ù–ò–ï` ‚§µÔ∏è

```sql
INSERT INTO author (name_author) 
SELECT 
  supply.author 
FROM 
  author 
  RIGHT JOIN supply ON author.name_author = supply.author 
WHERE 
  name_author IS NULL;
SELECT 
  * 
FROM 
  author;
```

üîé `–†–ï–ó–£–õ–¨–¢–ê–¢` ‚§µÔ∏è

| author_id | name_author      |
|:---------------:|:---------------:|
| 1         | –ë—É–ª–≥–∞–∫–æ–≤ –ú.–ê.    |
| 2         | –î–æ—Å—Ç–æ–µ–≤—Å–∫–∏–π –§.–ú. |
| 3         | –ï—Å–µ–Ω–∏–Ω –°.–ê.      |
| 4         | –ü–∞—Å—Ç–µ—Ä–Ω–∞–∫ –ë.–õ.   |
| 5         | –õ–µ—Ä–º–æ–Ω—Ç–æ–≤ –ú.–Æ.   |
| 6         | –°—Ç–∏–≤–µ–Ω—Å–æ–Ω –†.–õ.   |

---

‚ú≥ –®–∞–≥ 4. –ó–∞–ø—Ä–æ—Å –Ω–∞ –¥–æ–±–∞–≤–ª–µ–Ω–∏–µ, —Å–≤—è–∑–∞–Ω–Ω—ã–µ —Ç–∞–±–ª–∏—Ü—ã

‚ùì*–ó–∞–¥–∞–Ω–∏–µ. –î–æ–±–∞–≤–∏—Ç—å –Ω–æ–≤—ã–µ –∫–Ω–∏–≥–∏ –∏–∑ —Ç–∞–±–ª–∏—Ü—ã supply –≤ —Ç–∞–±–ª–∏—Ü—É book –Ω–∞ –æ—Å–Ω–æ–≤–µ —Å—Ñ–æ—Ä–º–∏—Ä–æ–≤–∞–Ω–Ω–æ–≥–æ –≤—ã—à–µ –∑–∞–ø—Ä–æ—Å–∞. –ó–∞—Ç–µ–º –≤—ã–≤–µ—Å—Ç–∏ –¥–ª—è –ø—Ä–æ—Å–º–æ—Ç—Ä–∞ —Ç–∞–±–ª–∏—Ü—É book.*  

*–°—Ç—Ä—É–∫—Ç—É—Ä–∞ –∏ –Ω–∞–ø–æ–ª–Ω–µ–Ω–∏–µ —Ç–∞–±–ª–∏—Ü:*

*–¢–∞–±–ª–∏—Ü–∞ book*

| book_id | title                 | author_id | genre_id | price  | amount |
|:---------------:|:---------------:|:---------------:|:---------------:|:---------------:|:---------------:|
| 1       | –ú–∞—Å—Ç–µ—Ä –∏ –ú–∞—Ä–≥–∞—Ä–∏—Ç–∞    | 1         | 1        | 670.99 | 3      |
| 2       | –ë–µ–ª–∞—è –≥–≤–∞—Ä–¥–∏—è         | 1         | 1        | 540.50 | 12     |
| 3       | –ò–¥–∏–æ—Ç                 | 2         | 1        | 437.11 | 13     |
| 4       | –ë—Ä–∞—Ç—å—è –ö–∞—Ä–∞–º–∞–∑–æ–≤—ã     | 2         | 1        | 799.01 | 3      |
| 5       | –ò–≥—Ä–æ–∫                 | 2         | 1        | 480.50 | 10     |
| 6       | –°—Ç–∏—Ö–æ—Ç–≤–æ—Ä–µ–Ω–∏—è –∏ –ø–æ—ç–º—ã | 3         | 2        | 650.00 | 15     |
| 7       | –ß–µ—Ä–Ω—ã–π —á–µ–ª–æ–≤–µ–∫        | 3         | 2        | 570.20 | 12     |
| 8       | –õ–∏—Ä–∏–∫–∞                | 4         | 2        | 518.99 | 2      |

*–¢–∞–±–ª–∏—Ü–∞ supply*

| supply_id | title                 | author           | price  | amount |
|:---------------:|:---------------:|:---------------:|:---------------:|:---------------:|
| 1         | –î–æ–∫—Ç–æ—Ä –ñ–∏–≤–∞–≥–æ         | –ü–∞—Å—Ç–µ—Ä–Ω–∞–∫ –ë.–õ.   | 380.80 | 4      |
| 2         | –ß–µ—Ä–Ω—ã–π —á–µ–ª–æ–≤–µ–∫        | –ï—Å–µ–Ω–∏–Ω –°.–ê.      | 570.20 | 0      |
| 3         | –ë–µ–ª–∞—è –≥–≤–∞—Ä–¥–∏—è         | –ë—É–ª–≥–∞–∫–æ–≤ –ú.–ê.    | 540.50 | 0      |
| 4         | –ò–¥–∏–æ—Ç                 | –î–æ—Å—Ç–æ–µ–≤—Å–∫–∏–π –§.–ú. | 360.80 | 0      |
| 5         | –°—Ç–∏—Ö–æ—Ç–≤–æ—Ä–µ–Ω–∏—è –∏ –ø–æ—ç–º—ã | –õ–µ—Ä–º–æ–Ω—Ç–æ–≤ –ú.–Æ.   | 255.90 | 4      |
| 6         | –û—Å—Ç—Ä–æ–≤ —Å–æ–∫—Ä–æ–≤–∏—â       | –°—Ç–∏–≤–µ–Ω—Å–æ–Ω –†.–õ.   | 599.99 | 5      |

*–¢–∞–±–ª–∏—Ü–∞ author*                          
	
| author_id | name_author      |			
|:---------------:|:---------------:|		
| 1         | –ë—É–ª–≥–∞–∫–æ–≤ –ú.–ê.    |
| 2         | –î–æ—Å—Ç–æ–µ–≤—Å–∫–∏–π –§.–ú. |
| 3         | –ï—Å–µ–Ω–∏–Ω –°.–ê.      |
| 4         | –ü–∞—Å—Ç–µ—Ä–Ω–∞–∫ –ë.–õ.   |				
| 5         | –õ–µ—Ä–º–æ–Ω—Ç–æ–≤ –ú.–Æ.   |
| 6         | –°—Ç–∏–≤–µ–Ω—Å–æ–Ω –†.–õ.   |

*–¢–∞–±–ª–∏—Ü–∞ genre*

| genre_id | name_genre  |	
|:---------------:|:---------------:|		
| 1        | –†–æ–º–∞–Ω       |			
| 2        | –ü–æ—ç–∑–∏—è      |			
| 3        | –ü—Ä–∏–∫–ª—é—á–µ–Ω–∏—è |		

‚úî`–†–ï–®–ï–ù–ò–ï` ‚§µÔ∏è

```sql
INSERT INTO book(title, author_id, price, amount) 
SELECT 
  title, 
  author_id, 
  price, 
  amount 
FROM 
  author 
  INNER JOIN supply ON author.name_author = supply.author 
WHERE 
  amount <> 0;
SELECT 
  * 
FROM 
  book;
```

üîé `–†–ï–ó–£–õ–¨–¢–ê–¢` ‚§µÔ∏è

| book_id | title                 | author_id | genre_id | price  | amount |
|:---------------:|:---------------:|:---------------:|:---------------:|:---------------:|:---------------:|
| 1       | –ú–∞—Å—Ç–µ—Ä –∏ –ú–∞—Ä–≥–∞—Ä–∏—Ç–∞    | 1         | 1        | 670.99 | 3      |
| 2       | –ë–µ–ª–∞—è –≥–≤–∞—Ä–¥–∏—è         | 1         | 1        | 540.50 | 12     |
| 3       | –ò–¥–∏–æ—Ç                 | 2         | 1        | 437.11 | 13     |
| 4       | –ë—Ä–∞—Ç—å—è –ö–∞—Ä–∞–º–∞–∑–æ–≤—ã     | 2         | 1        | 799.01 | 3      |
| 5       | –ò–≥—Ä–æ–∫                 | 2         | 1        | 480.50 | 10     |
| 6       | –°—Ç–∏—Ö–æ—Ç–≤–æ—Ä–µ–Ω–∏—è –∏ –ø–æ—ç–º—ã | 3         | 2        | 650.00 | 15     |
| 7       | –ß–µ—Ä–Ω—ã–π —á–µ–ª–æ–≤–µ–∫        | 3         | 2        | 570.20 | 12     |
| 8       | –õ–∏—Ä–∏–∫–∞                | 4         | 2        | 518.99 | 2      |
| 9       | –î–æ–∫—Ç–æ—Ä –ñ–∏–≤–∞–≥–æ         | 4         | NULL     | 380.80 | 4      |
| 10      | –°—Ç–∏—Ö–æ—Ç–≤–æ—Ä–µ–Ω–∏—è –∏ –ø–æ—ç–º—ã | 5         | NULL     | 255.90 | 4      |
| 11      | –û—Å—Ç—Ä–æ–≤ —Å–æ–∫—Ä–æ–≤–∏—â       | 6         | NULL     | 599.99 | 5      |

---

‚ú≥ –®–∞–≥ 5. –ó–∞–ø—Ä–æ—Å –Ω–∞ –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ, –≤–ª–æ–∂–µ–Ω–Ω—ã–µ –∑–∞–ø—Ä–æ—Å—ã

‚ùì*–ó–∞–¥–∞–Ω–∏–µ. –ó–∞–Ω–µ—Å—Ç–∏ –¥–ª—è –∫–Ω–∏–≥–∏ ¬´–°—Ç–∏—Ö–æ—Ç–≤–æ—Ä–µ–Ω–∏—è –∏ –ø–æ—ç–º—ã¬ª –õ–µ—Ä–º–æ–Ω—Ç–æ–≤–∞ –∂–∞–Ω—Ä ¬´–ü–æ—ç–∑–∏—è¬ª, –∞ –¥–ª—è –∫–Ω–∏–≥–∏ ¬´–û—Å—Ç—Ä–æ–≤ —Å–æ–∫—Ä–æ–≤–∏—â¬ª –°—Ç–∏–≤–µ–Ω—Å–æ–Ω–∞ - ¬´–ü—Ä–∏–∫–ª—é—á–µ–Ω–∏—è¬ª. (–ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –¥–≤–∞ –∑–∞–ø—Ä–æ—Å–∞).*  

*–°—Ç—Ä—É–∫—Ç—É—Ä–∞ –∏ –Ω–∞–ø–æ–ª–Ω–µ–Ω–∏–µ —Ç–∞–±–ª–∏—Ü:*

*–¢–∞–±–ª–∏—Ü–∞ book*

| book_id | title                 | author_id | genre_id | price  | amount |
|:---------------:|:---------------:|:---------------:|:---------------:|:---------------:|:---------------:|
| 1       | –ú–∞—Å—Ç–µ—Ä –∏ –ú–∞—Ä–≥–∞—Ä–∏—Ç–∞    | 1         | 1        | 670.99 | 3      |
| 2       | –ë–µ–ª–∞—è –≥–≤–∞—Ä–¥–∏—è         | 1         | 1        | 540.50 | 12     |
| 3       | –ò–¥–∏–æ—Ç                 | 2         | 1        | 437.11 | 13     |
| 4       | –ë—Ä–∞—Ç—å—è –ö–∞—Ä–∞–º–∞–∑–æ–≤—ã     | 2         | 1        | 799.01 | 3      |
| 5       | –ò–≥—Ä–æ–∫                 | 2         | 1        | 480.50 | 10     |
| 6       | –°—Ç–∏—Ö–æ—Ç–≤–æ—Ä–µ–Ω–∏—è –∏ –ø–æ—ç–º—ã | 3         | 2        | 650.00 | 15     |
| 7       | –ß–µ—Ä–Ω—ã–π —á–µ–ª–æ–≤–µ–∫        | 3         | 2        | 570.20 | 12     |
| 8       | –õ–∏—Ä–∏–∫–∞                | 4         | 2        | 518.99 | 2      |
| 9       | –î–æ–∫—Ç–æ—Ä –ñ–∏–≤–∞–≥–æ         | 4         | 1        | 380.80 | 4      |
| 10      | –°—Ç–∏—Ö–æ—Ç–≤–æ—Ä–µ–Ω–∏—è –∏ –ø–æ—ç–º—ã | 5         | Null     | 255.90 | 4      |
| 11      | –û—Å—Ç—Ä–æ–≤ —Å–æ–∫—Ä–æ–≤–∏—â       | 6         | Null     | 599.99 | 5      |

*–¢–∞–±–ª–∏—Ü–∞ author*                          
	
| author_id | name_author      |			
|:---------------:|:---------------:|		
| 1         | –ë—É–ª–≥–∞–∫–æ–≤ –ú.–ê.    |
| 2         | –î–æ—Å—Ç–æ–µ–≤—Å–∫–∏–π –§.–ú. |
| 3         | –ï—Å–µ–Ω–∏–Ω –°.–ê.      |
| 4         | –ü–∞—Å—Ç–µ—Ä–Ω–∞–∫ –ë.–õ.   |				
| 5         | –õ–µ—Ä–º–æ–Ω—Ç–æ–≤ –ú.–Æ.   |
| 6         | –°—Ç–∏–≤–µ–Ω—Å–æ–Ω –†.–õ.   |

*–¢–∞–±–ª–∏—Ü–∞ genre*

| genre_id | name_genre  |	
|:---------------:|:---------------:|		
| 1        | –†–æ–º–∞–Ω       |			
| 2        | –ü–æ—ç–∑–∏—è      |			
| 3        | –ü—Ä–∏–∫–ª—é—á–µ–Ω–∏—è |		

‚úî`–†–ï–®–ï–ù–ò–ï` ‚§µÔ∏è

```sql
UPDATE 
  book 
SET 
  genre_id = (
    SELECT 
      genre_id 
    FROM 
      genre 
    WHERE 
      name_genre = "–ü–æ—ç–∑–∏—è"
  ) 
WHERE 
  book.title = "–°—Ç–∏—Ö–æ—Ç–≤–æ—Ä–µ–Ω–∏—è –∏ –ø–æ—ç–º—ã";
UPDATE 
  book 
SET 
  genre_id = (
    SELECT 
      genre_id 
    FROM 
      genre 
    WHERE 
      name_genre = "–ü—Ä–∏–∫–ª—é—á–µ–Ω–∏—è"
  ) 
WHERE 
  book.title = "–û—Å—Ç—Ä–æ–≤ —Å–æ–∫—Ä–æ–≤–∏—â";
SELECT 
  * 
FROM 
  book;
```

üîé `–†–ï–ó–£–õ–¨–¢–ê–¢` ‚§µÔ∏è

| book_id | title                 | author_id | genre_id | price  | amount |
|:---------------:|:---------------:|:---------------:|:---------------:|:---------------:|:---------------:|
| 1       | –ú–∞—Å—Ç–µ—Ä –∏ –ú–∞—Ä–≥–∞—Ä–∏—Ç–∞    | 1         | 1        | 670.99 | 3      |
| 2       | –ë–µ–ª–∞—è –≥–≤–∞—Ä–¥–∏—è         | 1         | 1        | 540.50 | 12     |
| 3       | –ò–¥–∏–æ—Ç                 | 2         | 1        | 437.11 | 13     |
| 4       | –ë—Ä–∞—Ç—å—è –ö–∞—Ä–∞–º–∞–∑–æ–≤—ã     | 2         | 1        | 799.01 | 3      |
| 5       | –ò–≥—Ä–æ–∫                 | 2         | 1        | 480.50 | 10     |
| 6       | –°—Ç–∏—Ö–æ—Ç–≤–æ—Ä–µ–Ω–∏—è –∏ –ø–æ—ç–º—ã | 3         | 2        | 650.00 | 15     |
| 7       | –ß–µ—Ä–Ω—ã–π —á–µ–ª–æ–≤–µ–∫        | 3         | 2        | 570.20 | 12     |
| 8       | –õ–∏—Ä–∏–∫–∞                | 4         | 2        | 518.99 | 2      |
| 9       | –î–æ–∫—Ç–æ—Ä –ñ–∏–≤–∞–≥–æ         | 4         | 1        | 380.80 | 4      |
| 10      | –°—Ç–∏—Ö–æ—Ç–≤–æ—Ä–µ–Ω–∏—è –∏ –ø–æ—ç–º—ã | 5         | 2        | 255.90 | 4      |
| 11      | –û—Å—Ç—Ä–æ–≤ —Å–æ–∫—Ä–æ–≤–∏—â       | 6         | 3        | 599.99 | 5      |

---

‚ú≥ –®–∞–≥ 6. –ö–∞—Å–∫–∞–¥–Ω–æ–µ —É–¥–∞–ª–µ–Ω–∏–µ –∑–∞–ø–∏—Å–µ–π —Å–≤—è–∑–∞–Ω–Ω—ã—Ö —Ç–∞–±–ª–∏—Ü

‚ùì*–ó–∞–¥–∞–Ω–∏–µ. –£–¥–∞–ª–∏—Ç—å –≤—Å–µ—Ö –∞–≤—Ç–æ—Ä–æ–≤ –∏ –≤—Å–µ –∏—Ö –∫–Ω–∏–≥–∏, –æ–±—â–µ–µ –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –∫–Ω–∏–≥ –∫–æ—Ç–æ—Ä—ã—Ö –º–µ–Ω—å—à–µ 20.*  

*–°—Ç—Ä—É–∫—Ç—É—Ä–∞ –∏ –Ω–∞–ø–æ–ª–Ω–µ–Ω–∏–µ —Ç–∞–±–ª–∏—Ü:*

*–¢–∞–±–ª–∏—Ü–∞ book*

| book_id | title                 | author_id | genre_id | price  | amount |
|:---------------:|:---------------:|:---------------:|:---------------:|:---------------:|:---------------:|
| 1       | –ú–∞—Å—Ç–µ—Ä –∏ –ú–∞—Ä–≥–∞—Ä–∏—Ç–∞    | 1         | 1        | 670.99 | 3      |
| 2       | –ë–µ–ª–∞—è –≥–≤–∞—Ä–¥–∏—è         | 1         | 1        | 540.50 | 12     |
| 3       | –ò–¥–∏–æ—Ç                 | 2         | 1        | 437.11 | 13     |
| 4       | –ë—Ä–∞—Ç—å—è –ö–∞—Ä–∞–º–∞–∑–æ–≤—ã     | 2         | 1        | 799.01 | 3      |
| 5       | –ò–≥—Ä–æ–∫                 | 2         | 1        | 480.50 | 10     |
| 6       | –°—Ç–∏—Ö–æ—Ç–≤–æ—Ä–µ–Ω–∏—è –∏ –ø–æ—ç–º—ã | 3         | 2        | 650.00 | 15     |
| 7       | –ß–µ—Ä–Ω—ã–π —á–µ–ª–æ–≤–µ–∫        | 3         | 2        | 570.20 | 12     |
| 8       | –õ–∏—Ä–∏–∫–∞                | 4         | 2        | 518.99 | 2      |
| 9       | –î–æ–∫—Ç–æ—Ä –ñ–∏–≤–∞–≥–æ         | 4         | 1        | 380.80 | 4      |
| 10      | –°—Ç–∏—Ö–æ—Ç–≤–æ—Ä–µ–Ω–∏—è –∏ –ø–æ—ç–º—ã | 5         | 2        | 255.90 | 4      |
| 11      | –û—Å—Ç—Ä–æ–≤ —Å–æ–∫—Ä–æ–≤–∏—â       | 6         | 3        | 599.99 | 5      |

*–¢–∞–±–ª–∏—Ü–∞ supply*

| supply_id | title                 | author           | price  | amount |
|:---------------:|:---------------:|:---------------:|:---------------:|:---------------:|
| 1         | –î–æ–∫—Ç–æ—Ä –ñ–∏–≤–∞–≥–æ         | –ü–∞—Å—Ç–µ—Ä–Ω–∞–∫ –ë.–õ.   | 380.80 | 4      |
| 2         | –ß–µ—Ä–Ω—ã–π —á–µ–ª–æ–≤–µ–∫        | –ï—Å–µ–Ω–∏–Ω –°.–ê.      | 570.20 | 6      |
| 3         | –ë–µ–ª–∞—è –≥–≤–∞—Ä–¥–∏—è         | –ë—É–ª–≥–∞–∫–æ–≤ –ú.–ê.    | 540.50 | 7      |
| 4         | –ò–¥–∏–æ—Ç                 | –î–æ—Å—Ç–æ–µ–≤—Å–∫–∏–π –§.–ú. | 360.80 | 3      |
| 5         | –°—Ç–∏—Ö–æ—Ç–≤–æ—Ä–µ–Ω–∏—è –∏ –ø–æ—ç–º—ã | –õ–µ—Ä–º–æ–Ω—Ç–æ–≤ –ú.–Æ.   | 255.90 | 4      |
| 6         | –û—Å—Ç—Ä–æ–≤ —Å–æ–∫—Ä–æ–≤–∏—â       | –°—Ç–∏–≤–µ–Ω—Å–æ–Ω –†.–õ.   | 599.99 | 5      |

*–¢–∞–±–ª–∏—Ü–∞ author*                          
	
| author_id | name_author      |			
|:---------------:|:---------------:|		
| 1         | –ë—É–ª–≥–∞–∫–æ–≤ –ú.–ê.    |
| 2         | –î–æ—Å—Ç–æ–µ–≤—Å–∫–∏–π –§.–ú. |
| 3         | –ï—Å–µ–Ω–∏–Ω –°.–ê.      |
| 4         | –ü–∞—Å—Ç–µ—Ä–Ω–∞–∫ –ë.–õ.   |				
| 5         | –õ–µ—Ä–º–æ–Ω—Ç–æ–≤ –ú.–Æ.   |
| 6         | –°—Ç–∏–≤–µ–Ω—Å–æ–Ω –†.–õ.   |

*–¢–∞–±–ª–∏—Ü–∞ genre*

| genre_id | name_genre  |	
|:---------------:|:---------------:|		
| 1        | –†–æ–º–∞–Ω       |			
| 2        | –ü–æ—ç–∑–∏—è      |			
| 3        | –ü—Ä–∏–∫–ª—é—á–µ–Ω–∏—è |		

‚úî`–†–ï–®–ï–ù–ò–ï` ‚§µÔ∏è

```sql
DELETE FROM 
  author 
WHERE 
  author_id IN (
    SELECT 
      author_id 
    FROM 
      book 
    GROUP BY 
      author_id 
    HAVING 
      SUM(amount) < 20
  );
SELECT 
  * 
FROM 
  author;
SELECT 
  * 
FROM 
  book;
```

üîé `–†–ï–ó–£–õ–¨–¢–ê–¢` ‚§µÔ∏è

| author_id | name_author      |
|:---------------:|:---------------:|
| 2         | –î–æ—Å—Ç–æ–µ–≤—Å–∫–∏–π –§.–ú. |
| 3         | –ï—Å–µ–Ω–∏–Ω –°.–ê.      |

| book_id | title                 | author_id | genre_id | price  | amount |
|:---------------:|:---------------:|:---------------:|:---------------:|:---------------:|:---------------:|
| 3       | –ò–¥–∏–æ—Ç                 | 2         | 1        | 437.11 | 13     |
| 4       | –ë—Ä–∞—Ç—å—è –ö–∞—Ä–∞–º–∞–∑–æ–≤—ã     | 2         | 1        | 799.01 | 3      |
| 5       | –ò–≥—Ä–æ–∫                 | 2         | 1        | 480.50 | 10     |
| 6       | –°—Ç–∏—Ö–æ—Ç–≤–æ—Ä–µ–Ω–∏—è –∏ –ø–æ—ç–º—ã | 3         | 2        | 650.00 | 15     |
| 7       | –ß–µ—Ä–Ω—ã–π —á–µ–ª–æ–≤–µ–∫        | 3         | 2        | 570.20 | 12     |

---

‚ú≥ –®–∞–≥ 7. –£–¥–∞–ª–µ–Ω–∏–µ –∑–∞–ø–∏—Å–µ–π –≥–ª–∞–≤–Ω–æ–π —Ç–∞–±–ª–∏—Ü—ã —Å —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ–º –∑–∞–ø–∏—Å–µ–π –≤ –∑–∞–≤–∏—Å–∏–º–æ–π

‚ùì*–ó–∞–¥–∞–Ω–∏–µ. –£–¥–∞–ª–∏—Ç—å –≤—Å–µ –∂–∞–Ω—Ä—ã, –∫ –∫–æ—Ç–æ—Ä—ã–º –æ—Ç–Ω–æ—Å–∏—Ç—Å—è –º–µ–Ω—å—à–µ 4-—Ö –∫–Ω–∏–≥. –í —Ç–∞–±–ª–∏—Ü–µ book –¥–ª—è —ç—Ç–∏—Ö –∂–∞–Ω—Ä–æ–≤ —É—Å—Ç–∞–Ω–æ–≤–∏—Ç—å –∑–Ω–∞—á–µ–Ω–∏–µ Null.*  

*–°—Ç—Ä—É–∫—Ç—É—Ä–∞ –∏ –Ω–∞–ø–æ–ª–Ω–µ–Ω–∏–µ —Ç–∞–±–ª–∏—Ü:*

*–¢–∞–±–ª–∏—Ü–∞ book*

| book_id | title                 | author_id | genre_id | price  | amount |
|:---------------:|:---------------:|:---------------:|:---------------:|:---------------:|:---------------:|
| 1       | –ú–∞—Å—Ç–µ—Ä –∏ –ú–∞—Ä–≥–∞—Ä–∏—Ç–∞    | 1         | 1        | 670.99 | 3      |
| 2       | –ë–µ–ª–∞—è –≥–≤–∞—Ä–¥–∏—è         | 1         | 1        | 540.50 | 12     |
| 3       | –ò–¥–∏–æ—Ç                 | 2         | 1        | 437.11 | 13     |
| 4       | –ë—Ä–∞—Ç—å—è –ö–∞—Ä–∞–º–∞–∑–æ–≤—ã     | 2         | 1        | 799.01 | 3      |
| 5       | –ò–≥—Ä–æ–∫                 | 2         | 1        | 480.50 | 10     |
| 6       | –°—Ç–∏—Ö–æ—Ç–≤–æ—Ä–µ–Ω–∏—è –∏ –ø–æ—ç–º—ã | 3         | 2        | 650.00 | 15     |
| 7       | –ß–µ—Ä–Ω—ã–π —á–µ–ª–æ–≤–µ–∫        | 3         | 2        | 570.20 | 12     |
| 8       | –õ–∏—Ä–∏–∫–∞                | 4         | 2        | 518.99 | 2      |
| 9       | –î–æ–∫—Ç–æ—Ä –ñ–∏–≤–∞–≥–æ         | 4         | 1        | 380.80 | 4      |
| 10      | –°—Ç–∏—Ö–æ—Ç–≤–æ—Ä–µ–Ω–∏—è –∏ –ø–æ—ç–º—ã | 5         | 2        | 255.90 | 4      |
| 11      | –û—Å—Ç—Ä–æ–≤ —Å–æ–∫—Ä–æ–≤–∏—â       | 6         | 3        | 599.99 | 5      |

*–¢–∞–±–ª–∏—Ü–∞ supply*

| supply_id | title                 | author           | price  | amount |
|:---------------:|:---------------:|:---------------:|:---------------:|:---------------:|
| 1         | –î–æ–∫—Ç–æ—Ä –ñ–∏–≤–∞–≥–æ         | –ü–∞—Å—Ç–µ—Ä–Ω–∞–∫ –ë.–õ.   | 380.80 | 4      |
| 2         | –ß–µ—Ä–Ω—ã–π —á–µ–ª–æ–≤–µ–∫        | –ï—Å–µ–Ω–∏–Ω –°.–ê.      | 570.20 | 6      |
| 3         | –ë–µ–ª–∞—è –≥–≤–∞—Ä–¥–∏—è         | –ë—É–ª–≥–∞–∫–æ–≤ –ú.–ê.    | 540.50 | 7      |
| 4         | –ò–¥–∏–æ—Ç                 | –î–æ—Å—Ç–æ–µ–≤—Å–∫–∏–π –§.–ú. | 360.80 | 3      |
| 5         | –°—Ç–∏—Ö–æ—Ç–≤–æ—Ä–µ–Ω–∏—è –∏ –ø–æ—ç–º—ã | –õ–µ—Ä–º–æ–Ω—Ç–æ–≤ –ú.–Æ.   | 255.90 | 4      |
| 6         | –û—Å—Ç—Ä–æ–≤ —Å–æ–∫—Ä–æ–≤–∏—â       | –°—Ç–∏–≤–µ–Ω—Å–æ–Ω –†.–õ.   | 599.99 | 5      |

*–¢–∞–±–ª–∏—Ü–∞ author*                          
	
| author_id | name_author      |			
|:---------------:|:---------------:|		
| 1         | –ë—É–ª–≥–∞–∫–æ–≤ –ú.–ê.    |
| 2         | –î–æ—Å—Ç–æ–µ–≤—Å–∫–∏–π –§.–ú. |
| 3         | –ï—Å–µ–Ω–∏–Ω –°.–ê.      |
| 4         | –ü–∞—Å—Ç–µ—Ä–Ω–∞–∫ –ë.–õ.   |				
| 5         | –õ–µ—Ä–º–æ–Ω—Ç–æ–≤ –ú.–Æ.   |
| 6         | –°—Ç–∏–≤–µ–Ω—Å–æ–Ω –†.–õ.   |

*–¢–∞–±–ª–∏—Ü–∞ genre*

| genre_id | name_genre  |	
|:---------------:|:---------------:|		
| 1        | –†–æ–º–∞–Ω       |			
| 2        | –ü–æ—ç–∑–∏—è      |			
| 3        | –ü—Ä–∏–∫–ª—é—á–µ–Ω–∏—è |		

‚úî`–†–ï–®–ï–ù–ò–ï` ‚§µÔ∏è

```sql
DELETE FROM 
  genre 
WHERE 
  genre_id IN (
    SELECT 
      genre_id 
    FROM 
      book 
    GROUP BY 
      genre_id 
    HAVING 
      COUNT(title) < 4
  );
SELECT 
  * 
FROM 
  genre;
SELECT 
  * 
FROM 
  book;
```

üîé `–†–ï–ó–£–õ–¨–¢–ê–¢` ‚§µÔ∏è

| genre_id | name_genre |
|:---------------:|:---------------:|
| 1        | –†–æ–º–∞–Ω      |
| 2        | –ü–æ—ç–∑–∏—è     |

| book_id | title                 | author_id | genre_id | price  | amount |
|:---------------:|:---------------:|:---------------:|:---------------:|:---------------:|:---------------:|
| 1       | –ú–∞—Å—Ç–µ—Ä –∏ –ú–∞—Ä–≥–∞—Ä–∏—Ç–∞    | 1         | 1        | 670.99 | 3      |
| 2       | –ë–µ–ª–∞—è –≥–≤–∞—Ä–¥–∏—è         | 1         | 1        | 540.50 | 12     |
| 3       | –ò–¥–∏–æ—Ç                 | 2         | 1        | 437.11 | 13     |
| 4       | –ë—Ä–∞—Ç—å—è –ö–∞—Ä–∞–º–∞–∑–æ–≤—ã     | 2         | 1        | 799.01 | 3      |
| 5       | –ò–≥—Ä–æ–∫                 | 2         | 1        | 480.50 | 10     |
| 6       | –°—Ç–∏—Ö–æ—Ç–≤–æ—Ä–µ–Ω–∏—è –∏ –ø–æ—ç–º—ã | 3         | 2        | 650.00 | 15     |
| 7       | –ß–µ—Ä–Ω—ã–π —á–µ–ª–æ–≤–µ–∫        | 3         | 2        | 570.20 | 12     |
| 8       | –õ–∏—Ä–∏–∫–∞                | 4         | 2        | 518.99 | 2      |
| 9       | –î–æ–∫—Ç–æ—Ä –ñ–∏–≤–∞–≥–æ         | 4         | 1        | 380.80 | 4      |
| 10      | –°—Ç–∏—Ö–æ—Ç–≤–æ—Ä–µ–Ω–∏—è –∏ –ø–æ—ç–º—ã | 5         | 2        | 255.90 | 4      |
| 11      | –û—Å—Ç—Ä–æ–≤ —Å–æ–∫—Ä–æ–≤–∏—â       | 6         | NULL     | 599.99 | 5      |

---

‚ú≥ –®–∞–≥ 8. –£–¥–∞–ª–µ–Ω–∏–µ –∑–∞–ø–∏—Å–µ–π, –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ —Å–≤—è–∑–∞–Ω–Ω—ã—Ö —Ç–∞–±–ª–∏—Ü

‚ùì*–ó–∞–¥–∞–Ω–∏–µ. –£–¥–∞–ª–∏—Ç—å –≤—Å–µ—Ö –∞–≤—Ç–æ—Ä–æ–≤, –∫–æ—Ç–æ—Ä—ã–µ –ø–∏—à—É—Ç –≤ –∂–∞–Ω—Ä–µ "–ü–æ—ç–∑–∏—è". –ò–∑ —Ç–∞–±–ª–∏—Ü—ã book —É–¥–∞–ª–∏—Ç—å –≤—Å–µ –∫–Ω–∏–≥–∏ —ç—Ç–∏—Ö –∞–≤—Ç–æ—Ä–æ–≤. –í –∑–∞–ø—Ä–æ—Å–µ –¥–ª—è –æ—Ç–±–æ—Ä–∞ –∞–≤—Ç–æ—Ä–æ–≤ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –ø–æ–ª–Ω–æ–µ –Ω–∞–∑–≤–∞–Ω–∏–µ –∂–∞–Ω—Ä–∞, –∞ –Ω–µ –µ–≥–æ id.*  

*–°—Ç—Ä—É–∫—Ç—É—Ä–∞ –∏ –Ω–∞–ø–æ–ª–Ω–µ–Ω–∏–µ —Ç–∞–±–ª–∏—Ü:*

*–¢–∞–±–ª–∏—Ü–∞ book*

| book_id | title                 | author_id | genre_id | price  | amount |
|:---------------:|:---------------:|:---------------:|:---------------:|:---------------:|:---------------:|
| 1       | –ú–∞—Å—Ç–µ—Ä –∏ –ú–∞—Ä–≥–∞—Ä–∏—Ç–∞    | 1         | 1        | 670.99 | 3      |
| 2       | –ë–µ–ª–∞—è –≥–≤–∞—Ä–¥–∏—è         | 1         | 1        | 540.50 | 12     |
| 3       | –ò–¥–∏–æ—Ç                 | 2         | 1        | 437.11 | 13     |
| 4       | –ë—Ä–∞—Ç—å—è –ö–∞—Ä–∞–º–∞–∑–æ–≤—ã     | 2         | 1        | 799.01 | 3      |
| 5       | –ò–≥—Ä–æ–∫                 | 2         | 1        | 480.50 | 10     |
| 6       | –°—Ç–∏—Ö–æ—Ç–≤–æ—Ä–µ–Ω–∏—è –∏ –ø–æ—ç–º—ã | 3         | 2        | 650.00 | 15     |
| 7       | –ß–µ—Ä–Ω—ã–π —á–µ–ª–æ–≤–µ–∫        | 3         | 2        | 570.20 | 12     |
| 8       | –õ–∏—Ä–∏–∫–∞                | 4         | 2        | 518.99 | 2      |
| 9       | –î–æ–∫—Ç–æ—Ä –ñ–∏–≤–∞–≥–æ         | 4         | 1        | 380.80 | 4      |
| 10      | –°—Ç–∏—Ö–æ—Ç–≤–æ—Ä–µ–Ω–∏—è –∏ –ø–æ—ç–º—ã | 5         | 2        | 255.90 | 4      |
| 11      | –û—Å—Ç—Ä–æ–≤ —Å–æ–∫—Ä–æ–≤–∏—â       | 6         | 3        | 599.99 | 5      |

*–¢–∞–±–ª–∏—Ü–∞ supply*

| supply_id | title                 | author           | price  | amount |
|:---------------:|:---------------:|:---------------:|:---------------:|:---------------:|
| 1         | –î–æ–∫—Ç–æ—Ä –ñ–∏–≤–∞–≥–æ         | –ü–∞—Å—Ç–µ—Ä–Ω–∞–∫ –ë.–õ.   | 380.80 | 4      |
| 2         | –ß–µ—Ä–Ω—ã–π —á–µ–ª–æ–≤–µ–∫        | –ï—Å–µ–Ω–∏–Ω –°.–ê.      | 570.20 | 6      |
| 3         | –ë–µ–ª–∞—è –≥–≤–∞—Ä–¥–∏—è         | –ë—É–ª–≥–∞–∫–æ–≤ –ú.–ê.    | 540.50 | 7      |
| 4         | –ò–¥–∏–æ—Ç                 | –î–æ—Å—Ç–æ–µ–≤—Å–∫–∏–π –§.–ú. | 360.80 | 3      |
| 5         | –°—Ç–∏—Ö–æ—Ç–≤–æ—Ä–µ–Ω–∏—è –∏ –ø–æ—ç–º—ã | –õ–µ—Ä–º–æ–Ω—Ç–æ–≤ –ú.–Æ.   | 255.90 | 4      |
| 6         | –û—Å—Ç—Ä–æ–≤ —Å–æ–∫—Ä–æ–≤–∏—â       | –°—Ç–∏–≤–µ–Ω—Å–æ–Ω –†.–õ.   | 599.99 | 5      |

*–¢–∞–±–ª–∏—Ü–∞ author*                          
	
| author_id | name_author      |			
|:---------------:|:---------------:|		
| 1         | –ë—É–ª–≥–∞–∫–æ–≤ –ú.–ê.    |
| 2         | –î–æ—Å—Ç–æ–µ–≤—Å–∫–∏–π –§.–ú. |
| 3         | –ï—Å–µ–Ω–∏–Ω –°.–ê.      |
| 4         | –ü–∞—Å—Ç–µ—Ä–Ω–∞–∫ –ë.–õ.   |				
| 5         | –õ–µ—Ä–º–æ–Ω—Ç–æ–≤ –ú.–Æ.   |
| 6         | –°—Ç–∏–≤–µ–Ω—Å–æ–Ω –†.–õ.   |

*–¢–∞–±–ª–∏—Ü–∞ genre*

| genre_id | name_genre  |	
|:---------------:|:---------------:|		
| 1        | –†–æ–º–∞–Ω       |			
| 2        | –ü–æ—ç–∑–∏—è      |			
| 3        | –ü—Ä–∏–∫–ª—é—á–µ–Ω–∏—è |		

‚úî`–†–ï–®–ï–ù–ò–ï` ‚§µÔ∏è

```sql
DELETE FROM 
  author USING author 
  INNER JOIN book ON author.author_id = book.author_id 
  INNER JOIN genre ON genre.genre_id = book.genre_id 
WHERE 
  name_genre = '–ü–æ—ç–∑–∏—è';
SELECT 
  * 
FROM 
  author;
SELECT 
  * 
FROM 
  book;
```

üîé `–†–ï–ó–£–õ–¨–¢–ê–¢` ‚§µÔ∏è

| author_id | name_author      |
|:---------------:|:---------------:|
| 1         | –ë—É–ª–≥–∞–∫–æ–≤ –ú.–ê.    |
| 2         | –î–æ—Å—Ç–æ–µ–≤—Å–∫–∏–π –§.–ú. |
| 6         | –°—Ç–∏–≤–µ–Ω—Å–æ–Ω –†.–õ.   |

| book_id | title                 | author_id | genre_id | price  | amount |
|:---------------:|:---------------:|:---------------:|:---------------:|:---------------:|:---------------:|
| 1       | –ú–∞—Å—Ç–µ—Ä –∏ –ú–∞—Ä–≥–∞—Ä–∏—Ç–∞ | 1         | 1        | 670.99 | 3      |
| 2       | –ë–µ–ª–∞—è –≥–≤–∞—Ä–¥–∏—è      | 1         | 1        | 540.50 | 12     |
| 3       | –ò–¥–∏–æ—Ç              | 2         | 1        | 437.11 | 13     |
| 4       | –ë—Ä–∞—Ç—å—è –ö–∞—Ä–∞–º–∞–∑–æ–≤—ã  | 2         | 1        | 799.01 | 3      |
| 5       | –ò–≥—Ä–æ–∫              | 2         | 1        | 480.50 | 10     |
| 11      | –û—Å—Ç—Ä–æ–≤ —Å–æ–∫—Ä–æ–≤–∏—â    | 6         | 3        | 599.99 | 5      |

---

## 2.4 –ë–∞–∑–∞ –¥–∞–Ω–Ω—ã—Ö ¬´–ò–Ω—Ç–µ—Ä–Ω–µ—Ç-–º–∞–≥–∞–∑–∏–Ω –∫–Ω–∏–≥¬ª, –∑–∞–ø—Ä–æ—Å—ã –Ω–∞ –≤—ã–±–æ—Ä–∫—É

–í –∏–Ω—Ç–µ—Ä–Ω–µ—Ç-–º–∞–≥–∞–∑–∏–Ω–µ –ø—Ä–æ–¥–∞—é—Ç—Å—è –∫–Ω–∏–≥–∏. –ö–∞–∂–¥–∞—è –∫–Ω–∏–≥–∞ –∏–º–µ–µ—Ç –Ω–∞–∑–≤–∞–Ω–∏–µ, –Ω–∞–ø–∏—Å–∞–Ω–∞ –æ–¥–Ω–∏–º –∞–≤—Ç–æ—Ä–æ–º, –æ—Ç–Ω–æ—Å–∏—Ç—Å—è –∫ –æ–¥–Ω–æ–º—É –∂–∞–Ω—Ä—É, –∏–º–µ–µ—Ç –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–Ω—É—é —Ü–µ–Ω—É. –í –º–∞–≥–∞–∑–∏–Ω–µ –≤ –Ω–∞–ª–∏—á–∏–∏ –µ—Å—Ç—å –Ω–µ—Å–∫–æ–ª—å–∫–æ —ç–∫–∑–µ–º–ø–ª—è—Ä–æ–≤ –∫–∞–∂–¥–æ–π –∫–Ω–∏–≥–∏.   
–ü–æ–∫—É–ø–∞—Ç–µ–ª—å —Ä–µ–≥–∏—Å—Ç—Ä–∏—Ä—É–µ—Ç—Å—è –Ω–∞ —Å–∞–π—Ç–µ –∏–Ω—Ç–µ—Ä–Ω–µ—Ç-–º–∞–≥–∞–∑–∏–Ω–∞, –∑–∞–¥–∞–µ—Ç —Å–≤–æ–µ –∏–º—è –∏ —Ñ–∞–º–∏–ª–∏—é, —ç–ª–µ–∫—Ç—Ä–æ–Ω–Ω—É—é –ø–æ—á—Ç—É –∏ –≥–æ—Ä–æ–¥ –ø—Ä–æ–∂–∏–≤–∞–Ω–∏—è. –û–Ω –º–æ–∂–µ—Ç —Å—Ñ–æ—Ä–º–∏—Ä–æ–≤–∞—Ç—å –æ–¥–∏–Ω –∏–ª–∏ –Ω–µ—Å–∫–æ–ª—å–∫–æ –∑–∞–∫–∞–∑–æ–≤, –¥–ª—è –∫–∞–∂–¥–æ–≥–æ –∑–∞–∫–∞–∑–∞ –Ω–∞–ø–∏—Å–∞—Ç—å –∫–∞–∫–∏–µ-—Ç–æ –ø–æ–∂–µ–ª–∞–Ω–∏—è. –ö–∞–∂–¥—ã–π –∑–∞–∫–∞–∑ –≤–∫–ª—é—á–∞–µ—Ç –æ–¥–Ω—É –∏–ª–∏ –Ω–µ—Å–∫–æ–ª—å–∫–æ –∫–Ω–∏–≥, –∫–∞–∂–¥—É—é –∫–Ω–∏–≥—É –º–æ–∂–Ω–æ –∑–∞–∫–∞–∑–∞—Ç—å –≤ –Ω–µ—Å–∫–æ–ª—å–∫–∏—Ö —ç–∫–∑–µ–º–ø–ª—è—Ä–∞—Ö. –ó–∞—Ç–µ–º –∑–∞–∫–∞–∑ –ø—Ä–æ—Ö–æ–¥–∏—Ç —Ä—è–¥ –ø–æ—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å–Ω—ã—Ö —ç—Ç–∞–ø–æ–≤ (–æ–ø–µ—Ä–∞—Ü–∏–π): –æ–ø–ª–∞—á–∏–≤–∞–µ—Ç—Å—è, —É–ø–∞–∫–æ–≤—ã–≤–∞–µ—Ç—Å—è, –ø–µ—Ä–µ–¥–∞–µ—Ç—Å—è –∫—É—Ä—å–µ—Ä—É –∏–ª–∏ —Ç—Ä–∞–Ω—Å–ø–æ—Ä—Ç–Ω–æ–π –∫–æ–º–ø–∞–Ω–∏–∏ –¥–ª—è —Ç—Ä–∞–Ω—Å–ø–æ—Ä—Ç–∏—Ä–æ–≤–∫–∏ –∏, –Ω–∞–∫–æ–Ω–µ—Ü, –¥–æ—Å—Ç–∞–≤–ª—è–µ—Ç—Å—è –ø–æ–∫—É–ø–∞—Ç–µ–ª—é. –§–∏–∫—Å–∏—Ä—É–µ—Ç—Å—è –¥–∞—Ç–∞ –∫–∞–∂–¥–æ–π –æ–ø–µ—Ä–∞—Ü–∏–∏. –î–ª—è –∫–∞–∂–¥–æ–≥–æ –≥–æ—Ä–æ–¥–∞ –∏–∑–≤–µ—Å—Ç–Ω–æ —Å—Ä–µ–¥–Ω–µ–µ –≤—Ä–µ–º—è –¥–æ—Å—Ç–∞–≤–∫–∏ –∫–Ω–∏–≥.  
–ü—Ä–∏ —ç—Ç–æ–º –≤ –º–∞–≥–∞–∑–∏–Ω–µ –≤–µ–¥–µ—Ç—Å—è —É—á–µ—Ç –∫–Ω–∏–≥, –ø—Ä–∏ –ø–æ–∫—É–ø–∫–µ –∏—Ö –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ —É–º–µ–Ω—å—à–∞–µ—Ç—Å—è, –ø—Ä–∏ –ø–æ—Å—Ç—É–ø–ª–µ–Ω–∏–∏ —Ç–æ–≤–∞—Ä–∞ —É–≤–µ–ª–∏—á–∏–≤–∞–µ—Ç—Å—è, –ø—Ä–∏ –∏—Å—á–µ—Ä–ø–∞–Ω–∏–∏ –∫–æ–ª–∏—á–µ—Å—Ç–≤–∞ ‚Äì –æ—Ñ–æ—Ä–º–ª—è–µ—Ç—Å—è –∑–∞–∫–∞–∑ –∏ –ø—Ä.  
–í –¥–∞–Ω–Ω–æ–º —É—Ä–æ–∫–µ —Å–Ω–∞—á–∞–ª–∞ –±—É–¥–µ—Ç –ø–æ—Å—Ç—Ä–æ–µ–Ω–∞ –∫–æ–Ω—Ü–µ–ø—Ç—É–∞–ª—å–Ω–∞—è –º–æ–¥–µ–ª—å –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö, –∑–∞—Ç–µ–º –µ–µ –ª–æ–≥–∏—á–µ—Å–∫–∞—è –º–æ–¥–µ–ª—å. –¢–∞–∫–∂–µ –±—É–¥—É—Ç –æ–ø—Ä–µ–¥–µ–ª–µ–Ω—ã —Å—Ç—Ä—É–∫—Ç—É—Ä–∞ –∏ —Å–æ–¥–µ—Ä–∂–∞–Ω–∏–µ —Ç–∞–±–ª–∏—Ü –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö ¬´–ò–Ω—Ç–µ—Ä–Ω–µ—Ç-–º–∞–≥–∞–∑–∏–Ω –∫–Ω–∏–≥¬ª.

–õ–æ–≥–∏—á–µ—Å–∫–∞—è —Å—Ö–µ–º–∞ –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö:

![](https://ucarecdn.com/bbf07d33-64e8-4391-8cde-4fcb75d4cec1/)

–õ–æ–≥–∏—á–µ—Å–∫–∞—è –º–æ–¥–µ–ª—å –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö:

![](https://ucarecdn.com/bad26356-5e34-4945-a9d4-0748686a6b54/)

–ù–∞–ø–æ–ª–Ω–µ–Ω–∏–µ —Ç–∞–±–ª–∏—Ü:

![](https://ucarecdn.com/09eb90ce-ce66-446b-8337-e391caabff1c/)

‚ú≥ –®–∞–≥ 5. –ó–∞–ø—Ä–æ—Å—ã –Ω–∞ –æ—Å–Ω–æ–≤–µ —Ç—Ä–µ—Ö –∏ –±–æ–ª–µ–µ —Å–≤—è–∑–∞–Ω–Ω—ã—Ö —Ç–∞–±–ª–∏—Ü

‚ùì*–ó–∞–¥–∞–Ω–∏–µ. –í—ã–≤–µ—Å—Ç–∏ –≤—Å–µ –∑–∞–∫–∞–∑—ã –ë–∞—Ä–∞–Ω–æ–≤–∞ –ü–∞–≤–ª–∞ (id –∑–∞–∫–∞–∑–∞, –∫–∞–∫–∏–µ –∫–Ω–∏–≥–∏, –ø–æ –∫–∞–∫–æ–π —Ü–µ–Ω–µ –∏ –≤ –∫–∞–∫–æ–º –∫–æ–ª–∏—á–µ—Å—Ç–≤–µ –æ–Ω –∑–∞–∫–∞–∑–∞–ª) –≤ –æ—Ç—Å–æ—Ä—Ç–∏—Ä–æ–≤–∞–Ω–Ω–æ–º –ø–æ –Ω–æ–º–µ—Ä—É –∑–∞–∫–∞–∑–∞ –∏ –Ω–∞–∑–≤–∞–Ω–∏—è–º –∫–Ω–∏–≥ –≤–∏–¥–µ.* 

‚úî`–†–ï–®–ï–ù–ò–ï` ‚§µÔ∏è

```sql
SELECT 
  buy.buy_id, 
  book.title, 
  book.price, 
  buy_book.amount 
FROM 
  client 
  INNER JOIN buy ON client.client_id = buy.client_id 
  INNER JOIN buy_book ON buy.buy_id = buy_book.buy_id 
  INNER JOIN book ON buy_book.book_id = book.book_id 
WHERE 
  name_client = "–ë–∞—Ä–∞–Ω–æ–≤ –ü–∞–≤–µ–ª" 
ORDER BY 
  buy_id, 
  title;
```

üîé `–†–ï–ó–£–õ–¨–¢–ê–¢` ‚§µÔ∏è

| buy_id | title              | price  | amount |
|:---------------:|:---------------:|:---------------:|:---------------:|
| 1      | –ò–¥–∏–æ—Ç              | 460.00 | 1      |
| 1      | –ú–∞—Å—Ç–µ—Ä –∏ –ú–∞—Ä–≥–∞—Ä–∏—Ç–∞ | 670.99 | 1      |
| 1      | –ß–µ—Ä–Ω—ã–π —á–µ–ª–æ–≤–µ–∫     | 570.20 | 2      |
| 4      | –ò–≥—Ä–æ–∫              | 480.50 | 1      |

---

‚ú≥ –®–∞–≥ 6. 

‚ùì*–ó–∞–¥–∞–Ω–∏–µ. –ü–æ—Å—á–∏—Ç–∞—Ç—å, —Å–∫–æ–ª—å–∫–æ —Ä–∞–∑ –±—ã–ª–∞ –∑–∞–∫–∞–∑–∞–Ω–∞ –∫–∞–∂–¥–∞—è –∫–Ω–∏–≥–∞, –¥–ª—è –∫–Ω–∏–≥–∏ –≤—ã–≤–µ—Å—Ç–∏ –µ–µ –∞–≤—Ç–æ—Ä–∞ (–Ω—É–∂–Ω–æ –ø–æ—Å—á–∏—Ç–∞—Ç—å, –≤ –∫–∞–∫–æ–º –∫–æ–ª–∏—á–µ—Å—Ç–≤–µ –∑–∞–∫–∞–∑–æ–≤ —Ñ–∏–≥—É—Ä–∏—Ä—É–µ—Ç –∫–∞–∂–¥–∞—è –∫–Ω–∏–≥–∞).  –í—ã–≤–µ—Å—Ç–∏ —Ñ–∞–º–∏–ª–∏—é –∏ –∏–Ω–∏—Ü–∏–∞–ª—ã –∞–≤—Ç–æ—Ä–∞, –Ω–∞–∑–≤–∞–Ω–∏–µ –∫–Ω–∏–≥–∏, –ø–æ—Å–ª–µ–¥–Ω–∏–π —Å—Ç–æ–ª–±–µ—Ü –Ω–∞–∑–≤–∞—Ç—å –ö–æ–ª–∏—á–µ—Å—Ç–≤–æ. –†–µ–∑—É–ª—å—Ç–∞—Ç –æ—Ç—Å–æ—Ä—Ç–∏—Ä–æ–≤–∞—Ç—å —Å–Ω–∞—á–∞–ª–∞  –ø–æ —Ñ–∞–º–∏–ª–∏—è–º –∞–≤—Ç–æ—Ä–æ–≤, –∞ –ø–æ—Ç–æ–º –ø–æ –Ω–∞–∑–≤–∞–Ω–∏—è–º –∫–Ω–∏–≥.* 

*–§—Ä–∞–≥–º–µ–Ω—Ç –ª–æ–≥–∏—á–µ—Å–∫–æ–π —Å—Ö–µ–º—ã –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö:*

![](https://ucarecdn.com/c9356f96-1b19-42ce-8c9e-e7a8169734fc/)

‚úî`–†–ï–®–ï–ù–ò–ï` ‚§µÔ∏è

```sql
SELECT 
  name_author, 
  title, 
  COUNT(buy_book.amount) AS –ö–æ–ª–∏—á–µ—Å—Ç–≤–æ 
FROM 
  author 
  INNER JOIN book USING(author_id) 
  LEFT JOIN buy_book USING(book_id) 
GROUP BY 
  book.title, 
  name_author 
ORDER BY 
  name_author, 
  title;
```

üîé `–†–ï–ó–£–õ–¨–¢–ê–¢` ‚§µÔ∏è

| name_author      | title                 | –ö–æ–ª–∏—á–µ—Å—Ç–≤–æ |
|:---------------:|:---------------:|:---------------:|
| –ë—É–ª–≥–∞–∫–æ–≤ –ú.–ê.    | –ë–µ–ª–∞—è –≥–≤–∞—Ä–¥–∏—è         | 1          |
| –ë—É–ª–≥–∞–∫–æ–≤ –ú.–ê.    | –ú–∞—Å—Ç–µ—Ä –∏ –ú–∞—Ä–≥–∞—Ä–∏—Ç–∞    | 2          |
| –î–æ—Å—Ç–æ–µ–≤—Å–∫–∏–π –§.–ú. | –ë—Ä–∞—Ç—å—è –ö–∞—Ä–∞–º–∞–∑–æ–≤—ã     | 0          |
| –î–æ—Å—Ç–æ–µ–≤—Å–∫–∏–π –§.–ú. | –ò–≥—Ä–æ–∫                 | 1          |
| –î–æ—Å—Ç–æ–µ–≤—Å–∫–∏–π –§.–ú. | –ò–¥–∏–æ—Ç                 | 2          |
| –ï—Å–µ–Ω–∏–Ω –°.–ê.      | –°—Ç–∏—Ö–æ—Ç–≤–æ—Ä–µ–Ω–∏—è –∏ –ø–æ—ç–º—ã | 0          |
| –ï—Å–µ–Ω–∏–Ω –°.–ê.      | –ß–µ—Ä–Ω—ã–π —á–µ–ª–æ–≤–µ–∫        | 1          |
| –ü–∞—Å—Ç–µ—Ä–Ω–∞–∫ –ë.–õ.   | –õ–∏—Ä–∏–∫–∞                | 1          |

---

‚ú≥ –®–∞–≥ 7. 

‚ùì*–ó–∞–¥–∞–Ω–∏–µ. –í—ã–≤–µ—Å—Ç–∏ –≥–æ—Ä–æ–¥–∞, –≤ –∫–æ—Ç–æ—Ä—ã—Ö –∂–∏–≤—É—Ç –∫–ª–∏–µ–Ω—Ç—ã, –æ—Ñ–æ—Ä–º–ª—è–≤—à–∏–µ –∑–∞–∫–∞–∑—ã –≤ –∏–Ω—Ç–µ—Ä–Ω–µ—Ç-–º–∞–≥–∞–∑–∏–Ω–µ. –£–∫–∞–∑–∞—Ç—å –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –∑–∞–∫–∞–∑–æ–≤ –≤ –∫–∞–∂–¥—ã–π –≥–æ—Ä–æ–¥, —ç—Ç–æ—Ç —Å—Ç–æ–ª–±–µ—Ü –Ω–∞–∑–≤–∞—Ç—å –ö–æ–ª–∏—á–µ—Å—Ç–≤–æ. –ò–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é –≤—ã–≤–µ—Å—Ç–∏ –ø–æ —É–±—ã–≤–∞–Ω–∏—é –∫–æ–ª–∏—á–µ—Å—Ç–≤–∞ –∑–∞–∫–∞–∑–æ–≤, –∞ –∑–∞—Ç–µ–º –≤ –∞–ª—Ñ–∞–≤–∏—Ç–Ω–æ–º –ø–æ—Ä—è–¥–∫–µ –ø–æ –Ω–∞–∑–≤–∞–Ω–∏—é –≥–æ—Ä–æ–¥–æ–≤.* 

*–§—Ä–∞–≥–º–µ–Ω—Ç –ª–æ–≥–∏—á–µ—Å–∫–æ–π —Å—Ö–µ–º—ã –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö:*

![](https://ucarecdn.com/1e4836b9-6cf8-41bd-9f82-38b11c7882aa/)

‚úî`–†–ï–®–ï–ù–ò–ï` ‚§µÔ∏è

```sql
SELECT 
  name_city, 
  COUNT(buy_id) AS –ö–æ–ª–∏—á–µ—Å—Ç–≤–æ 
FROM 
  city 
  INNER JOIN client ON city.city_id = client.city_id 
  INNER JOIN buy ON client.client_id = buy.client_id 
GROUP BY 
  name_city 
ORDER BY 
  2 DESC, 
  name_city;
```

üîé `–†–ï–ó–£–õ–¨–¢–ê–¢` ‚§µÔ∏è

| name_city       | –ö–æ–ª–∏—á–µ—Å—Ç–≤–æ |
|:---------------:|:---------------:|
| –í–ª–∞–¥–∏–≤–æ—Å—Ç–æ–∫     | 2          |
| –ú–æ—Å–∫–≤–∞          | 1          |
| –°–∞–Ω–∫—Ç-–ü–µ—Ç–µ—Ä–±—É—Ä–≥ | 1          |

---

‚ú≥ –®–∞–≥ 8. 

‚ùì*–ó–∞–¥–∞–Ω–∏–µ. –í—ã–≤–µ—Å—Ç–∏ –Ω–æ–º–µ—Ä–∞ –≤—Å–µ—Ö –æ–ø–ª–∞—á–µ–Ω–Ω—ã—Ö –∑–∞–∫–∞–∑–æ–≤ –∏ –¥–∞—Ç—ã, –∫–æ–≥–¥–∞ –æ–Ω–∏ –±—ã–ª–∏ –æ–ø–ª–∞—á–µ–Ω—ã.* 

*–§—Ä–∞–≥–º–µ–Ω—Ç –ª–æ–≥–∏—á–µ—Å–∫–æ–π —Å—Ö–µ–º—ã –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö:*

![](https://ucarecdn.com/a6be5406-fcef-4a74-89bc-eb7833621092/)

‚úî`–†–ï–®–ï–ù–ò–ï` ‚§µÔ∏è

```sql
SELECT 
  buy_id, 
  date_step_end 
FROM 
  step 
  INNER JOIN buy_step ON step.step_id = buy_step.step_id 
WHERE 
  date_step_end IS NOT NULL 
  AND buy_step.step_id = 1;
```

üîé `–†–ï–ó–£–õ–¨–¢–ê–¢` ‚§µÔ∏è

| buy_id | date_step_end |
|:---------------:|:---------------:|
| 1      | 2020-02-20    |
| 2      | 2020-02-28    |
| 3      | 2020-03-05    |

---

‚ú≥ –®–∞–≥ 9. 

‚ùì*–ó–∞–¥–∞–Ω–∏–µ. –í—ã–≤–µ—Å—Ç–∏ –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é –æ –∫–∞–∂–¥–æ–º –∑–∞–∫–∞–∑–µ: –µ–≥–æ –Ω–æ–º–µ—Ä, –∫—Ç–æ –µ–≥–æ —Å—Ñ–æ—Ä–º–∏—Ä–æ–≤–∞–ª (—Ñ–∞–º–∏–ª–∏—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è) –∏ –µ–≥–æ —Å—Ç–æ–∏–º–æ—Å—Ç—å (—Å—É–º–º–∞ –ø—Ä–æ–∏–∑–≤–µ–¥–µ–Ω–∏–π –∫–æ–ª–∏—á–µ—Å—Ç–≤–∞ –∑–∞–∫–∞–∑–∞–Ω–Ω—ã—Ö –∫–Ω–∏–≥ –∏ –∏—Ö —Ü–µ–Ω—ã), –≤ –æ—Ç—Å–æ—Ä—Ç–∏—Ä–æ–≤–∞–Ω–Ω–æ–º –ø–æ –Ω–æ–º–µ—Ä—É –∑–∞–∫–∞–∑–∞ –≤–∏–¥–µ. –ü–æ—Å–ª–µ–¥–Ω–∏–π —Å—Ç–æ–ª–±–µ—Ü –Ω–∞–∑–≤–∞—Ç—å –°—Ç–æ–∏–º–æ—Å—Ç—å.* 

*–§—Ä–∞–≥–º–µ–Ω—Ç –ª–æ–≥–∏—á–µ—Å–∫–æ–π —Å—Ö–µ–º—ã –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö:*

![](https://ucarecdn.com/cce071e8-3a35-4642-8fff-460f0899e4eb/)

‚úî`–†–ï–®–ï–ù–ò–ï` ‚§µÔ∏è

```sql
SELECT 
  buy.buy_id, 
  name_client, 
  SUM(buy_book.amount * book.price) AS –°—Ç–æ–∏–º–æ—Å—Ç—å 
FROM 
  buy_book 
  INNER JOIN book ON book.book_id = buy_book.book_id 
  INNER JOIN buy ON buy.buy_id = buy_book.buy_id 
  INNER JOIN client ON client.client_id = buy.client_id 
GROUP BY 
  buy_id 
ORDER BY 
  buy_id;
```

üîé `–†–ï–ó–£–õ–¨–¢–ê–¢` ‚§µÔ∏è

| buy_id | name_client    | –°—Ç–æ–∏–º–æ—Å—Ç—å |
|:---------------:|:---------------:|:---------------:|
| 1      | –ë–∞—Ä–∞–Ω–æ–≤ –ü–∞–≤–µ–ª  | 2271.39   |
| 2      | –°–µ–º–µ–Ω–æ–Ω–æ–≤ –ò–≤–∞–Ω | 1037.98   |
| 3      | –ê–±—Ä–∞–º–æ–≤–∞ –ö–∞—Ç—è  | 2131.49   |
| 4      | –ë–∞—Ä–∞–Ω–æ–≤ –ü–∞–≤–µ–ª  | 480.50    |

---

‚ú≥ –®–∞–≥ 10. 

‚ùì*–ó–∞–¥–∞–Ω–∏–µ. –í—ã–≤–µ—Å—Ç–∏ –Ω–æ–º–µ—Ä–∞ –∑–∞–∫–∞–∑–æ–≤ (buy_id) –∏ –Ω–∞–∑–≤–∞–Ω–∏—è —ç—Ç–∞–ø–æ–≤,  –Ω–∞ –∫–æ—Ç–æ—Ä—ã—Ö –æ–Ω–∏ –≤ –¥–∞–Ω–Ω—ã–π –º–æ–º–µ–Ω—Ç –Ω–∞—Ö–æ–¥—è—Ç—Å—è. –ï—Å–ª–∏ –∑–∞–∫–∞–∑ –¥–æ—Å—Ç–∞–≤–ª–µ–Ω ‚Äì  –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é –æ –Ω–µ–º –Ω–µ –≤—ã–≤–æ–¥–∏—Ç—å. –ò–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é –æ—Ç—Å–æ—Ä—Ç–∏—Ä–æ–≤–∞—Ç—å –ø–æ –≤–æ–∑—Ä–∞—Å—Ç–∞–Ω–∏—é buy_id.* 

*–§—Ä–∞–≥–º–µ–Ω—Ç –ª–æ–≥–∏—á–µ—Å–∫–æ–π —Å—Ö–µ–º—ã –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö:*

![](https://ucarecdn.com/0178ea29-ab37-4ce9-83ac-bd49d2636c20/)

‚úî`–†–ï–®–ï–ù–ò–ï` ‚§µÔ∏è

```sql
SELECT 
  buy_id, 
  name_step 
FROM 
  buy_step 
  INNER JOIN step ON buy_step.step_id = step.step_id 
WHERE 
  date_step_beg IS NOT NULL 
  AND date_step_end IS NULL 
ORDER BY 
  buy_id, 
  name_step;
```

üîé `–†–ï–ó–£–õ–¨–¢–ê–¢` ‚§µÔ∏è

| buy_id | name_step       |
|:---------------:|:---------------:|
| 2      | –¢—Ä–∞–Ω—Å–ø–æ—Ä—Ç–∏—Ä–æ–≤–∫–∞ |
| 3      | –î–æ—Å—Ç–∞–≤–∫–∞        |
| 4      | –û–ø–ª–∞—Ç–∞          |

---

‚ú≥ –®–∞–≥ 11. 

‚ùì*–ó–∞–¥–∞–Ω–∏–µ. –í —Ç–∞–±–ª–∏—Ü–µ city –¥–ª—è –∫–∞–∂–¥–æ–≥–æ –≥–æ—Ä–æ–¥–∞ —É–∫–∞–∑–∞–Ω–æ –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –¥–Ω–µ–π, –∑–∞ –∫–æ—Ç–æ—Ä—ã–µ –∑–∞–∫–∞–∑ –º–æ–∂–µ—Ç –±—ã—Ç—å –¥–æ—Å—Ç–∞–≤–ª–µ–Ω –≤ —ç—Ç–æ—Ç –≥–æ—Ä–æ–¥ (—Ä–∞—Å—Å–º–∞—Ç—Ä–∏–≤–∞–µ—Ç—Å—è —Ç–æ–ª—å–∫–æ —ç—Ç–∞–ø –¢—Ä–∞–Ω—Å–ø–æ—Ä—Ç–∏—Ä–æ–≤–∫–∞). –î–ª—è —Ç–µ—Ö –∑–∞–∫–∞–∑–æ–≤, –∫–æ—Ç–æ—Ä—ã–µ –ø—Ä–æ—à–ª–∏ —ç—Ç–∞–ø —Ç—Ä–∞–Ω—Å–ø–æ—Ä—Ç–∏—Ä–æ–≤–∫–∏, –≤—ã–≤–µ—Å—Ç–∏ –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –¥–Ω–µ–π –∑–∞ –∫–æ—Ç–æ—Ä–æ–µ –∑–∞–∫–∞–∑ —Ä–µ–∞–ª—å–Ω–æ –¥–æ—Å—Ç–∞–≤–ª–µ–Ω –≤ –≥–æ—Ä–æ–¥. –ê —Ç–∞–∫–∂–µ, –µ—Å–ª–∏ –∑–∞–∫–∞–∑ –¥–æ—Å—Ç–∞–≤–ª–µ–Ω —Å –æ–ø–æ–∑–¥–∞–Ω–∏–µ–º, —É–∫–∞–∑–∞—Ç—å –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –¥–Ω–µ–π –∑–∞–¥–µ—Ä–∂–∫–∏, –≤ –ø—Ä–æ—Ç–∏–≤–Ω–æ–º —Å–ª—É—á–∞–µ –≤—ã–≤–µ—Å—Ç–∏ 0. –í —Ä–µ–∑—É–ª—å—Ç–∞—Ç –≤–∫–ª—é—á–∏—Ç—å –Ω–æ–º–µ—Ä –∑–∞–∫–∞–∑–∞ (buy_id), –∞ —Ç–∞–∫–∂–µ –≤—ã—á–∏—Å–ª—è–µ–º—ã–µ —Å—Ç–æ–ª–±—Ü—ã –ö–æ–ª–∏—á–µ—Å—Ç–≤–æ_–¥–Ω–µ–π –∏ –û–ø–æ–∑–¥–∞–Ω–∏–µ. –ò–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é –≤—ã–≤–µ—Å—Ç–∏ –≤ –æ—Ç—Å–æ—Ä—Ç–∏—Ä–æ–≤–∞–Ω–Ω–æ–º –ø–æ –Ω–æ–º–µ—Ä—É –∑–∞–∫–∞–∑–∞ –≤–∏–¥–µ.* 

*–§—Ä–∞–≥–º–µ–Ω—Ç –ª–æ–≥–∏—á–µ—Å–∫–æ–π —Å—Ö–µ–º—ã –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö:*

![](https://ucarecdn.com/6b3c2d87-7353-48e6-adfd-26c338886f4a/)

‚úî`–†–ï–®–ï–ù–ò–ï` ‚§µÔ∏è

```sql
SELECT 
  buy_step.buy_id, 
  DATEDIFF(date_step_end, date_step_beg) AS –ö–æ–ª–∏—á–µ—Å—Ç–≤–æ_–¥–Ω–µ–π, 
  IF(
    DATEDIFF(date_step_end, date_step_beg) > city.days_delivery, 
    DATEDIFF(date_step_end, date_step_beg) - city.days_delivery, 
    0
  ) AS –û–ø–æ–∑–¥–∞–Ω–∏–µ 
FROM 
  buy_step 
  INNER JOIN step ON buy_step.step_id = step.step_id 
  INNER JOIN buy ON buy_step.buy_id = buy.buy_id 
  INNER JOIN client ON buy.client_id = client.client_id 
  INNER JOIN city ON client.city_id = city.city_id 
WHERE 
  buy_step.step_id = 3 
  AND date_step_end IS NOT NULL 
ORDER BY 
  buy_id;
```

üîé `–†–ï–ó–£–õ–¨–¢–ê–¢` ‚§µÔ∏è

| buy_id | –ö–æ–ª–∏—á–µ—Å—Ç–≤–æ_–¥–Ω–µ–π | –û–ø–æ–∑–¥–∞–Ω–∏–µ |
|:---------------:|:---------------:|:---------------:|
| 1      | 14              | 2         |
| 3      | 4               | 0         |

---

‚ú≥ –®–∞–≥ 12. 

‚ùì*–ó–∞–¥–∞–Ω–∏–µ. –í—ã–±—Ä–∞—Ç—å –≤—Å–µ—Ö –∫–ª–∏–µ–Ω—Ç–æ–≤, –∫–æ—Ç–æ—Ä—ã–µ –∑–∞–∫–∞–∑—ã–≤–∞–ª–∏ –∫–Ω–∏–≥–∏ –î–æ—Å—Ç–æ–µ–≤—Å–∫–æ–≥–æ, –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é –≤—ã–≤–µ—Å—Ç–∏ –≤ –æ—Ç—Å–æ—Ä—Ç–∏—Ä–æ–≤–∞–Ω–Ω–æ–º –ø–æ –∞–ª—Ñ–∞–≤–∏—Ç—É –≤–∏–¥–µ. –í —Ä–µ—à–µ–Ω–∏–∏ –∏—Å–ø–æ–ª—å–∑—É–π—Ç–µ —Ñ–∞–º–∏–ª–∏—é –∞–≤—Ç–æ—Ä–∞, –∞ –Ω–µ –µ–≥–æ id.* 

*–§—Ä–∞–≥–º–µ–Ω—Ç –ª–æ–≥–∏—á–µ—Å–∫–æ–π —Å—Ö–µ–º—ã –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö:*

![](https://ucarecdn.com/81b4c54e-bfb0-4582-9df9-279b6be0154e/)

‚úî`–†–ï–®–ï–ù–ò–ï` ‚§µÔ∏è

```sql
SELECT 
  DISTINCT name_client 
FROM 
  client 
  INNER JOIN buy USING(client_id) 
  INNER JOIN buy_book USING(buy_id) 
  INNER JOIN book USING(book_id) 
  INNER JOIN author USING(author_id) 
WHERE 
  author.name_author = '–î–æ—Å—Ç–æ–µ–≤—Å–∫–∏–π –§.–ú.' 
ORDER BY 
  name_client;
```

üîé `–†–ï–ó–£–õ–¨–¢–ê–¢` ‚§µÔ∏è

| name_client   |
|:---------------:|
| –ê–±—Ä–∞–º–æ–≤–∞ –ö–∞—Ç—è |
| –ë–∞—Ä–∞–Ω–æ–≤ –ü–∞–≤–µ–ª |

---

‚ú≥ –®–∞–≥ 13. 

‚ùì*–ó–∞–¥–∞–Ω–∏–µ. –í—ã–≤–µ—Å—Ç–∏ –∂–∞–Ω—Ä (–∏–ª–∏ –∂–∞–Ω—Ä—ã), –≤ –∫–æ—Ç–æ—Ä–æ–º –±—ã–ª–æ –∑–∞–∫–∞–∑–∞–Ω–æ –±–æ–ª—å—à–µ –≤—Å–µ–≥–æ —ç–∫–∑–µ–º–ø–ª—è—Ä–æ–≤ –∫–Ω–∏–≥, —É–∫–∞–∑–∞—Ç—å —ç—Ç–æ –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ. –ü–æ—Å–ª–µ–¥–Ω–∏–π —Å—Ç–æ–ª–±–µ—Ü –Ω–∞–∑–≤–∞—Ç—å –ö–æ–ª–∏—á–µ—Å—Ç–≤–æ.* 

*–§—Ä–∞–≥–º–µ–Ω—Ç –ª–æ–≥–∏—á–µ—Å–∫–æ–π —Å—Ö–µ–º—ã –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö:*

![](https://ucarecdn.com/710494ce-e3a3-4d4b-8f10-5ab41b474b31/)

‚úî`–†–ï–®–ï–ù–ò–ï` ‚§µÔ∏è

```sql
SELECT 
  name_genre, 
  SUM(buy_book.amount) AS –ö–æ–ª–∏—á–µ—Å—Ç–≤–æ 
FROM 
  genre 
  INNER JOIN book USING(genre_id) 
  INNER JOIN buy_book USING(book_id) 
GROUP BY 
  1 
HAVING 
  –ö–æ–ª–∏—á–µ—Å—Ç–≤–æ = (
    SELECT 
      MAX(sum_amount) AS max_sum_amount 
    FROM 
      (
        SELECT 
          name_genre, 
          SUM(buy_book.amount) AS sum_amount 
        FROM 
          genre 
          INNER JOIN book ON genre.genre_id = book.genre_id 
          INNER JOIN buy_book ON book.book_id = buy_book.book_id 
        GROUP BY 
          name_genre
      ) AS query_in
  );
```

üîé `–†–ï–ó–£–õ–¨–¢–ê–¢` ‚§µÔ∏è

| name_genre | –ö–æ–ª–∏—á–µ—Å—Ç–≤–æ |
|:---------------:|:---------------:|
| –†–æ–º–∞–Ω      | 7          |

---

‚ú≥ –®–∞–≥ 14. 

‚ùì*–ó–∞–¥–∞–Ω–∏–µ. –°—Ä–∞–≤–Ω–∏—Ç—å –µ–∂–µ–º–µ—Å—è—á–Ω—É—é –≤—ã—Ä—É—á–∫—É –æ—Ç –ø—Ä–æ–¥–∞–∂–∏ –∫–Ω–∏–≥ –∑–∞ —Ç–µ–∫—É—â–∏–π –∏ –ø—Ä–µ–¥—ã–¥—É—â–∏–π –≥–æ–¥—ã. –î–ª—è —ç—Ç–æ–≥–æ –≤—ã–≤–µ—Å—Ç–∏ –≥–æ–¥, –º–µ—Å—è—Ü, —Å—É–º–º—É –≤—ã—Ä—É—á–∫–∏ –≤ –æ—Ç—Å–æ—Ä—Ç–∏—Ä–æ–≤–∞–Ω–Ω–æ–º —Å–Ω–∞—á–∞–ª–∞ –ø–æ –≤–æ–∑—Ä–∞—Å—Ç–∞–Ω–∏—é –º–µ—Å—è—Ü–µ–≤, –∑–∞—Ç–µ–º –ø–æ –≤–æ–∑—Ä–∞—Å—Ç–∞–Ω–∏—é –ª–µ—Ç –≤–∏–¥–µ. –ù–∞–∑–≤–∞–Ω–∏–µ —Å—Ç–æ–ª–±—Ü–æ–≤: –ì–æ–¥, –ú–µ—Å—è—Ü, –°—É–º–º–∞.* 

*–§—Ä–∞–≥–º–µ–Ω—Ç –ª–æ–≥–∏—á–µ—Å–∫–æ–π —Å—Ö–µ–º—ã –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö (–≤ –∑–∞–ø—Ä–æ—Å–µ –ù–ï –û–ë–Ø–ó–ê–¢–ï–õ–¨–ù–û –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –≤—Å–µ —Ç–∞–±–ª–∏—Ü—ã):*

![](https://ucarecdn.com/843369b4-8065-4023-99bf-60a08aaafa34/)

*–ò–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è –æ –ø—Ä–æ–¥–∞–∂–∞—Ö –ø—Ä–µ–¥—ã–¥—É—â–µ–≥–æ –≥–æ–¥–∞ —Ö—Ä–∞–Ω–∏—Ç—Å—è –≤ –∞—Ä—Ö–∏–≤–Ω–æ–π —Ç–∞–±–ª–∏—Ü–µ buy_archive, –∫–æ—Ç–æ—Ä–∞—è —Å–æ–∑–¥–∞–µ—Ç—Å—è –≤ –∫–æ–Ω—Ü–µ –≥–æ–¥–∞ –Ω–∞ –æ—Å–Ω–æ–≤–µ –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–∏ –∏–∑ —Ç–∞–±–ª–∏—Ü –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö –∏ –∏–º–µ–µ—Ç —Å–ª–µ–¥—É—é—â—É—é —Å—Ç—Ä—É–∫—Ç—É—Ä—É:*

|–ù–∞–∑–≤–∞–Ω–∏–µ —Å—Ç–æ–ª–±—Ü–∞	|–û–ø–∏—Å–∞–Ω–∏–µ|
|buy_archive_id		|–∫–ª—é—á–µ–≤–æ–π —Å—Ç–æ–ª–±–µ—Ü|
|buy_id	id		|–∑–∞–∫–∞–∑–æ–≤, –≤—ã–±–∏—Ä–∞–µ—Ç—Å—è –∏–∑ —Ç–∞–±–ª–∏—Ü—ã buy|
|client_id		|id –∫–ª–∏–µ–Ω—Ç–æ–≤, –≤—ã–±–∏—Ä–∞–µ—Ç—Å—è –∏–∑ –∏–∑ —Ç–∞–±–ª–∏—Ü—ã client|
|book_id		|id –∫–Ω–∏–≥–∏, –≤—ã–±–∏—Ä–∞–µ—Ç—Å—è –∏–∑ —Ç–∞–±–ª–∏—Ü—ã book|
|date_payment		|–¥–∞—Ç–∞ –æ–ø–ª–∞—Ç—ã –∑–∞–∫–∞–∑–∞, –≤—ã–±–∏—Ä–∞–µ—Ç—Å—è –∏–∑ —Å—Ç–æ–ª–±—Ü–∞ date_step_end|
|—Ç–∞–±–ª–∏—Ü—ã buy_step 	|—ç—Ç–∞–ø–∞ ¬´–û–ø–ª–∞—Ç–∞¬ª —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤—É—é—â–µ–≥–æ –∑–∞–∫–∞–∑–∞|
|price			|—Ü–µ–Ω–∞ –∫–Ω–∏–≥–∏ –≤ —Ç–µ–∫—É—â–µ–º –∑–∞–∫–∞–∑–µ –∏–∑ —Ç–∞–±–ª–∏—Ü—ã book (—Ö—Ä–∞–Ω–∏—Ç—Å—è, —Ç–∞–∫ –∫–∞–∫ —Ü–µ–Ω–∞ –º–æ–∂–µ—Ç –∏–∑–º–µ–Ω–∏—Ç—å—Å—è)|
|amount			|–∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –∫—É–ø–ª–µ–Ω–Ω—ã—Ö –∫–Ω–∏–≥ –≤ —Ç–µ–∫—É—â–µ–º –∑–∞–∫–∞–∑–µ, –∏–∑ —Ç–∞–±–ª–∏—Ü—ã buy_book|

‚úî`–†–ï–®–ï–ù–ò–ï` ‚§µÔ∏è

```sql
SELECT 
  YEAR(date_payment) AS –ì–æ–¥, 
  MONTHNAME(date_payment) AS –ú–µ—Å—è—Ü, 
  SUM(price * amount) AS –°—É–º–º–∞ 
FROM 
  buy_archive 
GROUP BY 
  1, 
  2 
UNION ALL 
SELECT 
  YEAR(date_step_end) AS –ì–æ–¥, 
  MONTHNAME(date_step_end) AS –ú–µ—Å—è—Ü, 
  SUM(price * buy_book.amount) AS –°—É–º–º–∞ 
FROM 
  buy_step 
  INNER JOIN buy_book USING(buy_id) 
  INNER JOIN book USING(book_id) 
WHERE 
  date_step_end IS NOT NULL 
  AND step_id = 1 
GROUP BY 
  1, 
  2 
ORDER BY 
  2 ASC, 
  1 ASC;
```

üîé `–†–ï–ó–£–õ–¨–¢–ê–¢` ‚§µÔ∏è

| –ì–æ–¥  | –ú–µ—Å—è—Ü    | –°—É–º–º–∞   |
|:---------------:|:---------------:|:---------------:|
| 2019 | February | 5626.30 |
| 2020 | February | 3309.37 |
| 2019 | March    | 6857.50 |
| 2020 | March    | 2131.49 |

---

‚ú≥ –®–∞–≥ 15. 

‚ùì*–ó–∞–¥–∞–Ω–∏–µ. –î–ª—è –∫–∞–∂–¥–æ–π –æ—Ç–¥–µ–ª—å–Ω–æ–π –∫–Ω–∏–≥–∏ –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ –≤—ã–≤–µ—Å—Ç–∏ –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é –æ –∫–æ–ª–∏—á–µ—Å—Ç–≤–µ –ø—Ä–æ–¥–∞–Ω–Ω—ã—Ö —ç–∫–∑–µ–º–ø–ª—è—Ä–æ–≤ –∏ –∏—Ö —Å—Ç–æ–∏–º–æ—Å—Ç–∏ –∑–∞ 2020 –∏ 2019 –≥–æ–¥ . –í—ã—á–∏—Å–ª—è–µ–º—ã–µ —Å—Ç–æ–ª–±—Ü—ã –Ω–∞–∑–≤–∞—Ç—å –ö–æ–ª–∏—á–µ—Å—Ç–≤–æ –∏ –°—É–º–º–∞. –ò–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é –æ—Ç—Å–æ—Ä—Ç–∏—Ä–æ–≤–∞—Ç—å –ø–æ —É–±—ã–≤–∞–Ω–∏—é —Å—Ç–æ–∏–º–æ—Å—Ç–∏.* 

*–§—Ä–∞–≥–º–µ–Ω—Ç –ª–æ–≥–∏—á–µ—Å–∫–æ–π —Å—Ö–µ–º—ã –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö:*

![](https://ucarecdn.com/d5c5d16e-32eb-4caa-8fc8-6982cda2ac32/)

*–ò–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è –æ –ø—Ä–æ–¥–∞–∂–∞—Ö –ø—Ä–æ—à–ª–æ–≥–æ –≥–æ–¥–∞ —Ö—Ä–∞–Ω–∏—Ç—Å—è –≤ —Ç–∞–±–ª–∏—Ü–µ buy_archive —Å–ª–µ–¥—É—é—â–µ–π —Å—Ç—Ä—É–∫—Ç—É—Ä—ã:*

![](https://ucarecdn.com/bd089cc7-acb0-442e-a276-4995f7ade4b1/)

‚úî`–†–ï–®–ï–ù–ò–ï` ‚§µÔ∏è

```sql
SELECT 
  title, 
  SUM(–ö–æ–ª–∏—á–µ—Å—Ç–≤–æ) AS –ö–æ–ª–∏—á–µ—Å—Ç–≤–æ, 
  SUM(–°—É–º–º–∞) AS –°—É–º–º–∞ 
FROM 
  (
    SELECT 
      book.title, 
      SUM(buy_book.amount) AS –ö–æ–ª–∏—á–µ—Å—Ç–≤–æ, 
      SUM(book.price * buy_book.amount) AS –°—É–º–º–∞ 
    FROM 
      book 
      INNER JOIN buy_book USING(book_id) 
      INNER JOIN buy ON buy_book.buy_id = buy.buy_id 
      INNER JOIN buy_step ON buy_step.buy_id = buy.buy_id 
      INNER JOIN step ON buy_step.step_id = step.step_id 
    WHERE 
      step.name_step = '–û–ø–ª–∞—Ç–∞' 
      AND buy_step.date_step_end IS NOT NULL 
    GROUP BY 
      1 
    UNION ALL 
    SELECT 
      book.title, 
      SUM(buy_archive.amount) AS –ö–æ–ª–∏—á–µ—Å—Ç–≤–æ, 
      SUM(
        buy_archive.price * buy_archive.amount
      ) AS –°—É–º–º–∞ 
    FROM 
      buy_archive 
      INNER JOIN book USING(book_id) 
    GROUP BY 
      1
  ) AS query_in 
GROUP BY 
  title 
ORDER BY 
  –°—É–º–º–∞ DESC;
```

üîé `–†–ï–ó–£–õ–¨–¢–ê–¢` ‚§µÔ∏è

| title                 | –ö–æ–ª–∏—á–µ—Å—Ç–≤–æ | –°—É–º–º–∞   |
|:---------------:|:---------------:|:---------------:|
| –ë—Ä–∞—Ç—å—è –ö–∞—Ä–∞–º–∞–∑–æ–≤—ã     | 8          | 6247.20 |
| –ú–∞—Å—Ç–µ—Ä –∏ –ú–∞—Ä–≥–∞—Ä–∏—Ç–∞    | 6          | 4024.38 |
| –ò–¥–∏–æ—Ç                 | 5          | 2281.80 |
| –ë–µ–ª–∞—è –≥–≤–∞—Ä–¥–∏—è         | 3          | 1581.10 |
| –ß–µ—Ä–Ω—ã–π —á–µ–ª–æ–≤–µ–∫        | 2          | 1140.40 |
| –õ–∏—Ä–∏–∫–∞                | 2          | 1037.98 |
| –ò–≥—Ä–æ–∫                 | 2          | 961.80  |
| –°—Ç–∏—Ö–æ—Ç–≤–æ—Ä–µ–Ω–∏—è –∏ –ø–æ—ç–º—ã | 1          | 650.00  |

---

## 2.5 –ë–∞–∑–∞ –¥–∞–Ω–Ω—ã—Ö ¬´–ò–Ω—Ç–µ—Ä–Ω–µ—Ç-–º–∞–≥–∞–∑–∏–Ω –∫–Ω–∏–≥¬ª, –∑–∞–ø—Ä–æ—Å—ã –∫–æ—Ä—Ä–µ–∫—Ç–∏—Ä–æ–≤–∫–∏

‚ú≥ –®–∞–≥ 2. 

‚ùì*–ó–∞–¥–∞–Ω–∏–µ. –í–∫–ª—é—á–∏—Ç—å –Ω–æ–≤–æ–≥–æ —á–µ–ª–æ–≤–µ–∫–∞ –≤ —Ç–∞–±–ª–∏—Ü—É —Å –∫–ª–∏–µ–Ω—Ç–∞–º–∏. –ï–≥–æ –∏–º—è –ü–æ–ø–æ–≤ –ò–ª—å—è, –µ–≥–æ email popov@test, –ø—Ä–æ–∂–∏–≤–∞–µ—Ç –æ–Ω –≤ –ú–æ—Å–∫–≤–µ.* 

*–§—Ä–∞–≥–º–µ–Ω—Ç –ª–æ–≥–∏—á–µ—Å–∫–æ–π —Å—Ö–µ–º—ã –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö:*

![](https://ucarecdn.com/2d95c7c4-3164-4d35-b195-6dea9308e5ae/)

‚úî`–†–ï–®–ï–ù–ò–ï` ‚§µÔ∏è

```sql
INSERT INTO client (name_client, city_id, email) 
SELECT 
  '–ü–æ–ø–æ–≤ –ò–ª—å—è', 
  city_id, 
  'popov@test' 
FROM 
  city 
WHERE 
  name_city = '–ú–æ—Å–∫–≤–∞';
SELECT 
  * 
FROM 
  client;
```

üîé `–†–ï–ó–£–õ–¨–¢–ê–¢` ‚§µÔ∏è

| client_id | name_client     | city_id | email          |
|:---------------:|:---------------:|:---------------:|:---------------:|
| 1         | –ë–∞—Ä–∞–Ω–æ–≤ –ü–∞–≤–µ–ª   | 3       | baranov@test   |
| 2         | –ê–±—Ä–∞–º–æ–≤–∞ –ö–∞—Ç—è   | 1       | abramova@test  |
| 3         | –°–µ–º–µ–Ω–æ–Ω–æ–≤ –ò–≤–∞–Ω  | 2       | semenov@test   |
| 4         | –Ø–∫–æ–≤–ª–µ–≤–∞ –ì–∞–ª–∏–Ω–∞ | 1       | yakovleva@test |
| 5         | –ü–æ–ø–æ–≤ –ò–ª—å—è      | 1       | popov@test     |

---

‚ú≥ –®–∞–≥ 3. 

‚ùì*–ó–∞–¥–∞–Ω–∏–µ. –°–æ–∑–¥–∞—Ç—å –Ω–æ–≤—ã–π –∑–∞–∫–∞–∑ –¥–ª—è –ü–æ–ø–æ–≤–∞ –ò–ª—å–∏. –ï–≥–æ –∫–æ–º–º–µ–Ω—Ç–∞—Ä–∏–π –¥–ª—è –∑–∞–∫–∞–∑–∞: ¬´–°–≤—è–∑–∞—Ç—å—Å—è —Å–æ –º–Ω–æ–π –ø–æ –≤–æ–ø—Ä–æ—Å—É –¥–æ—Å—Ç–∞–≤–∫–∏¬ª.* 

*–§—Ä–∞–≥–º–µ–Ω—Ç –ª–æ–≥–∏—á–µ—Å–∫–æ–π —Å—Ö–µ–º—ã –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö:*

![](https://ucarecdn.com/410c7a2e-696d-4865-b9b6-a176350d5cbd/)

‚úî`–†–ï–®–ï–ù–ò–ï` ‚§µÔ∏è

```sql
INSERT INTO buy(buy_description, client_id) 
SELECT 
  '–°–≤—è–∑–∞—Ç—å—Å—è —Å–æ –º–Ω–æ–π –ø–æ –≤–æ–ø—Ä–æ—Å—É –¥–æ—Å—Ç–∞–≤–∫–∏', 
  client_id 
FROM 
  client 
WHERE 
  name_client = '–ü–æ–ø–æ–≤ –ò–ª—å—è';
SELECT 
  * 
FROM 
  buy;
```

üîé `–†–ï–ó–£–õ–¨–¢–ê–¢` ‚§µÔ∏è

| buy_id | buy_description                       | client_id |
|:---------------:|:---------------:|:---------------:|
| 1      | –î–æ—Å—Ç–∞–≤–∫–∞ —Ç–æ–ª—å–∫–æ –≤–µ—á–µ—Ä–æ–º               | 1         |
| 2      | NULL                                  | 3         |
| 3      | –£–ø–∞–∫–æ–≤–∞—Ç—å –∫–∞–∂–¥—É—é –∫–Ω–∏–≥—É –ø–æ –æ—Ç–¥–µ–ª—å–Ω–æ—Å—Ç–∏ | 2         |
| 4      | NULL                                  | 1         |
| 5      | –°–≤—è–∑–∞—Ç—å—Å—è —Å–æ –º–Ω–æ–π –ø–æ –≤–æ–ø—Ä–æ—Å—É –¥–æ—Å—Ç–∞–≤–∫–∏ | 5         |

---

‚ú≥ –®–∞–≥ 4. 

‚ùì*–ó–∞–¥–∞–Ω–∏–µ. –í —Ç–∞–±–ª–∏—Ü—É buy_book –¥–æ–±–∞–≤–∏—Ç—å –∑–∞–∫–∞–∑ —Å –Ω–æ–º–µ—Ä–æ–º 5. –≠—Ç–æ—Ç –∑–∞–∫–∞–∑ –¥–æ–ª–∂–µ–Ω —Å–æ–¥–µ—Ä–∂–∞—Ç—å –∫–Ω–∏–≥—É –ü–∞—Å—Ç–µ—Ä–Ω–∞–∫–∞ ¬´–õ–∏—Ä–∏–∫–∞¬ª –≤ –∫–æ–ª–∏—á–µ—Å—Ç–≤–µ –¥–≤—É—Ö —ç–∫–∑–µ–º–ø–ª—è—Ä–æ–≤ –∏ –∫–Ω–∏–≥—É –ë—É–ª–≥–∞–∫–æ–≤–∞ ¬´–ë–µ–ª–∞—è –≥–≤–∞—Ä–¥–∏—è¬ª –≤ –æ–¥–Ω–æ–º —ç–∫–∑–µ–º–ø–ª—è—Ä–µ.* 

*–§—Ä–∞–≥–º–µ–Ω—Ç –ª–æ–≥–∏—á–µ—Å–∫–æ–π —Å—Ö–µ–º—ã –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö:*

![](https://ucarecdn.com/b6bd319d-0d03-4b9a-86a2-98ac762fa4dc/)

‚úî`–†–ï–®–ï–ù–ò–ï` ‚§µÔ∏è

```sql
INSERT INTO buy_book(buy_id, book_id, amount) 
SELECT 
  5, 
  book_id, 
  2 
FROM 
  book 
  INNER JOIN author USING(author_id) 
WHERE 
  author.name_author LIKE '–ü–∞—Å—Ç–µ—Ä–Ω–∞–∫%' 
  AND book.title LIKE '–õ–∏—Ä–∏–∫–∞%' 
UNION 
SELECT 
  5, 
  book_id, 
  1 
FROM 
  book 
  INNER JOIN author USING(author_id) 
WHERE 
  author.name_author LIKE '–ë—É–ª–≥–∞–∫–æ–≤%' 
  AND book.title LIKE '–ë–µ–ª–∞—è –≥–≤–∞—Ä–¥–∏—è%';
SELECT 
  * 
FROM 
  buy_book;
```

üîé `–†–ï–ó–£–õ–¨–¢–ê–¢` ‚§µÔ∏è

| buy_book_id | buy_id | book_id | amount |
|:---------------:|:---------------:|:---------------:|:---------------:|
| 1           | 1      | 1       | 1      |
| 2           | 1      | 7       | 2      |
| 3           | 1      | 3       | 1      |
| 4           | 2      | 8       | 2      |
| 5           | 3      | 3       | 2      |
| 6           | 3      | 2       | 1      |
| 7           | 3      | 1       | 1      |
| 8           | 4      | 5       | 1      |
| 9           | 5      | 8       | 2      |
| 10          | 5      | 2       | 1      |

---

‚ú≥ –®–∞–≥ 5. 

‚ùì*–ó–∞–¥–∞–Ω–∏–µ. –ö–æ–ª–∏—á–µ—Å—Ç–≤–æ —Ç–µ—Ö –∫–Ω–∏–≥ –Ω–∞ —Å–∫–ª–∞–¥–µ, –∫–æ—Ç–æ—Ä—ã–µ –±—ã–ª–∏ –≤–∫–ª—é—á–µ–Ω—ã –≤ –∑–∞–∫–∞–∑ —Å –Ω–æ–º–µ—Ä–æ–º 5, —É–º–µ–Ω—å—à–∏—Ç—å –Ω–∞ —Ç–æ –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ, –∫–æ—Ç–æ—Ä–æ–µ –≤ –∑–∞–∫–∞–∑–µ —Å –Ω–æ–º–µ—Ä–æ–º 5  —É–∫–∞–∑–∞–Ω–æ.* 

*–§—Ä–∞–≥–º–µ–Ω—Ç –ª–æ–≥–∏—á–µ—Å–∫–æ–π —Å—Ö–µ–º—ã –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö:*

![](https://ucarecdn.com/96d439bc-b2d4-4850-9762-ade76851aa9e/)

‚úî`–†–ï–®–ï–ù–ò–ï` ‚§µÔ∏è

```sql
UPDATE 
  book 
  INNER JOIN buy_book USING(book_id) 
SET 
  book.amount = book.amount - buy_book.amount 
WHERE 
  buy_book.buy_id = 5 
  AND book.book_id = buy_book.book_id;
SELECT 
  * 
FROM 
  book;
```

üîé `–†–ï–ó–£–õ–¨–¢–ê–¢` ‚§µÔ∏è

| book_id | title                 | author_id | genre_id | price  | amount |
|:---------------:|:---------------:|:---------------:|:---------------:|:---------------:|:---------------:|
| 1       | –ú–∞—Å—Ç–µ—Ä –∏ –ú–∞—Ä–≥–∞—Ä–∏—Ç–∞    | 1         | 1        | 670.99 | 3      |
| 2       | –ë–µ–ª–∞—è –≥–≤–∞—Ä–¥–∏—è         | 1         | 1        | 540.50 | 4      |
| 3       | –ò–¥–∏–æ—Ç                 | 2         | 1        | 460.00 | 10     |
| 4       | –ë—Ä–∞—Ç—å—è –ö–∞—Ä–∞–º–∞–∑–æ–≤—ã     | 2         | 1        | 799.01 | 3      |
| 5       | –ò–≥—Ä–æ–∫                 | 2         | 1        | 480.50 | 10     |
| 6       | –°—Ç–∏—Ö–æ—Ç–≤–æ—Ä–µ–Ω–∏—è –∏ –ø–æ—ç–º—ã | 3         | 2        | 650.00 | 15     |
| 7       | –ß–µ—Ä–Ω—ã–π —á–µ–ª–æ–≤–µ–∫        | 3         | 2        | 570.20 | 6      |
| 8       | –õ–∏—Ä–∏–∫–∞                | 4         | 2        | 518.99 | 0      |

---

‚ú≥ –®–∞–≥ 6. 

‚ùì*–ó–∞–¥–∞–Ω–∏–µ. –°–æ–∑–¥–∞—Ç—å —Å—á–µ—Ç (—Ç–∞–±–ª–∏—Ü—É buy_pay) –Ω–∞ –æ–ø–ª–∞—Ç—É –∑–∞–∫–∞–∑–∞ —Å –Ω–æ–º–µ—Ä–æ–º 5, –≤ –∫–æ—Ç–æ—Ä—ã–π –≤–∫–ª—é—á–∏—Ç—å –Ω–∞–∑–≤–∞–Ω–∏–µ –∫–Ω–∏–≥, –∏—Ö –∞–≤—Ç–æ—Ä–∞, —Ü–µ–Ω—É, –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –∑–∞–∫–∞–∑–∞–Ω–Ω—ã—Ö –∫–Ω–∏–≥ –∏  —Å—Ç–æ–∏–º–æ—Å—Ç—å. –ü–æ—Å–ª–µ–¥–Ω–∏–π —Å—Ç–æ–ª–±–µ—Ü –Ω–∞–∑–≤–∞—Ç—å –°—Ç–æ–∏–º–æ—Å—Ç—å. –ò–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é –≤ —Ç–∞–±–ª–∏—Ü—É –∑–∞–Ω–µ—Å—Ç–∏ –≤ –æ—Ç—Å–æ—Ä—Ç–∏—Ä–æ–≤–∞–Ω–Ω–æ–º –ø–æ –Ω–∞–∑–≤–∞–Ω–∏—è–º –∫–Ω–∏–≥ –≤–∏–¥–µ.* 

*–§—Ä–∞–≥–º–µ–Ω—Ç –ª–æ–≥–∏—á–µ—Å–∫–æ–π —Å—Ö–µ–º—ã –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö:*

![](https://ucarecdn.com/cf0254ce-b399-4abd-afa4-29c3613272b0/)

‚úî`–†–ï–®–ï–ù–ò–ï` ‚§µÔ∏è

```sql
CREATE TABLE buy_pay AS 
SELECT 
  title, 
  name_author, 
  price, 
  buy_book.amount, 
  book.price * buy_book.amount AS –°—Ç–æ–∏–º–æ—Å—Ç—å 
FROM 
  buy_book 
  JOIN book USING(book_id) 
  JOIN author USING(author_id) 
WHERE 
  buy_book.buy_id = 5 
ORDER BY 
  book.title;
SELECT 
  * 
FROM 
  buy_pay;
```

üîé `–†–ï–ó–£–õ–¨–¢–ê–¢` ‚§µÔ∏è

| title         | name_author    | price  | amount | –°—Ç–æ–∏–º–æ—Å—Ç—å |
|:---------------:|:---------------:|:---------------:|:---------------:|:---------------:|
| –ë–µ–ª–∞—è –≥–≤–∞—Ä–¥–∏—è | –ë—É–ª–≥–∞–∫–æ–≤ –ú.–ê.  | 540.50 | 1      | 540.50    |
| –õ–∏—Ä–∏–∫–∞        | –ü–∞—Å—Ç–µ—Ä–Ω–∞–∫ –ë.–õ. | 518.99 | 2      | 1037.98   |

---

‚ú≥ –®–∞–≥ 7. 

‚ùì*–ó–∞–¥–∞–Ω–∏–µ. –°–æ–∑–¥–∞—Ç—å –æ–±—â–∏–π —Å—á–µ—Ç (—Ç–∞–±–ª–∏—Ü—É buy_pay) –Ω–∞ –æ–ø–ª–∞—Ç—É –∑–∞–∫–∞–∑–∞ —Å –Ω–æ–º–µ—Ä–æ–º 5. –ö—É–¥–∞ –≤–∫–ª—é—á–∏—Ç—å –Ω–æ–º–µ—Ä –∑–∞–∫–∞–∑–∞, –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –∫–Ω–∏–≥ –≤ –∑–∞–∫–∞–∑–µ (–Ω–∞–∑–≤–∞–Ω–∏–µ —Å—Ç–æ–ª–±—Ü–∞ –ö–æ–ª–∏—á–µ—Å—Ç–≤–æ) –∏ –µ–≥–æ –æ–±—â—É—é —Å—Ç–æ–∏–º–æ—Å—Ç—å (–Ω–∞–∑–≤–∞–Ω–∏–µ —Å—Ç–æ–ª–±—Ü–∞ –ò—Ç–æ–≥–æ). –î–ª—è —Ä–µ—à–µ–Ω–∏—è –∏—Å–ø–æ–ª—å–∑—É–π—Ç–µ –û–î–ò–ù –∑–∞–ø—Ä–æ—Å.* 

*–§—Ä–∞–≥–º–µ–Ω—Ç –ª–æ–≥–∏—á–µ—Å–∫–æ–π —Å—Ö–µ–º—ã –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö:*

![](https://ucarecdn.com/44e123c6-e706-43d9-8f5e-e54c3e35338f/)

‚úî`–†–ï–®–ï–ù–ò–ï` ‚§µÔ∏è

```sql
CREATE TABLE buy_pay AS 
SELECT 
  buy_id, 
  SUM(buy_book.amount) AS –ö–æ–ª–∏—á–µ—Å—Ç–≤–æ, 
  SUM(book.price * buy_book.amount) AS –ò—Ç–æ–≥–æ 
FROM 
  buy_book 
  JOIN book USING(book_id) 
  JOIN author USING(author_id) 
WHERE 
  buy_book.buy_id = 5;
SELECT 
  * 
FROM 
  buy_pay;
```

üîé `–†–ï–ó–£–õ–¨–¢–ê–¢` ‚§µÔ∏è

| buy_id | –ö–æ–ª–∏—á–µ—Å—Ç–≤–æ | –ò—Ç–æ–≥–æ   |
|:---------------:|:---------------:|:---------------:|
| 5      | 3          | 1578.48 |

---

‚ú≥ –®–∞–≥ 8. 

‚ùì*–ó–∞–¥–∞–Ω–∏–µ. –í —Ç–∞–±–ª–∏—Ü—É buy_step –¥–ª—è –∑–∞–∫–∞–∑–∞ —Å –Ω–æ–º–µ—Ä–æ–º 5 –≤–∫–ª—é—á–∏—Ç—å –≤—Å–µ —ç—Ç–∞–ø—ã –∏–∑ —Ç–∞–±–ª–∏—Ü—ã step, –∫–æ—Ç–æ—Ä—ã–µ –¥–æ–ª–∂–µ–Ω –ø—Ä–æ–π—Ç–∏ —ç—Ç–æ—Ç –∑–∞–∫–∞–∑. –í —Å—Ç–æ–ª–±—Ü—ã date_step_beg –∏ date_step_end –≤—Å–µ—Ö –∑–∞–ø–∏—Å–µ–π –∑–∞–Ω–µ—Å—Ç–∏ Null.* 

*–§—Ä–∞–≥–º–µ–Ω—Ç –ª–æ–≥–∏—á–µ—Å–∫–æ–π —Å—Ö–µ–º—ã –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö:*

![](https://ucarecdn.com/b104b25f-4a80-4b07-ab1a-f73c25dc3e0b/)

‚úî`–†–ï–®–ï–ù–ò–ï` ‚§µÔ∏è

```sql
INSERT INTO buy_step(buy_id, step_id) 
SELECT 
  buy_id, 
  step_id 
FROM 
  step CROSS 
  JOIN buy 
WHERE 
  buy_id = 5;
SELECT 
  * 
FROM 
  buy_step;
```

üîé `–†–ï–ó–£–õ–¨–¢–ê–¢` ‚§µÔ∏è

| buy_step_id | buy_id | step_id | date_step_beg | date_step_end |
|:---------------:|:---------------:|:---------------:|:---------------:|:---------------:|
| 1           | 1      | 1       | 2020-02-20    | 2020-02-20    |
| 2           | 1      | 2       | 2020-02-20    | 2020-02-21    |
| 3           | 1      | 3       | 2020-02-22    | 2020-03-07    |
| 4           | 1      | 4       | 2020-03-06    | 2020-03-06    |
| 5           | 2      | 1       | 2020-02-28    | 2020-02-28    |
| 6           | 2      | 2       | 2020-02-29    | 2020-03-01    |
| 7           | 2      | 3       | 2020-03-02    | NULL          |
| 8           | 2      | 4       | NULL          | NULL          |
| 9           | 3      | 1       | 2020-03-05    | 2020-03-05    |
| 10          | 3      | 2       | 2020-03-05    | 2020-03-06    |
| 11          | 3      | 3       | 2020-03-06    | 2020-03-10    |
| 12          | 3      | 4       | 2020-03-11    | NULL          |
| 13          | 4      | 1       | 2020-03-20    | NULL          |
| 14          | 4      | 2       | NULL          | NULL          |
| 15          | 4      | 3       | NULL          | NULL          |
| 16          | 4      | 4       | NULL          | NULL          |
| 17          | 5      | 1       | NULL          | NULL          |
| 18          | 5      | 2       | NULL          | NULL          |
| 19          | 5      | 3       | NULL          | NULL          |
| 20          | 5      | 4       | NULL          | NULL          |

---

‚ú≥ –®–∞–≥ 9. 

‚ùì*–ó–∞–¥–∞–Ω–∏–µ. –í —Ç–∞–±–ª–∏—Ü—É buy_step –∑–∞–Ω–µ—Å—Ç–∏ –¥–∞—Ç—É 12.04.2020 –≤—ã—Å—Ç–∞–≤–ª–µ–Ω–∏—è —Å—á–µ—Ç–∞ –Ω–∞ –æ–ø–ª–∞—Ç—É –∑–∞–∫–∞–∑–∞ —Å –Ω–æ–º–µ—Ä–æ–º 5.  
–ü—Ä–∞–≤–∏–ª—å–Ω–µ–µ –±—ã–ª–æ –±—ã –∑–∞–Ω–µ—Å—Ç–∏ –Ω–µ –∫–æ–Ω–∫—Ä–µ—Ç–Ω—É—é, –∞ —Ç–µ–∫—É—â—É—é –¥–∞—Ç—É. –≠—Ç–æ –º–æ–∂–Ω–æ —Å–¥–µ–ª–∞—Ç—å —Å –ø–æ–º–æ—â—å—é —Ñ—É–Ω–∫—Ü–∏–∏ Now(). –ù–æ –ø—Ä–∏ —ç—Ç–æ–º –≤ —Ä–∞–∑–Ω—ã–µ –¥–Ω–∏ –±—É–¥—É—Ç –≤—Å—Ç–∞–≤–ª—è—Ç—å—Å—è —Ä–∞–∑–Ω–∞—è –¥–∞—Ç–∞, –∏ –∑–∞–¥–∞–Ω–∏–µ –Ω–µ–ª—å–∑—è –±—É–¥–µ—Ç –ø—Ä–æ–≤–µ—Ä–∏—Ç—å, –ø–æ—ç—Ç–æ–º—É  –≤—Å—Ç–∞–≤–∏–º –¥–∞—Ç—É 12.04.2020.* 

*–§—Ä–∞–≥–º–µ–Ω—Ç –ª–æ–≥–∏—á–µ—Å–∫–æ–π —Å—Ö–µ–º—ã –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö:*

![](https://ucarecdn.com/82bcc6a0-9bef-4202-acdf-fed95bdeab67/)

‚úî`–†–ï–®–ï–ù–ò–ï` ‚§µÔ∏è

```sql
UPDATE 
  buy_step 
  JOIN step USING(step_id) 
SET 
  date_step_beg = '2020-04-12' 
WHERE 
  buy_step.buy_id = 5 
  AND name_step = '–û–ø–ª–∞—Ç–∞';
SELECT 
  * 
FROM 
  buy_step;
```

üîé `–†–ï–ó–£–õ–¨–¢–ê–¢` ‚§µÔ∏è

| buy_step_id | buy_id | step_id | date_step_beg | date_step_end |
|:---------------:|:---------------:|:---------------:|:---------------:|:---------------:|
| 1           | 1      | 1       | 2020-02-20    | 2020-02-20    |
| 2           | 1      | 2       | 2020-02-20    | 2020-02-21    |
| 3           | 1      | 3       | 2020-02-22    | 2020-03-07    |
| 4           | 1      | 4       | 2020-03-06    | 2020-03-06    |
| 5           | 2      | 1       | 2020-02-28    | 2020-02-28    |
| 6           | 2      | 2       | 2020-02-29    | 2020-03-01    |
| 7           | 2      | 3       | 2020-03-02    | NULL          |
| 8           | 2      | 4       | NULL          | NULL          |
| 9           | 3      | 1       | 2020-03-05    | 2020-03-05    |
| 10          | 3      | 2       | 2020-03-05    | 2020-03-06    |
| 11          | 3      | 3       | 2020-03-06    | 2020-03-10    |
| 12          | 3      | 4       | 2020-03-11    | NULL          |
| 13          | 4      | 1       | 2020-03-20    | NULL          |
| 14          | 4      | 2       | NULL          | NULL          |
| 15          | 4      | 3       | NULL          | NULL          |
| 16          | 4      | 4       | NULL          | NULL          |
| 17          | 5      | 1       | 2020-04-12    | NULL          |
| 18          | 5      | 2       | NULL          | NULL          |
| 19          | 5      | 3       | NULL          | NULL          |
| 20          | 5      | 4       | NULL          | NULL          |

---

‚ú≥ –®–∞–≥ 10. 

‚ùì*–ó–∞–¥–∞–Ω–∏–µ. –ó–∞–≤–µ—Ä—à–∏—Ç—å —ç—Ç–∞–ø ¬´–û–ø–ª–∞—Ç–∞¬ª –¥–ª—è –∑–∞–∫–∞–∑–∞ —Å –Ω–æ–º–µ—Ä–æ–º 5, –≤—Å—Ç–∞–≤–∏–≤ –≤ —Å—Ç–æ–ª–±–µ—Ü date_step_end –¥–∞—Ç—É 13.04.2020, –∏ –Ω–∞—á–∞—Ç—å —Å–ª–µ–¥—É—é—â–∏–π —ç—Ç–∞–ø (¬´–£–ø–∞–∫–æ–≤–∫–∞¬ª), –∑–∞–¥–∞–≤ –≤ —Å—Ç–æ–ª–±—Ü–µ date_step_beg –¥–ª—è —ç—Ç–æ–≥–æ —ç—Ç–∞–ø–∞ —Ç—É –∂–µ –¥–∞—Ç—É.  
–†–µ–∞–ª–∏–∑–æ–≤–∞—Ç—å –¥–≤–∞ –∑–∞–ø—Ä–æ—Å–∞ –¥–ª—è –∑–∞–≤–µ—Ä—à–µ–Ω–∏—è —ç—Ç–∞–ø–∞ –∏ –Ω–∞—á–∞–ª–∞ —Å–ª–µ–¥—É—é—â–µ–≥–æ. –û–Ω–∏ –¥–æ–ª–∂–Ω—ã –±—ã—Ç—å –∑–∞–ø–∏—Å–∞–Ω—ã –≤ –æ–±—â–µ–º –≤–∏–¥–µ, —á—Ç–æ–±—ã –µ–≥–æ –º–æ–∂–Ω–æ –±—ã–ª–æ –ø—Ä–∏–º–µ–Ω—è—Ç—å –¥–ª—è –ª—é–±—ã—Ö —ç—Ç–∞–ø–æ–≤, –∏–∑–º–µ–Ω–∏–≤ —Ç–æ–ª—å–∫–æ —Ç–µ–∫—É—â–∏–π —ç—Ç–∞–ø. –î–ª—è –ø—Ä–∏–º–µ—Ä–∞ –ø—É—Å—Ç—å —ç—Ç–æ –±—É–¥–µ—Ç —ç—Ç–∞–ø ¬´–û–ø–ª–∞—Ç–∞¬ª.* 

*–§—Ä–∞–≥–º–µ–Ω—Ç –ø—Ä–µ–¥–º–µ—Ç–Ω–æ–π –æ–±–ª–∞—Å—Ç–∏:*

![](https://ucarecdn.com/38630f8f-d5ae-4284-8133-bee549683afc/)

‚úî`–†–ï–®–ï–ù–ò–ï` ‚§µÔ∏è

```sql
UPDATE 
  buy_step 
  JOIN step USING(step_id) 
SET 
  date_step_end = '2020-04-13' 
WHERE 
  buy_step.buy_id = 5 
  AND name_step = '–û–ø–ª–∞—Ç–∞';
UPDATE 
  buy_step 
SET 
  date_step_beg = '2020-04-13' 
WHERE 
  buy_id = 5 
  AND step_id = (
    SELECT 
      step_id + 1 
    FROM 
      step 
    WHERE 
      name_step = '–û–ø–ª–∞—Ç–∞'
  );
SELECT 
  * 
FROM 
  buy_step;
```

üîé `–†–ï–ó–£–õ–¨–¢–ê–¢` ‚§µÔ∏è

|buy_step_id | buy_id | step_id | date_step_beg | date_step_end |
|:---------------:|:---------------:|:---------------:|:---------------:|:---------------:|
| 1           | 1      | 1       | 2020-02-20    | 2020-02-20    |
| 2           | 1      | 2       | 2020-02-20    | 2020-02-21    |
| 3           | 1      | 3       | 2020-02-22    | 2020-03-07    |
| 4           | 1      | 4       | 2020-03-06    | 2020-03-06    |
| 5           | 2      | 1       | 2020-02-28    | 2020-02-28    |
| 6           | 2      | 2       | 2020-02-29    | 2020-03-01    |
| 7           | 2      | 3       | 2020-03-02    | NULL          |
| 8           | 2      | 4       | NULL          | NULL          |
| 9           | 3      | 1       | 2020-03-05    | 2020-03-05    |
| 10          | 3      | 2       | 2020-03-05    | 2020-03-06    |
| 11          | 3      | 3       | 2020-03-06    | 2020-03-10    |
| 12          | 3      | 4       | 2020-03-11    | NULL          |
| 13          | 4      | 1       | 2020-03-20    | NULL          |
| 14          | 4      | 2       | NULL          | NULL          |
| 15          | 4      | 3       | NULL          | NULL          |
| 16          | 4      | 4       | NULL          | NULL          |
| 17          | 5      | 1       | 2020-04-12    | 2020-04-13    |
| 18          | 5      | 2       | 2020-04-13    | NULL          |
| 19          | 5      | 3       | NULL          | NULL          |
| 20          | 5      | 4       | NULL          | NULL          |

---