# 3. –ë–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö –∏ SQL –∑–∞–ø—Ä–æ—Å—ã

## 3.1 –ë–∞–∑–∞ –¥–∞–Ω–Ω—ã—Ö ¬´–¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ¬ª, –∑–∞–ø—Ä–æ—Å—ã –Ω–∞ –≤—ã–±–æ—Ä–∫—É

–í —É–Ω–∏–≤–µ—Ä—Å–∏—Ç–µ—Ç–µ —Ä–µ–∞–ª–∏–∑—É–µ—Ç—Å—è on-line —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –ø–æ –Ω–µ—Å–∫–æ–ª—å–∫–∏–º –¥–∏—Å—Ü–∏–ø–ª–∏–Ω–∞–º. –ö–∞–∂–¥–∞—è –¥–∏—Å—Ü–∏–ø–ª–∏–Ω–∞ –≤–∫–ª—é—á–∞–µ—Ç –Ω–µ–∫–æ—Ç–æ—Ä–æ–µ –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –≤–æ–ø—Ä–æ—Å–æ–≤. –û—Ç–≤–µ—Ç—ã –Ω–∞ –≤–æ–ø—Ä–æ—Å –ø—Ä–µ–¥—Å—Ç–∞–≤–ª–µ–Ω—ã –≤ –≤–∏–¥–µ –≤–∞—Ä–∏–∞–Ω—Ç–æ–≤ –æ—Ç–≤–µ—Ç–æ–≤, –æ–¥–∏–Ω –∏–∑ —ç—Ç–∏—Ö –≤–∞—Ä–∏–∞–Ω—Ç–æ–≤ –ø—Ä–∞–≤–∏–ª—å–Ω—ã–π.  
–°—Ç—É–¥–µ–Ω—Ç —Ä–µ–≥–∏—Å—Ç—Ä–∏—Ä—É–µ—Ç—Å—è –≤ —Å–∏—Å—Ç–µ–º–µ, —É–∫–∞–∑–∞–≤ —Å–≤–æ–µ –∏–º—è, —Ñ–∞–º–∏–ª–∏—é –∏ –æ—Ç—á–µ—Å—Ç–≤–æ. –ü–æ—Å–ª–µ —ç—Ç–æ–≥–æ –æ–Ω –º–æ–∂–µ—Ç –ø—Ä–æ—Ö–æ–¥–∏—Ç—å —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –ø–æ –æ–¥–Ω–æ–π –∏–ª–∏ –Ω–µ—Å–∫–æ–ª—å–∫–∏–º –¥–∏—Å—Ü–∏–ø–ª–∏–Ω–∞–º. –°—Ç—É–¥–µ–Ω—Ç –∏–º–µ–µ—Ç –Ω–µ—Å–∫–æ–ª—å–∫–æ –ø–æ–ø—ã—Ç–æ–∫ –¥–ª—è –ø—Ä–æ—Ö–æ–∂–¥–µ–Ω–∏—è —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è  (–Ω–µ–æ–±—Ö–æ–¥–∏–º–æ —Å–æ—Ö—Ä–∞–Ω—è—Ç—å –¥–∞—Ç—É –ø–æ–ø—ã—Ç–∫–∏). –ö–∞–∂–¥–æ–º—É —Å—Ç—É–¥–µ–Ω—Ç—É —Å–ª—É—á–∞–π–Ω—ã–º –æ–±—Ä–∞–∑–æ–º –≤—ã–±–∏—Ä–∞–µ—Ç—Å—è –Ω–∞–±–æ—Ä –≤–æ–ø—Ä–æ—Å–æ–≤ –ø–æ –¥–∏—Å—Ü–∏–ø–ª–∏–Ω–µ –∏ —Ñ–æ—Ä–º–∏—Ä—É–µ—Ç—Å—è –∏–Ω–¥–∏–≤–∏–¥—É–∞–ª—å–Ω—ã–π —Ç–µ—Å—Ç. –°—Ç—É–¥–µ–Ω—Ç –æ—Ç–≤–µ—á–∞–µ—Ç –Ω–∞ –≤–æ–ø—Ä–æ—Å—ã, –≤—ã–±–∏—Ä–∞—è –æ–¥–∏–Ω –∏–∑ –ø—Ä–µ–¥–ª–æ–∂–µ–Ω–Ω—ã—Ö –≤–∞—Ä–∏–∞–Ω—Ç–æ–≤ –æ—Ç–≤–µ—Ç–∞.  
–ü–æ—Å–ª–µ –æ–∫–æ–Ω—á–∞–Ω–∏—è —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è  –≤—ã—á–∏—Å–ª—è–µ—Ç—Å—è –∏ —Å–æ—Ö—Ä–∞–Ω—è–µ—Ç—Å—è —Ä–µ–∑—É–ª—å—Ç–∞—Ç (–≤ –ø—Ä–æ—Ü–µ–Ω—Ç–∞—Ö) –ø–æ–ø—ã—Ç–∫–∏.

–ö–æ–Ω—Ü–µ–ø—Ç—É–∞–ª—å–Ω–∞—è —Å—Ö–µ–º–∞ –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö:

![](https://ucarecdn.com/c3a958bc-1805-4da5-b4b9-e77343f65024/)

–õ–æ–≥–∏—á–µ—Å–∫–∞—è —Å—Ö–µ–º–∞ –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö:

![](https://ucarecdn.com/e4669333-8898-434f-b1a5-4fa88b39ae02/)

‚ú≥ –®–∞–≥ 2. 

‚ùì*–ó–∞–¥–∞–Ω–∏–µ. –í—ã–≤–µ—Å—Ç–∏ —Å—Ç—É–¥–µ–Ω—Ç–æ–≤, –∫–æ—Ç–æ—Ä—ã–µ —Å–¥–∞–≤–∞–ª–∏ –¥–∏—Å—Ü–∏–ø–ª–∏–Ω—É ¬´–û—Å–Ω–æ–≤—ã –±–∞–∑ –¥–∞–Ω–Ω—ã—Ö¬ª, —É–∫–∞–∑–∞—Ç—å –¥–∞—Ç—É –ø–æ–ø—ã—Ç–∫–∏ –∏ —Ä–µ–∑—É–ª—å—Ç–∞—Ç. –ò–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é –≤—ã–≤–µ—Å—Ç–∏ –ø–æ —É–±—ã–≤–∞–Ω–∏—é —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è.*

*–§—Ä–∞–≥–º–µ–Ω—Ç –ª–æ–≥–∏—á–µ—Å–∫–æ–π —Å—Ö–µ–º—ã –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö:*

![](https://ucarecdn.com/d46b4a8e-ef49-4335-815b-f3d685f63a13/)

*–ù–∞–ø–æ–ª–Ω–µ–Ω–∏–µ —Ç–∞–±–ª–∏—Ü attempt, student, subject:*

*—Ç–∞–±–ª–∏—Ü–∞ attempt*

| attempt_id | student_id | subject_id | date_attempt | result |
|:---------------:|:---------------:|:---------------:|:---------------:|:---------------:|
| 1          | 1          | 2          | 2020-03-23   | 67     |
| 2          | 3          | 1          | 2020-03-23   | 100    |
| 3          | 4          | 2          | 2020-03-26   | 0      |
| 4          | 1          | 1          | 2020-04-15   | 33     |
| 5          | 3          | 1          | 2020-04-15   | 67     |
| 6          | 4          | 2          | 2020-04-21   | 100    |
| 7          | 3          | 1          | 2020-05-17   | 33     |

*—Ç–∞–±–ª–∏—Ü–∞ student*    

| student_id | name_student    |  
|:---------------:|:---------------:|
| 1          | –ë–∞—Ä–∞–Ω–æ–≤ –ü–∞–≤–µ–ª   |  
| 2          | –ê–±—Ä–∞–º–æ–≤–∞ –ö–∞—Ç—è   |  
| 3          | –°–µ–º–µ–Ω–æ–≤ –ò–≤–∞–Ω    |  
| 4          | –Ø–∫–æ–≤–ª–µ–≤–∞ –ì–∞–ª–∏–Ω–∞ |

*—Ç–∞–±–ª–∏—Ü–∞ subject*

| subject_id | name_subject      |
|:---------------:|:---------------:|
| 1          | –û—Å–Ω–æ–≤—ã SQL        |
| 2          | –û—Å–Ω–æ–≤—ã –±–∞–∑ –¥–∞–Ω–Ω—ã—Ö |
| 3          | –§–∏–∑–∏–∫–∞            |

‚úî`–†–ï–®–ï–ù–ò–ï` ‚§µÔ∏è

```sql
SELECT 
  name_student, 
  date_attempt, 
  result 
FROM 
  student 
  JOIN attempt USING(student_id) 
  JOIN subject USING(subject_id) 
WHERE 
  name_subject = '–û—Å–Ω–æ–≤—ã –±–∞–∑ –¥–∞–Ω–Ω—ã—Ö' 
ORDER BY 
  3 DESC;
```

üîé `–†–ï–ó–£–õ–¨–¢–ê–¢` ‚§µÔ∏è

| name_student    | date_attempt | result |
|:---------------:|:---------------:|:---------------:|
| –Ø–∫–æ–≤–ª–µ–≤–∞ –ì–∞–ª–∏–Ω–∞ | 2020-04-21   | 100    |
| –ë–∞—Ä–∞–Ω–æ–≤ –ü–∞–≤–µ–ª   | 2020-03-23   | 67     |
| –Ø–∫–æ–≤–ª–µ–≤–∞ –ì–∞–ª–∏–Ω–∞ | 2020-03-26   | 0      |

---

‚ú≥ –®–∞–≥ 3. 

‚ùì*–ó–∞–¥–∞–Ω–∏–µ. –í—ã–≤–µ—Å—Ç–∏, —Å–∫–æ–ª—å–∫–æ –ø–æ–ø—ã—Ç–æ–∫ —Å–¥–µ–ª–∞–ª–∏ —Å—Ç—É–¥–µ–Ω—Ç—ã –ø–æ –∫–∞–∂–¥–æ–π –¥–∏—Å—Ü–∏–ø–ª–∏–Ω–µ, –∞ —Ç–∞–∫–∂–µ —Å—Ä–µ–¥–Ω–∏–π —Ä–µ–∑—É–ª—å—Ç–∞—Ç –ø–æ–ø—ã—Ç–æ–∫, –∫–æ—Ç–æ—Ä—ã–π –æ–∫—Ä—É–≥–ª–∏—Ç—å –¥–æ 2 –∑–Ω–∞–∫–æ–≤ –ø–æ—Å–ª–µ –∑–∞–ø—è—Ç–æ–π. –ü–æ–¥ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–º –ø–æ–ø—ã—Ç–∫–∏ –ø–æ–Ω–∏–º–∞–µ—Ç—Å—è –ø—Ä–æ—Ü–µ–Ω—Ç –ø—Ä–∞–≤–∏–ª—å–Ω—ã—Ö –æ—Ç–≤–µ—Ç–æ–≤ –Ω–∞ –≤–æ–ø—Ä–æ—Å—ã —Ç–µ—Å—Ç–∞, –∫–æ—Ç–æ—Ä—ã–π –∑–∞–Ω–µ—Å–µ–Ω –≤ —Å—Ç–æ–ª–±–µ—Ü result.  –í —Ä–µ–∑—É–ª—å—Ç–∞—Ç –≤–∫–ª—é—á–∏—Ç—å –Ω–∞–∑–≤–∞–Ω–∏–µ –¥–∏—Å—Ü–∏–ø–ª–∏–Ω—ã, –∞ —Ç–∞–∫–∂–µ –≤—ã—á–∏—Å–ª—è–µ–º—ã–µ —Å—Ç–æ–ª–±—Ü—ã –ö–æ–ª–∏—á–µ—Å—Ç–≤–æ –∏ –°—Ä–µ–¥–Ω–µ–µ. –ò–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é –≤—ã–≤–µ—Å—Ç–∏ –ø–æ —É–±—ã–≤–∞–Ω–∏—é —Å—Ä–µ–¥–Ω–∏—Ö —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤.*

*–§—Ä–∞–≥–º–µ–Ω—Ç –ª–æ–≥–∏—á–µ—Å–∫–æ–π —Å—Ö–µ–º—ã –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö:*

![](https://ucarecdn.com/d8715483-b850-4ce8-8e2d-12ac8ba18d0c/)

*–°—Ç—Ä—É–∫—Ç—É—Ä–∞ –∏ –Ω–∞–ø–æ–ª–Ω–µ–Ω–∏–µ —Ç–∞–±–ª–∏—Ü attempt –∏ subject:*

*—Ç–∞–±–ª–∏—Ü–∞ attempt*

| attempt_id | student_id | subject_id | date_attempt | result |
|:---------------:|:---------------:|:---------------:|:---------------:|:---------------:|
| 1          | 1          | 2          | 2020-03-23   | 67     |
| 2          | 3          | 1          | 2020-03-23   | 100    |
| 3          | 4          | 2          | 2020-03-26   | 0      |
| 4          | 1          | 1          | 2020-04-15   | 33     |
| 5          | 3          | 1          | 2020-04-15   | 67     |
| 6          | 4          | 2          | 2020-04-21   | 100    |
| 7          | 3          | 1          | 2020-05-17   | 33     |

*—Ç–∞–±–ª–∏—Ü–∞ subject*

| subject_id | name_subject      |
|:---------------:|:---------------:|
| 1          | –û—Å–Ω–æ–≤—ã SQL        |
| 2          | –û—Å–Ω–æ–≤—ã –±–∞–∑ –¥–∞–Ω–Ω—ã—Ö |
| 3          | –§–∏–∑–∏–∫–∞            |

‚úî`–†–ï–®–ï–ù–ò–ï` ‚§µÔ∏è

```sql
SELECT 
  name_subject, 
  COUNT(attempt_id) AS –ö–æ–ª–∏—á–µ—Å—Ç–≤–æ, 
  ROUND(
    AVG(result), 
    2
  ) AS –°—Ä–µ–¥–Ω–µ–µ 
FROM 
  subject 
  LEFT JOIN attempt USING(subject_id) 
GROUP BY 
  1 
ORDER BY 
  3 DESC;
```

üîé `–†–ï–ó–£–õ–¨–¢–ê–¢` ‚§µÔ∏è

| name_subject      | –ö–æ–ª–∏—á–µ—Å—Ç–≤–æ | –°—Ä–µ–¥–Ω–µ–µ |
|:---------------:|:---------------:|:---------------:|
| –û—Å–Ω–æ–≤—ã SQL        | 4          | 58.25   |
| –û—Å–Ω–æ–≤—ã –±–∞–∑ –¥–∞–Ω–Ω—ã—Ö | 3          | 55.67   |
| –§–∏–∑–∏–∫–∞            | 0          | NULL    |

---

‚ú≥ –®–∞–≥ 4. 

‚ùì*–ó–∞–¥–∞–Ω–∏–µ. –í—ã–≤–µ—Å—Ç–∏ —Å—Ç—É–¥–µ–Ω—Ç–æ–≤ (—Ä–∞–∑–ª–∏—á–Ω—ã—Ö —Å—Ç—É–¥–µ–Ω—Ç–æ–≤), –∏–º–µ—é—â–∏—Ö –º–∞–∫—Å–∏–º–∞–ª—å–Ω—ã–µ —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã –ø–æ–ø—ã—Ç–æ–∫. –ò–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é –æ—Ç—Å–æ—Ä—Ç–∏—Ä–æ–≤–∞—Ç—å –≤ –∞–ª—Ñ–∞–≤–∏—Ç–Ω–æ–º –ø–æ—Ä—è–¥–∫–µ –ø–æ —Ñ–∞–º–∏–ª–∏–∏ —Å—Ç—É–¥–µ–Ω—Ç–∞.  
–ú–∞–∫—Å–∏–º–∞–ª—å–Ω—ã–π —Ä–µ–∑—É–ª—å—Ç–∞—Ç –Ω–µ –æ–±—è–∑–∞—Ç–µ–ª—å–Ω–æ –±—É–¥–µ—Ç 100%, –ø–æ—ç—Ç–æ–º—É —è–≤–Ω–æ —ç—Ç–æ –∑–Ω–∞—á–µ–Ω–∏–µ –≤ –∑–∞–ø—Ä–æ—Å–µ –Ω–µ –∑–∞–¥–∞–≤–∞—Ç—å.*

*–§—Ä–∞–≥–º–µ–Ω—Ç –ª–æ–≥–∏—á–µ—Å–∫–æ–π —Å—Ö–µ–º—ã –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö:*

![](https://ucarecdn.com/3d7b1b34-90b4-4d76-aea0-03369872489d/)

*–°—Ç—Ä—É–∫—Ç—É—Ä–∞ –∏ –Ω–∞–ø–æ–ª–Ω–µ–Ω–∏–µ —Ç–∞–±–ª–∏—Ü attempt –∏ student:*

*—Ç–∞–±–ª–∏—Ü–∞ attempt*

| attempt_id | student_id | subject_id | date_attempt | result |
|:---------------:|:---------------:|:---------------:|:---------------:|:---------------:|
| 1          | 1          | 2          | 2020-03-23   | 67     |
| 2          | 3          | 1          | 2020-03-23   | 100    |
| 3          | 4          | 2          | 2020-03-26   | 0      |
| 4          | 1          | 1          | 2020-04-15   | 33     |
| 5          | 3          | 1          | 2020-04-15   | 67     |
| 6          | 4          | 2          | 2020-04-21   | 100    |
| 7          | 3          | 1          | 2020-05-17   | 33     |

*—Ç–∞–±–ª–∏—Ü–∞ student*    

| student_id | name_student    |  
|:---------------:|:---------------:|
| 1          | –ë–∞—Ä–∞–Ω–æ–≤ –ü–∞–≤–µ–ª   |  
| 2          | –ê–±—Ä–∞–º–æ–≤–∞ –ö–∞—Ç—è   |  
| 3          | –°–µ–º–µ–Ω–æ–≤ –ò–≤–∞–Ω    |  
| 4          | –Ø–∫–æ–≤–ª–µ–≤–∞ –ì–∞–ª–∏–Ω–∞ |

‚úî`–†–ï–®–ï–ù–ò–ï` ‚§µÔ∏è

```sql
SELECT 
  name_student, 
  result 
FROM 
  student 
  JOIN attempt USING(student_id) 
WHERE 
  result = (
    SELECT 
      MAX(result) 
    FROM 
      attempt
  ) 
ORDER BY 
  1;
```

üîé `–†–ï–ó–£–õ–¨–¢–ê–¢` ‚§µÔ∏è

| name_student    | result |
|:---------------:|:---------------:|
| –°–µ–º–µ–Ω–æ–≤ –ò–≤–∞–Ω    | 100    |
| –Ø–∫–æ–≤–ª–µ–≤–∞ –ì–∞–ª–∏–Ω–∞ | 100    |

---

‚ú≥ –®–∞–≥ 5. 

‚ùì*–ó–∞–¥–∞–Ω–∏–µ. –ï—Å–ª–∏ —Å—Ç—É–¥–µ–Ω—Ç —Å–æ–≤–µ—Ä—à–∞–ª –Ω–µ—Å–∫–æ–ª—å–∫–æ –ø–æ–ø—ã—Ç–æ–∫ –ø–æ –æ–¥–Ω–æ–π –∏ —Ç–æ–π –∂–µ –¥–∏—Å—Ü–∏–ø–ª–∏–Ω–µ, —Ç–æ –≤—ã–≤–µ—Å—Ç–∏ —Ä–∞–∑–Ω–∏—Ü—É –≤ –¥–Ω—è—Ö –º–µ–∂–¥—É –ø–µ—Ä–≤–æ–π –∏ –ø–æ—Å–ª–µ–¥–Ω–µ–π –ø–æ–ø—ã—Ç–∫–æ–π. –í —Ä–µ–∑—É–ª—å—Ç–∞—Ç –≤–∫–ª—é—á–∏—Ç—å —Ñ–∞–º–∏–ª–∏—é –∏ –∏–º—è —Å—Ç—É–¥–µ–Ω—Ç–∞, –Ω–∞–∑–≤–∞–Ω–∏–µ –¥–∏—Å—Ü–∏–ø–ª–∏–Ω—ã –∏ –≤—ã—á–∏—Å–ª—è–µ–º—ã–π —Å—Ç–æ–ª–±–µ—Ü –ò–Ω—Ç–µ—Ä–≤–∞–ª. –ò–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é –≤—ã–≤–µ—Å—Ç–∏ –ø–æ –≤–æ–∑—Ä–∞—Å—Ç–∞–Ω–∏—é —Ä–∞–∑–Ω–∏—Ü—ã. –°—Ç—É–¥–µ–Ω—Ç–æ–≤, —Å–¥–µ–ª–∞–≤—à–∏—Ö –æ–¥–Ω—É –ø–æ–ø—ã—Ç–∫—É –ø–æ –¥–∏—Å—Ü–∏–ø–ª–∏–Ω–µ, –Ω–µ —É—á–∏—Ç—ã–≤–∞—Ç—å.*

*–§—Ä–∞–≥–º–µ–Ω—Ç –ª–æ–≥–∏—á–µ—Å–∫–æ–π —Å—Ö–µ–º—ã –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö:*

![](https://ucarecdn.com/0702acbe-ec20-457d-85e4-6df22e070656/)

*–°—Ç—Ä—É–∫—Ç—É—Ä–∞ –∏ –Ω–∞–ø–æ–ª–Ω–µ–Ω–∏–µ —Ç–∞–±–ª–∏—Ü:*

*—Ç–∞–±–ª–∏—Ü–∞ attempt*

| attempt_id | student_id | subject_id | date_attempt | result |
|:---------------:|:---------------:|:---------------:|:---------------:|:---------------:|
| 1          | 1          | 2          | 2020-03-23   | 67     |
| 2          | 3          | 1          | 2020-03-23   | 100    |
| 3          | 4          | 2          | 2020-03-26   | 0      |
| 4          | 1          | 1          | 2020-04-15   | 33     |
| 5          | 3          | 1          | 2020-04-15   | 67     |
| 6          | 4          | 2          | 2020-04-21   | 100    |
| 7          | 3          | 1          | 2020-05-17   | 33     |

*—Ç–∞–±–ª–∏—Ü–∞ student*    

| student_id | name_student    |  
|:---------------:|:---------------:|
| 1          | –ë–∞—Ä–∞–Ω–æ–≤ –ü–∞–≤–µ–ª   |  
| 2          | –ê–±—Ä–∞–º–æ–≤–∞ –ö–∞—Ç—è   |  
| 3          | –°–µ–º–µ–Ω–æ–≤ –ò–≤–∞–Ω    |  
| 4          | –Ø–∫–æ–≤–ª–µ–≤–∞ –ì–∞–ª–∏–Ω–∞ |

*—Ç–∞–±–ª–∏—Ü–∞ subject*

| subject_id | name_subject      |
|:---------------:|:---------------:|
| 1          | –û—Å–Ω–æ–≤—ã SQL        |
| 2          | –û—Å–Ω–æ–≤—ã –±–∞–∑ –¥–∞–Ω–Ω—ã—Ö |
| 3          | –§–∏–∑–∏–∫–∞            |

‚úî`–†–ï–®–ï–ù–ò–ï` ‚§µÔ∏è

```sql
SELECT 
  name_student, 
  name_subject, 
  DATEDIFF(
    MAX(date_attempt), 
    MIN(date_attempt)
  ) AS –ò–Ω—Ç–µ—Ä–≤–∞–ª 
FROM 
  attempt 
  JOIN student USING(student_id) 
  JOIN subject USING(subject_id) 
GROUP BY 
  1, 
  2 
HAVING 
  COUNT(subject_id) > 1 
ORDER BY 
  3;
```

üîé `–†–ï–ó–£–õ–¨–¢–ê–¢` ‚§µÔ∏è

| name_student    | name_subject      | –ò–Ω—Ç–µ—Ä–≤–∞–ª |
|:---------------:|:---------------:|:---------------:|
| –Ø–∫–æ–≤–ª–µ–≤–∞ –ì–∞–ª–∏–Ω–∞ | –û—Å–Ω–æ–≤—ã –±–∞–∑ –¥–∞–Ω–Ω—ã—Ö | 26       |
| –°–µ–º–µ–Ω–æ–≤ –ò–≤–∞–Ω    | –û—Å–Ω–æ–≤—ã SQL        | 55       |

---

‚ú≥ –®–∞–≥ 6. 

‚ùì*–ó–∞–¥–∞–Ω–∏–µ. –°—Ç—É–¥–µ–Ω—Ç—ã –º–æ–≥—É—Ç —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞—Ç—å—Å—è –ø–æ –æ–¥–Ω–æ–π –∏–ª–∏ –Ω–µ—Å–∫–æ–ª—å–∫–∏–º –¥–∏—Å—Ü–∏–ø–ª–∏–Ω–∞–º (–Ω–µ –æ–±—è–∑–∞—Ç–µ–ª—å–Ω–æ –ø–æ –≤—Å–µ–º). –í—ã–≤–µ—Å—Ç–∏ –¥–∏—Å—Ü–∏–ø–ª–∏–Ω—É –∏ –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ —É–Ω–∏–∫–∞–ª—å–Ω—ã—Ö —Å—Ç—É–¥–µ–Ω—Ç–æ–≤ (—Å—Ç–æ–ª–±–µ—Ü –Ω–∞–∑–≤–∞—Ç—å –ö–æ–ª–∏—á–µ—Å—Ç–≤–æ), –∫–æ—Ç–æ—Ä—ã–µ –ø–æ –Ω–µ–π –ø—Ä–æ—Ö–æ–¥–∏–ª–∏ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ . –ò–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é –æ—Ç—Å–æ—Ä—Ç–∏—Ä–æ–≤–∞—Ç—å —Å–Ω–∞—á–∞–ª–∞ –ø–æ —É–±—ã–≤–∞–Ω–∏—é –∫–æ–ª–∏—á–µ—Å—Ç–≤–∞, –∞ –ø–æ—Ç–æ–º –ø–æ –Ω–∞–∑–≤–∞–Ω–∏—é –¥–∏—Å—Ü–∏–ø–ª–∏–Ω—ã. –í —Ä–µ–∑—É–ª—å—Ç–∞—Ç –≤–∫–ª—é—á–∏—Ç—å –∏ –¥–∏—Å—Ü–∏–ø–ª–∏–Ω—ã, —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –ø–æ –∫–æ—Ç–æ—Ä—ã–º —Å—Ç—É–¥–µ–Ω—Ç—ã –µ—â–µ –Ω–µ –ø—Ä–æ—Ö–æ–¥–∏–ª–∏, –≤ —ç—Ç–æ–º —Å–ª—É—á–∞–µ —É–∫–∞–∑–∞—Ç—å –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ —Å—Ç—É–¥–µ–Ω—Ç–æ–≤ 0.*

*–§—Ä–∞–≥–º–µ–Ω—Ç –ª–æ–≥–∏—á–µ—Å–∫–æ–π —Å—Ö–µ–º—ã –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö:*

![](https://ucarecdn.com/306248a6-1b7c-4b93-8106-31a368482f0c/)

*–°—Ç—Ä—É–∫—Ç—É—Ä–∞ –∏ –Ω–∞–ø–æ–ª–Ω–µ–Ω–∏–µ —Ç–∞–±–ª–∏—Ü attempt –∏ subject:*

*—Ç–∞–±–ª–∏—Ü–∞ attempt*

| attempt_id | student_id | subject_id | date_attempt | result |
|:---------------:|:---------------:|:---------------:|:---------------:|:---------------:|
| 1          | 1          | 2          | 2020-03-23   | 67     |
| 2          | 3          | 1          | 2020-03-23   | 100    |
| 3          | 4          | 2          | 2020-03-26   | 0      |
| 4          | 1          | 1          | 2020-04-15   | 33     |
| 5          | 3          | 1          | 2020-04-15   | 67     |
| 6          | 4          | 2          | 2020-04-21   | 100    |
| 7          | 3          | 1          | 2020-05-17   | 33     |

*—Ç–∞–±–ª–∏—Ü–∞ subject*

| subject_id | name_subject      |
|:---------------:|:---------------:|
| 1          | –û—Å–Ω–æ–≤—ã SQL        |
| 2          | –û—Å–Ω–æ–≤—ã –±–∞–∑ –¥–∞–Ω–Ω—ã—Ö |
| 3          | –§–∏–∑–∏–∫–∞            |

‚úî`–†–ï–®–ï–ù–ò–ï` ‚§µÔ∏è

```sql
SELECT 
  name_subject, 
  COUNT(
    DISTINCT(student_id)
  ) AS –ö–æ–ª–∏—á–µ—Å—Ç–≤–æ 
FROM 
  subject 
  LEFT JOIN attempt USING(subject_id) 
GROUP BY 
  1 
ORDER BY 
  2 DESC, 
  1;
```

üîé `–†–ï–ó–£–õ–¨–¢–ê–¢` ‚§µÔ∏è

| name_subject      | –ö–æ–ª–∏—á–µ—Å—Ç–≤–æ |
|:---------------:|:---------------:|
| –û—Å–Ω–æ–≤—ã SQL        | 2          |
| –û—Å–Ω–æ–≤—ã –±–∞–∑ –¥–∞–Ω–Ω—ã—Ö | 2          |
| –§–∏–∑–∏–∫–∞            | 0          |

---

‚ú≥ –®–∞–≥ 7. 

‚ùì*–ó–∞–¥–∞–Ω–∏–µ. –°–ª—É—á–∞–π–Ω—ã–º –æ–±—Ä–∞–∑–æ–º –æ—Ç–±–µ—Ä–∏—Ç–µ 3 –≤–æ–ø—Ä–æ—Å–∞ –ø–æ –¥–∏—Å—Ü–∏–ø–ª–∏–Ω–µ ¬´–û—Å–Ω–æ–≤—ã –±–∞–∑ –¥–∞–Ω–Ω—ã—Ö¬ª. –í —Ä–µ–∑—É–ª—å—Ç–∞—Ç –≤–∫–ª—é—á–∏—Ç–µ —Å—Ç–æ–ª–±—Ü—ã question_id –∏ name_question.*

*–§—Ä–∞–≥–º–µ–Ω—Ç –ª–æ–≥–∏—á–µ—Å–∫–æ–π —Å—Ö–µ–º—ã –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö:*

![](https://ucarecdn.com/332c38fe-08e4-4c27-bc71-3b3200f43c3b/)

*–°—Ç—Ä—É–∫—Ç—É—Ä–∞ –∏ –Ω–∞–ø–æ–ª–Ω–µ–Ω–∏–µ —Ç–∞–±–ª–∏—Ü question –∏ subject:*

*—Ç–∞–±–ª–∏—Ü–∞ question*

| question_id | name_question                                                           | subject_id |
|:---------------:|:---------------:|:---------------:|
| 1           | –ó–∞–ø—Ä–æ—Å –Ω–∞ –≤—ã–±–æ—Ä–∫—É –Ω–∞—á–∏–Ω–∞–µ—Ç—Å—è —Å –∫–ª—é—á–µ–≤–æ–≥–æ —Å–ª–æ–≤–∞:                         | 1          |
| 2           | –£—Å–ª–æ–≤–∏–µ, –ø–æ –∫–æ—Ç–æ—Ä–æ–º—É –æ—Ç–±–∏—Ä–∞—é—Ç—Å—è –∑–∞–ø–∏—Å–∏, –∑–∞–¥–∞–µ—Ç—Å—è –ø–æ—Å–ª–µ –∫–ª—é—á–µ–≤–æ–≥–æ —Å–ª–æ–≤–∞: | 1          |
| 3           | –î–ª—è —Å–æ—Ä—Ç–∏—Ä–æ–≤–∫–∏ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è:                                            | 1          |
| 4           | –ö–∞–∫–æ–π –∑–∞–ø—Ä–æ—Å –≤—ã–±–∏—Ä–∞–µ—Ç –≤—Å–µ –∑–∞–ø–∏—Å–∏ –∏–∑ —Ç–∞–±–ª–∏—Ü—ã student:                    | 1          |
| 5           | –î–ª—è –≤–Ω—É—Ç—Ä–µ–Ω–Ω–µ–≥–æ —Å–æ–µ–¥–∏–Ω–µ–Ω–∏—è —Ç–∞–±–ª–∏—Ü –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –æ–ø–µ—Ä–∞—Ç–æ—Ä:                | 1          |
| 6           | –ë–∞–∑–∞ –¥–∞–Ω–Ω—ã—Ö - —ç—Ç–æ:                                                      | 2          |
| 7           | –û—Ç–Ω–æ—à–µ–Ω–∏–µ - —ç—Ç–æ:                                                        | 2          |
| 8           | –ö–æ–Ω—Ü–µ–ø—Ç—É–∞–ª—å–Ω–∞—è –º–æ–¥–µ–ª—å –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –¥–ª—è                                  | 2          |
| 9           | –ö–∞–∫–æ–π —Ç–∏–ø –¥–∞–Ω–Ω—ã—Ö –Ω–µ –¥–æ–ø—É—Å—Ç–∏–º –≤ —Ä–µ–ª—è—Ü–∏–æ–Ω–Ω–æ–π —Ç–∞–±–ª–∏—Ü–µ?                     | 2          |

*—Ç–∞–±–ª–∏—Ü–∞ subject*

| subject_id | name_subject      |
|:---------------:|:---------------:|
| 1          | –û—Å–Ω–æ–≤—ã SQL        |
| 2          | –û—Å–Ω–æ–≤—ã –±–∞–∑ –¥–∞–Ω–Ω—ã—Ö |
| 3          | –§–∏–∑–∏–∫–∞            |

‚úî`–†–ï–®–ï–ù–ò–ï` ‚§µÔ∏è

```sql
SELECT 
  question_id, 
  name_question 
FROM 
  question 
  JOIN subject USING(subject_id) 
WHERE 
  name_subject = '–û—Å–Ω–æ–≤—ã –±–∞–∑ –¥–∞–Ω–Ω—ã—Ö' 
ORDER BY 
  RAND() 
LIMIT 
  3;
```

üîé `–†–ï–ó–£–õ–¨–¢–ê–¢` ‚§µÔ∏è

| question_id | name_question                          |
|:---------------:|:---------------:|
| 7           | –û—Ç–Ω–æ—à–µ–Ω–∏–µ - —ç—Ç–æ:                       |
| 8           | –ö–æ–Ω—Ü–µ–ø—Ç—É–∞–ª—å–Ω–∞—è –º–æ–¥–µ–ª—å –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –¥–ª—è |
| 6           | –ë–∞–∑–∞ –¥–∞–Ω–Ω—ã—Ö - —ç—Ç–æ:                     |

---

‚ú≥ –®–∞–≥ 8. 

‚ùì*–ó–∞–¥–∞–Ω–∏–µ. –í—ã–≤–µ—Å—Ç–∏ –≤–æ–ø—Ä–æ—Å—ã, –∫–æ—Ç–æ—Ä—ã–µ –±—ã–ª–∏ –≤–∫–ª—é—á–µ–Ω—ã –≤ —Ç–µ—Å—Ç –¥–ª—è –°–µ–º–µ–Ω–æ–≤–∞ –ò–≤–∞–Ω–∞ –ø–æ –¥–∏—Å—Ü–∏–ø–ª–∏–Ω–µ ¬´–û—Å–Ω–æ–≤—ã SQL¬ª 2020-05-17  (–∑–Ω–∞—á–µ–Ω–∏–µ attempt_id –¥–ª—è —ç—Ç–æ–π –ø–æ–ø—ã—Ç–∫–∏ —Ä–∞–≤–Ω–æ 7). –£–∫–∞–∑–∞—Ç—å, –∫–∞–∫–æ–π –æ—Ç–≤–µ—Ç –¥–∞–ª —Å—Ç—É–¥–µ–Ω—Ç –∏ –ø—Ä–∞–≤–∏–ª—å–Ω—ã–π –æ–Ω –∏–ª–∏ –Ω–µ—Ç (–≤—ã–≤–µ—Å—Ç–∏ –í–µ—Ä–Ω–æ –∏–ª–∏ –ù–µ–≤–µ—Ä–Ω–æ). –í —Ä–µ–∑—É–ª—å—Ç–∞—Ç –≤–∫–ª—é—á–∏—Ç—å –≤–æ–ø—Ä–æ—Å, –æ—Ç–≤–µ—Ç –∏ –≤—ã—á–∏—Å–ª—è–µ–º—ã–π —Å—Ç–æ–ª–±–µ—Ü  –†–µ–∑—É–ª—å—Ç–∞—Ç.*

*–§—Ä–∞–≥–º–µ–Ω—Ç –ª–æ–≥–∏—á–µ—Å–∫–æ–π —Å—Ö–µ–º—ã –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö:*

![](https://ucarecdn.com/9cea1edc-98ee-4215-ae29-70ebf8aaea21/)

*–ù–∞–ø–æ–ª–Ω–µ–Ω–∏–µ —Ç–∞–±–ª–∏—Ü question, answer, testing:*

*—Ç–∞–±–ª–∏—Ü–∞ question*

| question_id | name_question                                                           | subject_id |
|:---------------:|:---------------:|:---------------:|
| 1           | –ó–∞–ø—Ä–æ—Å –Ω–∞ –≤—ã–±–æ—Ä–∫—É –Ω–∞—á–∏–Ω–∞–µ—Ç—Å—è —Å –∫–ª—é—á–µ–≤–æ–≥–æ —Å–ª–æ–≤–∞:                         | 1          |
| 2           | –£—Å–ª–æ–≤–∏–µ, –ø–æ –∫–æ—Ç–æ—Ä–æ–º—É –æ—Ç–±–∏—Ä–∞—é—Ç—Å—è –∑–∞–ø–∏—Å–∏, –∑–∞–¥–∞–µ—Ç—Å—è –ø–æ—Å–ª–µ –∫–ª—é—á–µ–≤–æ–≥–æ —Å–ª–æ–≤–∞: | 1          |
| 3           | –î–ª—è —Å–æ—Ä—Ç–∏—Ä–æ–≤–∫–∏ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è:                                            | 1          |
| 4           | –ö–∞–∫–æ–π –∑–∞–ø—Ä–æ—Å –≤—ã–±–∏—Ä–∞–µ—Ç –≤—Å–µ –∑–∞–ø–∏—Å–∏ –∏–∑ —Ç–∞–±–ª–∏—Ü—ã student:                    | 1          |
| 5           | –î–ª—è –≤–Ω—É—Ç—Ä–µ–Ω–Ω–µ–≥–æ —Å–æ–µ–¥–∏–Ω–µ–Ω–∏—è —Ç–∞–±–ª–∏—Ü –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –æ–ø–µ—Ä–∞—Ç–æ—Ä:                | 1          |
| 6           | –ë–∞–∑–∞ –¥–∞–Ω–Ω—ã—Ö - —ç—Ç–æ:                                                      | 2          |
| 7           | –û—Ç–Ω–æ—à–µ–Ω–∏–µ - —ç—Ç–æ:                                                        | 2          |
| 8           | –ö–æ–Ω—Ü–µ–ø—Ç—É–∞–ª—å–Ω–∞—è –º–æ–¥–µ–ª—å –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –¥–ª—è                                  | 2          |
| 9           | –ö–∞–∫–æ–π —Ç–∏–ø –¥–∞–Ω–Ω—ã—Ö –Ω–µ –¥–æ–ø—É—Å—Ç–∏–º –≤ —Ä–µ–ª—è—Ü–∏–æ–Ω–Ω–æ–π —Ç–∞–±–ª–∏—Ü–µ?                     | 2          |

*—Ç–∞–±–ª–∏—Ü–∞ answer*

| answer_id | name_answer                                            | question_id | is_correct |
|:---------------:|:---------------:|:---------------:|:---------------:|
| 1         | UPDATE                                                 | 1           | 0          |
| 2         | SELECT                                                 | 1           | 1          |
| 3         | INSERT                                                 | 1           | 0          |
| 4         | GROUP BY                                               | 2           | 0          |
| 5         | FROM                                                   | 2           | 0          |
| 6         | WHERE                                                  | 2           | 1          |
| 7         | SELECT                                                 | 2           | 0          |
| 8         | SORT                                                   | 3           | 0          |
| 9         | ORDER BY                                               | 3           | 1          |
| 10        | RANG BY                                                | 3           | 0          |
| 11        | SELECT * FROM student                                  | 4           | 1          |
| 12        | SELECT student                                         | 4           | 0          |
| 13        | INNER JOIN                                             | 5           | 1          |
| 14        | LEFT JOIN                                              | 5           | 0          |
| 15        | RIGHT JOIN                                             | 5           | 0          |
| 16        | CROSS JOIN                                             | 5           | 0          |
| 17        | —Å–æ–≤–æ–∫—É–ø–Ω–æ—Å—Ç—å –¥–∞–Ω–Ω—ã—Ö, –æ—Ä–≥–∞–Ω–∏–∑–æ–≤–∞–Ω–Ω—ã—Ö–ø–æ –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–Ω—ã–º...  | 6           | 1          |
| 18        | —Å–æ–≤–æ–∫—É–ø–Ω–æ—Å—Ç—å –ø—Ä–æ–≥—Ä–∞–º–º –¥–ª—è —Ö—Ä–∞–Ω–µ–Ω–∏—è –∏–æ–±—Ä–∞–±–æ—Ç–∫–∏ ...      | 6           | 0          |
| 19        | —Å—Ç—Ä–æ–∫–∞                                                 | 7           | 0          |
| 20        | —Å—Ç–æ–ª–±–µ—Ü                                                | 7           | 0          |
| 21        | —Ç–∞–±–ª–∏—Ü–∞                                                | 7           | 1          |
| 22        | –æ–±–æ–±—â–µ–Ω–Ω–æ–µ –ø—Ä–µ–¥—Å—Ç–∞–≤–ª–µ–Ω–∏–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π –æ –¥–∞–Ω–Ω—ã—Ö        | 8           | 1          |
| 23        | –æ–ø–∏—Å–∞–Ω–∏–µ –ø—Ä–µ–¥—Å—Ç–∞–≤–ª–µ–Ω–∏—è –¥–∞–Ω–Ω—ã—Ö –≤ –ø–∞–º—è—Ç–∏ –∫–æ–º–ø—å—é—Ç–µ—Ä–∞      | 8           | 0          |
| 24        | –±–∞–∑–∞ –¥–∞–Ω–Ω—ã—Ö                                            | 8           | 0          |
| 25        | file                                                   | 9           | 1          |
| 26        | INT                                                    | 9           | 0          |
| 27        | VARCHAR                                                | 9           | 0          |
| 28        | DATE                                                   | 9           | 0          |

*—Ç–∞–±–ª–∏—Ü–∞ testing*

| testing_id | attempt_id | question_id | answer_id |
|:---------------:|:---------------:|:---------------:|:---------------:|
| 1          | 1          | 9           | 25        |
| 2          | 1          | 7           | 19        |
| 3          | 1          | 6           | 17        |
| 4          | 2          | 3           | 9         |
| 5          | 2          | 1           | 2         |
| 6          | 2          | 4           | 11        |
| 7          | 3          | 6           | 18        |
| 8          | 3          | 8           | 24        |
| 9          | 3          | 9           | 28        |
| 10         | 4          | 1           | 2         |
| 11         | 4          | 5           | 16        |
| 12         | 4          | 3           | 10        |
| 13         | 5          | 2           | 6         |
| 14         | 5          | 1           | 2         |
| 15         | 5          | 4           | 12        |
| 16         | 6          | 6           | 17        |
| 17         | 6          | 8           | 22        |
| 18         | 6          | 7           | 21        |
| 19         | 7          | 1           | 3         |
| 20         | 7          | 4           | 11        |
| 21         | 7          | 5           | 16        |

‚úî`–†–ï–®–ï–ù–ò–ï` ‚§µÔ∏è

```sql
SELECT 
  name_question, 
  name_answer, 
  IF(
    is_correct = 1, '–í–µ—Ä–Ω–æ', '–ù–µ–≤–µ—Ä–Ω–æ'
  ) AS –†–µ–∑—É–ª—å—Ç–∞—Ç 
FROM 
  testing AS t 
  JOIN question AS q ON t.question_id = q.question_id 
  JOIN answer AS a ON a.answer_id = t.answer_id 
WHERE 
  attempt_id = 7;
```

üîé `–†–ï–ó–£–õ–¨–¢–ê–¢` ‚§µÔ∏è

| name_question                                            | name_answer           | –†–µ–∑—É–ª—å—Ç–∞—Ç |
|:---------------:|:---------------:|:---------------:|
| –ó–∞–ø—Ä–æ—Å –Ω–∞ –≤—ã–±–æ—Ä–∫—É –Ω–∞—á–∏–Ω–∞–µ—Ç—Å—è —Å –∫–ª—é—á–µ–≤–æ–≥–æ —Å–ª–æ–≤–∞:          | INSERT                | –ù–µ–≤–µ—Ä–Ω–æ   |
| –ö–∞–∫–æ–π –∑–∞–ø—Ä–æ—Å –≤—ã–±–∏—Ä–∞–µ—Ç –≤—Å–µ –∑–∞–ø–∏—Å–∏ –∏–∑ —Ç–∞–±–ª–∏—Ü—ã student:     | SELECT * FROM student | –í–µ—Ä–Ω–æ     |
| –î–ª—è –≤–Ω—É—Ç—Ä–µ–Ω–Ω–µ–≥–æ —Å–æ–µ–¥–∏–Ω–µ–Ω–∏—è —Ç–∞–±–ª–∏—Ü –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –æ–ø–µ—Ä–∞—Ç–æ—Ä: | CROSS JOIN            | –ù–µ–≤–µ—Ä–Ω–æ   |

---

‚ú≥ –®–∞–≥ 9. 

‚ùì*–ó–∞–¥–∞–Ω–∏–µ. –ü–æ—Å—á–∏—Ç–∞—Ç—å —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è. –†–µ–∑—É–ª—å—Ç–∞—Ç –ø–æ–ø—ã—Ç–∫–∏ –≤—ã—á–∏—Å–ª–∏—Ç—å –∫–∞–∫ –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –ø—Ä–∞–≤–∏–ª—å–Ω—ã—Ö –æ—Ç–≤–µ—Ç–æ–≤, –¥–µ–ª–µ–Ω–Ω–æ–µ –Ω–∞ 3 (–∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –≤–æ–ø—Ä–æ—Å–æ–≤ –≤ –∫–∞–∂–¥–æ–π –ø–æ–ø—ã—Ç–∫–µ) –∏ —É–º–Ω–æ–∂–µ–Ω–Ω–æ–µ –Ω–∞ 100. –†–µ–∑—É–ª—å—Ç–∞—Ç –æ–∫—Ä—É–≥–ª–∏—Ç—å –¥–æ –¥–≤—É—Ö –∑–Ω–∞–∫–æ–≤ –ø–æ—Å–ª–µ –∑–∞–ø—è—Ç–æ–π. –í—ã–≤–µ—Å—Ç–∏ —Ñ–∞–º–∏–ª–∏—é —Å—Ç—É–¥–µ–Ω—Ç–∞, –Ω–∞–∑–≤–∞–Ω–∏–µ –ø—Ä–µ–¥–º–µ—Ç–∞, –¥–∞—Ç—É –∏ —Ä–µ–∑—É–ª—å—Ç–∞—Ç. –ü–æ—Å–ª–µ–¥–Ω–∏–π —Å—Ç–æ–ª–±–µ—Ü –Ω–∞–∑–≤–∞—Ç—å –†–µ–∑—É–ª—å—Ç–∞—Ç. –ò–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é –æ—Ç—Å–æ—Ä—Ç–∏—Ä–æ–≤–∞—Ç—å —Å–Ω–∞—á–∞–ª–∞ –ø–æ —Ñ–∞–º–∏–ª–∏–∏ —Å—Ç—É–¥–µ–Ω—Ç–∞, –ø–æ—Ç–æ–º –ø–æ —É–±—ã–≤–∞–Ω–∏—é –¥–∞—Ç—ã –ø–æ–ø—ã—Ç–∫–∏.*

*–õ–æ–≥–∏—á–µ—Å–∫–∞—è —Å—Ö–µ–º–∞ –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö (—á—Ç–æ–±—ã –ø–æ—Ç—Ä–µ–Ω–∏—Ä–æ–≤–∞—Ç—å—Å—è –≤—ã–±–∏—Ä–∞—Ç—å –Ω—É–∂–Ω—ã–µ —Ç–∞–±–ª–∏—Ü—ã):*

![](https://ucarecdn.com/e4669333-8898-434f-b1a5-4fa88b39ae02/)

*–ù–∞–ø–æ–ª–Ω–µ–Ω–∏–µ —Ç–∞–±–ª–∏—Ü:*

*—Ç–∞–±–ª–∏—Ü–∞ student*    

| student_id | name_student    |  
|:---------------:|:---------------:|
| 1          | –ë–∞—Ä–∞–Ω–æ–≤ –ü–∞–≤–µ–ª   |  
| 2          | –ê–±—Ä–∞–º–æ–≤–∞ –ö–∞—Ç—è   |  
| 3          | –°–µ–º–µ–Ω–æ–≤ –ò–≤–∞–Ω    |  
| 4          | –Ø–∫–æ–≤–ª–µ–≤–∞ –ì–∞–ª–∏–Ω–∞ |

*—Ç–∞–±–ª–∏—Ü–∞ subject*

| subject_id | name_subject      |
|:---------------:|:---------------:|
| 1          | –û—Å–Ω–æ–≤—ã SQL        |
| 2          | –û—Å–Ω–æ–≤—ã –±–∞–∑ –¥–∞–Ω–Ω—ã—Ö |
| 3          | –§–∏–∑–∏–∫–∞            |

*—Ç–∞–±–ª–∏—Ü–∞ question*

| question_id | name_question                                                           | subject_id |
|:---------------:|:---------------:|:---------------:|
| 1           | –ó–∞–ø—Ä–æ—Å –Ω–∞ –≤—ã–±–æ—Ä–∫—É –Ω–∞—á–∏–Ω–∞–µ—Ç—Å—è —Å –∫–ª—é—á–µ–≤–æ–≥–æ —Å–ª–æ–≤–∞:                         | 1          |
| 2           | –£—Å–ª–æ–≤–∏–µ, –ø–æ –∫–æ—Ç–æ—Ä–æ–º—É –æ—Ç–±–∏—Ä–∞—é—Ç—Å—è –∑–∞–ø–∏—Å–∏, –∑–∞–¥–∞–µ—Ç—Å—è –ø–æ—Å–ª–µ –∫–ª—é—á–µ–≤–æ–≥–æ —Å–ª–æ–≤–∞: | 1          |
| 3           | –î–ª—è —Å–æ—Ä—Ç–∏—Ä–æ–≤–∫–∏ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è:                                            | 1          |
| 4           | –ö–∞–∫–æ–π –∑–∞–ø—Ä–æ—Å –≤—ã–±–∏—Ä–∞–µ—Ç –≤—Å–µ –∑–∞–ø–∏—Å–∏ –∏–∑ —Ç–∞–±–ª–∏—Ü—ã student:                    | 1          |
| 5           | –î–ª—è –≤–Ω—É—Ç—Ä–µ–Ω–Ω–µ–≥–æ —Å–æ–µ–¥–∏–Ω–µ–Ω–∏—è —Ç–∞–±–ª–∏—Ü –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –æ–ø–µ—Ä–∞—Ç–æ—Ä:                | 1          |
| 6           | –ë–∞–∑–∞ –¥–∞–Ω–Ω—ã—Ö - —ç—Ç–æ:                                                      | 2          |
| 7           | –û—Ç–Ω–æ—à–µ–Ω–∏–µ - —ç—Ç–æ:                                                        | 2          |
| 8           | –ö–æ–Ω—Ü–µ–ø—Ç—É–∞–ª—å–Ω–∞—è –º–æ–¥–µ–ª—å –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –¥–ª—è                                  | 2          |
| 9           | –ö–∞–∫–æ–π —Ç–∏–ø –¥–∞–Ω–Ω—ã—Ö –Ω–µ –¥–æ–ø—É—Å—Ç–∏–º –≤ —Ä–µ–ª—è—Ü–∏–æ–Ω–Ω–æ–π —Ç–∞–±–ª–∏—Ü–µ?                     | 2          |

*—Ç–∞–±–ª–∏—Ü–∞ answer*

| answer_id | name_answer                                            | question_id | is_correct |
|:---------------:|:---------------:|:---------------:|:---------------:|
| 1         | UPDATE                                                 | 1           | 0          |
| 2         | SELECT                                                 | 1           | 1          |
| 3         | INSERT                                                 | 1           | 0          |
| 4         | GROUP BY                                               | 2           | 0          |
| 5         | FROM                                                   | 2           | 0          |
| 6         | WHERE                                                  | 2           | 1          |
| 7         | SELECT                                                 | 2           | 0          |
| 8         | SORT                                                   | 3           | 0          |
| 9         | ORDER BY                                               | 3           | 1          |
| 10        | RANG BY                                                | 3           | 0          |
| 11        | SELECT * FROM student                                  | 4           | 1          |
| 12        | SELECT student                                         | 4           | 0          |
| 13        | INNER JOIN                                             | 5           | 1          |
| 14        | LEFT JOIN                                              | 5           | 0          |
| 15        | RIGHT JOIN                                             | 5           | 0          |
| 16        | CROSS JOIN                                             | 5           | 0          |
| 17        | —Å–æ–≤–æ–∫—É–ø–Ω–æ—Å—Ç—å –¥–∞–Ω–Ω—ã—Ö, –æ—Ä–≥–∞–Ω–∏–∑–æ–≤–∞–Ω–Ω—ã—Ö–ø–æ –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–Ω—ã–º...  | 6           | 1          |
| 18        | —Å–æ–≤–æ–∫—É–ø–Ω–æ—Å—Ç—å –ø—Ä–æ–≥—Ä–∞–º–º –¥–ª—è —Ö—Ä–∞–Ω–µ–Ω–∏—è –∏–æ–±—Ä–∞–±–æ—Ç–∫–∏ ...      | 6           | 0          |
| 19        | —Å—Ç—Ä–æ–∫–∞                                                 | 7           | 0          |
| 20        | —Å—Ç–æ–ª–±–µ—Ü                                                | 7           | 0          |
| 21        | —Ç–∞–±–ª–∏—Ü–∞                                                | 7           | 1          |
| 22        | –æ–±–æ–±—â–µ–Ω–Ω–æ–µ –ø—Ä–µ–¥—Å—Ç–∞–≤–ª–µ–Ω–∏–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π –æ –¥–∞–Ω–Ω—ã—Ö        | 8           | 1          |
| 23        | –æ–ø–∏—Å–∞–Ω–∏–µ –ø—Ä–µ–¥—Å—Ç–∞–≤–ª–µ–Ω–∏—è –¥–∞–Ω–Ω—ã—Ö –≤ –ø–∞–º—è—Ç–∏ –∫–æ–º–ø—å—é—Ç–µ—Ä–∞      | 8           | 0          |
| 24        | –±–∞–∑–∞ –¥–∞–Ω–Ω—ã—Ö                                            | 8           | 0          |
| 25        | file                                                   | 9           | 1          |
| 26        | INT                                                    | 9           | 0          |
| 27        | VARCHAR                                                | 9           | 0          |
| 28        | DATE                                                   | 9           | 0          |

*—Ç–∞–±–ª–∏—Ü–∞ attempt*

| attempt_id | student_id | subject_id | date_attempt | result |
|:---------------:|:---------------:|:---------------:|:---------------:|:---------------:|
| 1          | 1          | 2          | 2020-03-23   | 67     |
| 2          | 3          | 1          | 2020-03-23   | 100    |
| 3          | 4          | 2          | 2020-03-26   | 0      |
| 4          | 1          | 1          | 2020-04-15   | 33     |
| 5          | 3          | 1          | 2020-04-15   | 67     |
| 6          | 4          | 2          | 2020-04-21   | 100    |
| 7          | 3          | 1          | 2020-05-17   | 33     |

*—Ç–∞–±–ª–∏—Ü–∞ testing*

| testing_id | attempt_id | question_id | answer_id |
|:---------------:|:---------------:|:---------------:|:---------------:|
| 1          | 1          | 9           | 25        |
| 2          | 1          | 7           | 19        |
| 3          | 1          | 6           | 17        |
| 4          | 2          | 3           | 9         |
| 5          | 2          | 1           | 2         |
| 6          | 2          | 4           | 11        |
| 7          | 3          | 6           | 18        |
| 8          | 3          | 8           | 24        |
| 9          | 3          | 9           | 28        |
| 10         | 4          | 1           | 2         |
| 11         | 4          | 5           | 16        |
| 12         | 4          | 3           | 10        |
| 13         | 5          | 2           | 6         |
| 14         | 5          | 1           | 2         |
| 15         | 5          | 4           | 12        |
| 16         | 6          | 6           | 17        |
| 17         | 6          | 8           | 22        |
| 18         | 6          | 7           | 21        |
| 19         | 7          | 1           | 3         |
| 20         | 7          | 4           | 11        |
| 21         | 7          | 5           | 16        |

‚úî`–†–ï–®–ï–ù–ò–ï` ‚§µÔ∏è

```sql
SELECT 
  name_student, 
  name_subject, 
  date_attempt, 
  ROUND(
    (
      SUM(is_correct) / 3 * 100
    ), 
    2
  ) AS –†–µ–∑—É–ª—å—Ç–∞—Ç 
FROM 
  attempt 
  JOIN student USING(student_id) 
  JOIN subject USING(subject_id) 
  JOIN testing USING(attempt_id) 
  JOIN answer USING(answer_id) 
GROUP BY 
  1, 
  2, 
  3 
ORDER BY 
  1, 
  3 DESC;
```

üîé `–†–ï–ó–£–õ–¨–¢–ê–¢` ‚§µÔ∏è

| name_student    | name_subject      | date_attempt | –†–µ–∑—É–ª—å—Ç–∞—Ç |
|:---------------:|:---------------:|:---------------:|:---------------:|
| –ë–∞—Ä–∞–Ω–æ–≤ –ü–∞–≤–µ–ª   | –û—Å–Ω–æ–≤—ã SQL        | 2020-04-15   | 33.33     |
| –ë–∞—Ä–∞–Ω–æ–≤ –ü–∞–≤–µ–ª   | –û—Å–Ω–æ–≤—ã –±–∞–∑ –¥–∞–Ω–Ω—ã—Ö | 2020-03-23   | 66.67     |
| –°–µ–º–µ–Ω–æ–≤ –ò–≤–∞–Ω    | –û—Å–Ω–æ–≤—ã SQL        | 2020-05-17   | 33.33     |
| –°–µ–º–µ–Ω–æ–≤ –ò–≤–∞–Ω    | –û—Å–Ω–æ–≤—ã SQL        | 2020-04-15   | 66.67     |
| –°–µ–º–µ–Ω–æ–≤ –ò–≤–∞–Ω    | –û—Å–Ω–æ–≤—ã SQL        | 2020-03-23   | 100.00    |
| –Ø–∫–æ–≤–ª–µ–≤–∞ –ì–∞–ª–∏–Ω–∞ | –û—Å–Ω–æ–≤—ã –±–∞–∑ –¥–∞–Ω–Ω—ã—Ö | 2020-04-21   | 100.00    |
| –Ø–∫–æ–≤–ª–µ–≤–∞ –ì–∞–ª–∏–Ω–∞ | –û—Å–Ω–æ–≤—ã –±–∞–∑ –¥–∞–Ω–Ω—ã—Ö | 2020-03-26   | 0.00      |

---

‚ú≥ –®–∞–≥ 10. 

‚ùì*–ó–∞–¥–∞–Ω–∏–µ. –î–ª—è –∫–∞–∂–¥–æ–≥–æ –≤–æ–ø—Ä–æ—Å–∞ –≤—ã–≤–µ—Å—Ç–∏ –ø—Ä–æ—Ü–µ–Ω—Ç —É—Å–ø–µ—à–Ω—ã—Ö —Ä–µ—à–µ–Ω–∏–π, —Ç–æ –µ—Å—Ç—å –æ—Ç–Ω–æ—à–µ–Ω–∏–µ –∫–æ–ª–∏—á–µ—Å—Ç–≤–∞ –≤–µ—Ä–Ω—ã—Ö –æ—Ç–≤–µ—Ç–æ–≤ –∫ –æ–±—â–µ–º—É –∫–æ–ª–∏—á–µ—Å—Ç–≤—É –æ—Ç–≤–µ—Ç–æ–≤, –∑–Ω–∞—á–µ–Ω–∏–µ –æ–∫—Ä—É–≥–ª–∏—Ç—å –¥–æ 2-—Ö –∑–Ω–∞–∫–æ–≤ –ø–æ—Å–ª–µ –∑–∞–ø—è—Ç–æ–π. –¢–∞–∫–∂–µ –≤—ã–≤–µ—Å—Ç–∏ –Ω–∞–∑–≤–∞–Ω–∏–µ –ø—Ä–µ–¥–º–µ—Ç–∞, –∫ –∫–æ—Ç–æ—Ä–æ–º—É –æ—Ç–Ω–æ—Å–∏—Ç—Å—è –≤–æ–ø—Ä–æ—Å, –∏ –æ–±—â–µ–µ –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –æ—Ç–≤–µ—Ç–æ–≤ –Ω–∞ —ç—Ç–æ—Ç –≤–æ–ø—Ä–æ—Å. –í —Ä–µ–∑—É–ª—å—Ç–∞—Ç –≤–∫–ª—é—á–∏—Ç—å –Ω–∞–∑–≤–∞–Ω–∏–µ –¥–∏—Å—Ü–∏–ø–ª–∏–Ω—ã, –≤–æ–ø—Ä–æ—Å—ã –ø–æ –Ω–µ–π (—Å—Ç–æ–ª–±–µ—Ü –Ω–∞–∑–≤–∞—Ç—å –í–æ–ø—Ä–æ—Å), –∞ —Ç–∞–∫–∂–µ –¥–≤–∞ –≤—ã—á–∏—Å–ª—è–µ–º—ã—Ö —Å—Ç–æ–ª–±—Ü–∞ –í—Å–µ–≥–æ_–æ—Ç–≤–µ—Ç–æ–≤ –∏ –£—Å–ø–µ—à–Ω–æ—Å—Ç—å. –ò–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é –æ—Ç—Å–æ—Ä—Ç–∏—Ä–æ–≤–∞—Ç—å —Å–Ω–∞—á–∞–ª–∞ –ø–æ –Ω–∞–∑–≤–∞–Ω–∏—é –¥–∏—Å—Ü–∏–ø–ª–∏–Ω—ã, –ø–æ—Ç–æ–º –ø–æ —É–±—ã–≤–∞–Ω–∏—é —É—Å–ø–µ—à–Ω–æ—Å—Ç–∏, –∞ –ø–æ—Ç–æ–º –ø–æ —Ç–µ–∫—Å—Ç—É –≤–æ–ø—Ä–æ—Å–∞ –≤ –∞–ª—Ñ–∞–≤–∏—Ç–Ω–æ–º –ø–æ—Ä—è–¥–∫–µ.  
–ü–æ—Å–∫–æ–ª—å–∫—É —Ç–µ–∫—Å—Ç—ã –≤–æ–ø—Ä–æ—Å–æ–≤ –º–æ–≥—É—Ç –±—ã—Ç—å –¥–ª–∏–Ω–Ω—ã–º–∏, –æ–±—Ä–µ–∑–∞—Ç—å –∏—Ö 30 —Å–∏–º–≤–æ–ª–æ–≤ –∏ –¥–æ–±–∞–≤–∏—Ç—å –º–Ω–æ–≥–æ—Ç–æ—á–∏–µ "...".*

*–õ–æ–≥–∏—á–µ—Å–∫–∞—è —Å—Ö–µ–º–∞ –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö (—á—Ç–æ–±—ã –ø–æ—Ç—Ä–µ–Ω–∏—Ä–æ–≤–∞—Ç—å—Å—è –≤—ã–±–∏—Ä–∞—Ç—å –Ω—É–∂–Ω—ã–µ —Ç–∞–±–ª–∏—Ü—ã):*

![](https://ucarecdn.com/e4669333-8898-434f-b1a5-4fa88b39ae02/)

*–ù–∞–ø–æ–ª–Ω–µ–Ω–∏–µ —Ç–∞–±–ª–∏—Ü:*

*—Ç–∞–±–ª–∏—Ü–∞ student*    

| student_id | name_student    |  
|:---------------:|:---------------:|
| 1          | –ë–∞—Ä–∞–Ω–æ–≤ –ü–∞–≤–µ–ª   |  
| 2          | –ê–±—Ä–∞–º–æ–≤–∞ –ö–∞—Ç—è   |  
| 3          | –°–µ–º–µ–Ω–æ–≤ –ò–≤–∞–Ω    |  
| 4          | –Ø–∫–æ–≤–ª–µ–≤–∞ –ì–∞–ª–∏–Ω–∞ |

*—Ç–∞–±–ª–∏—Ü–∞ subject*

| subject_id | name_subject      |
|:---------------:|:---------------:|
| 1          | –û—Å–Ω–æ–≤—ã SQL        |
| 2          | –û—Å–Ω–æ–≤—ã –±–∞–∑ –¥–∞–Ω–Ω—ã—Ö |
| 3          | –§–∏–∑–∏–∫–∞            |

*—Ç–∞–±–ª–∏—Ü–∞ question*

| question_id | name_question                                                           | subject_id |
|:---------------:|:---------------:|:---------------:|
| 1           | –ó–∞–ø—Ä–æ—Å –Ω–∞ –≤—ã–±–æ—Ä–∫—É –Ω–∞—á–∏–Ω–∞–µ—Ç—Å—è —Å –∫–ª—é—á–µ–≤–æ–≥–æ —Å–ª–æ–≤–∞:                         | 1          |
| 2           | –£—Å–ª–æ–≤–∏–µ, –ø–æ –∫–æ—Ç–æ—Ä–æ–º—É –æ—Ç–±–∏—Ä–∞—é—Ç—Å—è –∑–∞–ø–∏—Å–∏, –∑–∞–¥–∞–µ—Ç—Å—è –ø–æ—Å–ª–µ –∫–ª—é—á–µ–≤–æ–≥–æ —Å–ª–æ–≤–∞: | 1          |
| 3           | –î–ª—è —Å–æ—Ä—Ç–∏—Ä–æ–≤–∫–∏ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è:                                            | 1          |
| 4           | –ö–∞–∫–æ–π –∑–∞–ø—Ä–æ—Å –≤—ã–±–∏—Ä–∞–µ—Ç –≤—Å–µ –∑–∞–ø–∏—Å–∏ –∏–∑ —Ç–∞–±–ª–∏—Ü—ã student:                    | 1          |
| 5           | –î–ª—è –≤–Ω—É—Ç—Ä–µ–Ω–Ω–µ–≥–æ —Å–æ–µ–¥–∏–Ω–µ–Ω–∏—è —Ç–∞–±–ª–∏—Ü –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –æ–ø–µ—Ä–∞—Ç–æ—Ä:                | 1          |
| 6           | –ë–∞–∑–∞ –¥–∞–Ω–Ω—ã—Ö - —ç—Ç–æ:                                                      | 2          |
| 7           | –û—Ç–Ω–æ—à–µ–Ω–∏–µ - —ç—Ç–æ:                                                        | 2          |
| 8           | –ö–æ–Ω—Ü–µ–ø—Ç—É–∞–ª—å–Ω–∞—è –º–æ–¥–µ–ª—å –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –¥–ª—è                                  | 2          |
| 9           | –ö–∞–∫–æ–π —Ç–∏–ø –¥–∞–Ω–Ω—ã—Ö –Ω–µ –¥–æ–ø—É—Å—Ç–∏–º –≤ —Ä–µ–ª—è—Ü–∏–æ–Ω–Ω–æ–π —Ç–∞–±–ª–∏—Ü–µ?                     | 2          |

*—Ç–∞–±–ª–∏—Ü–∞ answer*

| answer_id | name_answer                                            | question_id | is_correct |
|:---------------:|:---------------:|:---------------:|:---------------:|
| 1         | UPDATE                                                 | 1           | 0          |
| 2         | SELECT                                                 | 1           | 1          |
| 3         | INSERT                                                 | 1           | 0          |
| 4         | GROUP BY                                               | 2           | 0          |
| 5         | FROM                                                   | 2           | 0          |
| 6         | WHERE                                                  | 2           | 1          |
| 7         | SELECT                                                 | 2           | 0          |
| 8         | SORT                                                   | 3           | 0          |
| 9         | ORDER BY                                               | 3           | 1          |
| 10        | RANG BY                                                | 3           | 0          |
| 11        | SELECT * FROM student                                  | 4           | 1          |
| 12        | SELECT student                                         | 4           | 0          |
| 13        | INNER JOIN                                             | 5           | 1          |
| 14        | LEFT JOIN                                              | 5           | 0          |
| 15        | RIGHT JOIN                                             | 5           | 0          |
| 16        | CROSS JOIN                                             | 5           | 0          |
| 17        | —Å–æ–≤–æ–∫—É–ø–Ω–æ—Å—Ç—å –¥–∞–Ω–Ω—ã—Ö, –æ—Ä–≥–∞–Ω–∏–∑–æ–≤–∞–Ω–Ω—ã—Ö–ø–æ –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–Ω—ã–º...  | 6           | 1          |
| 18        | —Å–æ–≤–æ–∫—É–ø–Ω–æ—Å—Ç—å –ø—Ä–æ–≥—Ä–∞–º–º –¥–ª—è —Ö—Ä–∞–Ω–µ–Ω–∏—è –∏–æ–±—Ä–∞–±–æ—Ç–∫–∏ ...      | 6           | 0          |
| 19        | —Å—Ç—Ä–æ–∫–∞                                                 | 7           | 0          |
| 20        | —Å—Ç–æ–ª–±–µ—Ü                                                | 7           | 0          |
| 21        | —Ç–∞–±–ª–∏—Ü–∞                                                | 7           | 1          |
| 22        | –æ–±–æ–±—â–µ–Ω–Ω–æ–µ –ø—Ä–µ–¥—Å—Ç–∞–≤–ª–µ–Ω–∏–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π –æ –¥–∞–Ω–Ω—ã—Ö        | 8           | 1          |
| 23        | –æ–ø–∏—Å–∞–Ω–∏–µ –ø—Ä–µ–¥—Å—Ç–∞–≤–ª–µ–Ω–∏—è –¥–∞–Ω–Ω—ã—Ö –≤ –ø–∞–º—è—Ç–∏ –∫–æ–º–ø—å—é—Ç–µ—Ä–∞      | 8           | 0          |
| 24        | –±–∞–∑–∞ –¥–∞–Ω–Ω—ã—Ö                                            | 8           | 0          |
| 25        | file                                                   | 9           | 1          |
| 26        | INT                                                    | 9           | 0          |
| 27        | VARCHAR                                                | 9           | 0          |
| 28        | DATE                                                   | 9           | 0          |

*—Ç–∞–±–ª–∏—Ü–∞ attempt*

| attempt_id | student_id | subject_id | date_attempt | result |
|:---------------:|:---------------:|:---------------:|:---------------:|:---------------:|
| 1          | 1          | 2          | 2020-03-23   | 67     |
| 2          | 3          | 1          | 2020-03-23   | 100    |
| 3          | 4          | 2          | 2020-03-26   | 0      |
| 4          | 1          | 1          | 2020-04-15   | 33     |
| 5          | 3          | 1          | 2020-04-15   | 67     |
| 6          | 4          | 2          | 2020-04-21   | 100    |
| 7          | 3          | 1          | 2020-05-17   | 33     |

*—Ç–∞–±–ª–∏—Ü–∞ testing*

| testing_id | attempt_id | question_id | answer_id |
|:---------------:|:---------------:|:---------------:|:---------------:|
| 1          | 1          | 9           | 25        |
| 2          | 1          | 7           | 19        |
| 3          | 1          | 6           | 17        |
| 4          | 2          | 3           | 9         |
| 5          | 2          | 1           | 2         |
| 6          | 2          | 4           | 11        |
| 7          | 3          | 6           | 18        |
| 8          | 3          | 8           | 24        |
| 9          | 3          | 9           | 28        |
| 10         | 4          | 1           | 2         |
| 11         | 4          | 5           | 16        |
| 12         | 4          | 3           | 10        |
| 13         | 5          | 2           | 6         |
| 14         | 5          | 1           | 2         |
| 15         | 5          | 4           | 12        |
| 16         | 6          | 6           | 17        |
| 17         | 6          | 8           | 22        |
| 18         | 6          | 7           | 21        |
| 19         | 7          | 1           | 3         |
| 20         | 7          | 4           | 11        |
| 21         | 7          | 5           | 16        |

‚úî`–†–ï–®–ï–ù–ò–ï` ‚§µÔ∏è

```sql
SELECT 
  name_subject, 
  CONCAT(
    LEFT(name_question, 30), 
    '...'
  ) AS –í–æ–ø—Ä–æ—Å, 
  COUNT(testing.answer_id) AS –í—Å–µ–≥–æ_–æ—Ç–≤–µ—Ç–æ–≤, 
  ROUND(
    SUM(is_correct) / COUNT(testing.answer_id) * 100, 
    2
  ) AS –£—Å–ø–µ—à–Ω–æ—Å—Ç—å 
FROM 
  subject 
  JOIN question USING(subject_id) 
  JOIN testing USING(question_id) 
  LEFT JOIN answer USING(answer_id) 
GROUP BY 
  1, 
  2 
ORDER BY 
  1, 
  4 DESC, 
  2;
```

üîé `–†–ï–ó–£–õ–¨–¢–ê–¢` ‚§µÔ∏è

| name_subject      | –í–æ–ø—Ä–æ—Å                            | –í—Å–µ–≥–æ_–æ—Ç–≤–µ—Ç–æ–≤ | –£—Å–ø–µ—à–Ω–æ—Å—Ç—å |
|:---------------:|:---------------:|:---------------:|:---------------:|
| –û—Å–Ω–æ–≤—ã SQL        | –£—Å–ª–æ–≤–∏–µ, –ø–æ –∫–æ—Ç–æ—Ä–æ–º—É –æ—Ç–±–∏—Ä–∞—é—Ç—Å... | 1             | 100.00     |
| –û—Å–Ω–æ–≤—ã SQL        | –ó–∞–ø—Ä–æ—Å –Ω–∞ –≤—ã–±–æ—Ä–∫—É –Ω–∞—á–∏–Ω–∞–µ—Ç—Å—è —Å... | 4             | 75.00      |
| –û—Å–Ω–æ–≤—ã SQL        | –ö–∞–∫–æ–π –∑–∞–ø—Ä–æ—Å –≤—ã–±–∏—Ä–∞–µ—Ç –≤—Å–µ –∑–∞–ø–∏... | 3             | 66.67      |
| –û—Å–Ω–æ–≤—ã SQL        | –î–ª—è —Å–æ—Ä—Ç–∏—Ä–æ–≤–∫–∏ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è:...   | 2             | 50.00      |
| –û—Å–Ω–æ–≤—ã SQL        | –î–ª—è –≤–Ω—É—Ç—Ä–µ–Ω–Ω–µ–≥–æ —Å–æ–µ–¥–∏–Ω–µ–Ω–∏—è —Ç–∞–±... | 2             | 0.00       |
| –û—Å–Ω–æ–≤—ã –±–∞–∑ –¥–∞–Ω–Ω—ã—Ö | –ë–∞–∑–∞ –¥–∞–Ω–Ω—ã—Ö - —ç—Ç–æ:...             | 3             | 66.67      |
| –û—Å–Ω–æ–≤—ã –±–∞–∑ –¥–∞–Ω–Ω—ã—Ö | –ö–∞–∫–æ–π —Ç–∏–ø –¥–∞–Ω–Ω—ã—Ö –Ω–µ –¥–æ–ø—É—Å—Ç–∏–º –≤... | 2             | 50.00      |
| –û—Å–Ω–æ–≤—ã –±–∞–∑ –¥–∞–Ω–Ω—ã—Ö | –ö–æ–Ω—Ü–µ–ø—Ç—É–∞–ª—å–Ω–∞—è –º–æ–¥–µ–ª—å –∏—Å–ø–æ–ª—å–∑—É... | 2             | 50.00      |
| –û—Å–Ω–æ–≤—ã –±–∞–∑ –¥–∞–Ω–Ω—ã—Ö | –û—Ç–Ω–æ—à–µ–Ω–∏–µ - —ç—Ç–æ:...               | 2             | 50.00      |

---

## 3.2 –ë–∞–∑–∞ –¥–∞–Ω–Ω—ã—Ö ¬´–¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ¬ª, –∑–∞–ø—Ä–æ—Å—ã –∫–æ—Ä—Ä–µ–∫—Ç–∏—Ä–æ–≤–∫–∏

‚ú≥ –®–∞–≥ 2. 

‚ùì*–ó–∞–¥–∞–Ω–∏–µ. –í —Ç–∞–±–ª–∏—Ü—É attempt –≤–∫–ª—é—á–∏—Ç—å –Ω–æ–≤—É—é –ø–æ–ø—ã—Ç–∫—É –¥–ª—è —Å—Ç—É–¥–µ–Ω—Ç–∞ –ë–∞—Ä–∞–Ω–æ–≤–∞ –ü–∞–≤–ª–∞ –ø–æ –¥–∏—Å—Ü–∏–ø–ª–∏–Ω–µ ¬´–û—Å–Ω–æ–≤—ã –±–∞–∑ –¥–∞–Ω–Ω—ã—Ö¬ª. –£—Å—Ç–∞–Ω–æ–≤–∏—Ç—å —Ç–µ–∫—É—â—É—é –¥–∞—Ç—É –≤ –∫–∞—á–µ—Å—Ç–≤–µ –¥–∞—Ç—ã –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è –ø–æ–ø—ã—Ç–∫–∏.*

*–§—Ä–∞–≥–º–µ–Ω—Ç –ª–æ–≥–∏—á–µ—Å–∫–æ–π —Å—Ö–µ–º—ã –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö:*

![](https://ucarecdn.com/39672b19-b8ef-4e77-b7a8-236f2ac73fa0/)

*–ù–∞–ø–æ–ª–Ω–µ–Ω–∏–µ —Ç–∞–±–ª–∏—Ü subject, student, attempt (–ø–µ—Ä–µ–¥ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏–µ–º —à–∞–≥–∞):*

*—Ç–∞–±–ª–∏—Ü–∞ student*    

| student_id | name_student    |  
|:---------------:|:---------------:|
| 1          | –ë–∞—Ä–∞–Ω–æ–≤ –ü–∞–≤–µ–ª   |  
| 2          | –ê–±—Ä–∞–º–æ–≤–∞ –ö–∞—Ç—è   |  
| 3          | –°–µ–º–µ–Ω–æ–≤ –ò–≤–∞–Ω    |  
| 4          | –Ø–∫–æ–≤–ª–µ–≤–∞ –ì–∞–ª–∏–Ω–∞ |

*—Ç–∞–±–ª–∏—Ü–∞ subject*

| subject_id | name_subject      |
|:---------------:|:---------------:|
| 1          | –û—Å–Ω–æ–≤—ã SQL        |
| 2          | –û—Å–Ω–æ–≤—ã –±–∞–∑ –¥–∞–Ω–Ω—ã—Ö |
| 3          | –§–∏–∑–∏–∫–∞            |

*—Ç–∞–±–ª–∏—Ü–∞ attempt*

| attempt_id | student_id | subject_id | date_attempt | result |
|:---------------:|:---------------:|:---------------:|:---------------:|:---------------:|
| 1          | 1          | 2          | 2020-03-23   | 67     |
| 2          | 3          | 1          | 2020-03-23   | 100    |
| 3          | 4          | 2          | 2020-03-26   | 0      |
| 4          | 1          | 1          | 2020-04-15   | 33     |
| 5          | 3          | 1          | 2020-04-15   | 67     |
| 6          | 4          | 2          | 2020-04-21   | 100    |
| 7          | 3          | 1          | 2020-05-17   | 33     |

‚úî`–†–ï–®–ï–ù–ò–ï` ‚§µÔ∏è

```sql
INSERT INTO attempt(
  student_id, subject_id, date_attempt
) 
SELECT 
  student_id, 
  subject_id, 
  NOW() 
FROM 
  attempt 
  JOIN student USING(student_id) 
  JOIN subject USING(subject_id) 
WHERE 
  name_student = '–ë–∞—Ä–∞–Ω–æ–≤ –ü–∞–≤–µ–ª' 
  AND name_subject = '–û—Å–Ω–æ–≤—ã –±–∞–∑ –¥–∞–Ω–Ω—ã—Ö';
SELECT 
  * 
FROM 
  attempt;
```

üîé `–†–ï–ó–£–õ–¨–¢–ê–¢` ‚§µÔ∏è

| attempt_id | student_id | subject_id | date_attempt | result |
|:---------------:|:---------------:|:---------------:|:---------------:|:---------------:|
| 1          | 1          | 2          | 2020-03-23   | 67     |
| 2          | 3          | 1          | 2020-03-23   | 100    |
| 3          | 4          | 2          | 2020-03-26   | 0      |
| 4          | 1          | 1          | 2020-04-15   | 33     |
| 5          | 3          | 1          | 2020-04-15   | 67     |
| 6          | 4          | 2          | 2020-04-21   | 100    |
| 7          | 3          | 1          | 2020-05-17   | 33     |
| 8          | 1          | 2          | 2022-12-07   | NULL   |

---

‚ú≥ –®–∞–≥ 3. 

‚ùì*–ó–∞–¥–∞–Ω–∏–µ. –°–ª—É—á–∞–π–Ω—ã–º –æ–±—Ä–∞–∑–æ–º –≤—ã–±—Ä–∞—Ç—å —Ç—Ä–∏ –≤–æ–ø—Ä–æ—Å–∞ (–∑–∞–ø—Ä–æ—Å) –ø–æ –¥–∏—Å—Ü–∏–ø–ª–∏–Ω–µ, —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –ø–æ –∫–æ—Ç–æ—Ä–æ–π —Å–æ–±–∏—Ä–∞–µ—Ç—Å—è –ø—Ä–æ—Ö–æ–¥–∏—Ç—å —Å—Ç—É–¥–µ–Ω—Ç, –∑–∞–Ω–µ—Å–µ–Ω–Ω—ã–π –≤ —Ç–∞–±–ª–∏—Ü—É attempt –ø–æ—Å–ª–µ–¥–Ω–∏–º, –∏ –¥–æ–±–∞–≤–∏—Ç—å –∏—Ö –≤ —Ç–∞–±–ª–∏—Ü—É testing. id –ø–æ—Å–ª–µ–¥–Ω–µ–π –ø–æ–ø—ã—Ç–∫–∏ –ø–æ–ª—É—á–∏—Ç—å –∫–∞–∫ –º–∞–∫—Å–∏–º–∞–ª—å–Ω–æ–µ –∑–Ω–∞—á–µ–Ω–∏–µ id –∏–∑ —Ç–∞–±–ª–∏—Ü—ã attempt.*

*–§—Ä–∞–≥–º–µ–Ω—Ç –ª–æ–≥–∏—á–µ—Å–∫–æ–π —Å—Ö–µ–º—ã –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö:*

![](https://ucarecdn.com/c3b8ce24-eaaa-48b7-96c6-6c57dc6e48ca/)

*–ö–æ—Ä—Ä–µ–∫—Ç–∏—Ä—É–µ–º–∞—è —Ç–∞–±–ª–∏—Ü–∞:*

![](https://ucarecdn.com/58cd697f-3a21-4d89-83db-c8bba6328cdf/)

*–ù–∞–ø–æ–ª–Ω–µ–Ω–∏–µ —Ç–∞–±–ª–∏—Ü question, attempt, testing(–ø–µ—Ä–µ–¥ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏–µ–º —à–∞–≥–∞):*

*—Ç–∞–±–ª–∏—Ü–∞ question*    

| question_id | name_question                                              | subject_id |
|:---------------:|:---------------:|:---------------:|
| 1           | –ó–∞–ø—Ä–æ—Å –Ω–∞ –≤—ã–±–æ—Ä–∫—É –Ω–∞—á–∏–Ω–∞–µ—Ç—Å—è —Å –∫–ª—é—á–µ–≤–æ–≥–æ —Å–ª–æ–≤–∞:            | 1          |
| 2           | –£—Å–ª–æ–≤–∏–µ, –ø–æ –∫–æ—Ç–æ—Ä–æ–º—É –æ—Ç–±–∏—Ä–∞—é—Ç—Å—è –∑–∞–ø–∏—Å–∏, –∑–∞–¥–∞–µ—Ç—Å—è –ø–æ—Å–ª–µ...  | 1          |
| 3           | –î–ª—è —Å–æ—Ä—Ç–∏—Ä–æ–≤–∫–∏ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è:                               | 1          |
| 4           | –ö–∞–∫–æ–π –∑–∞–ø—Ä–æ—Å –≤—ã–±–∏—Ä–∞–µ—Ç –≤—Å–µ –∑–∞–ø–∏—Å–∏ –∏–∑ —Ç–∞–±–ª–∏—Ü—ã student:       | 1          |
| 5           | –î–ª—è –≤–Ω—É—Ç—Ä–µ–Ω–Ω–µ–≥–æ —Å–æ–µ–¥–∏–Ω–µ–Ω–∏—è —Ç–∞–±–ª–∏—Ü –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –æ–ø–µ—Ä–∞—Ç–æ—Ä:   | 1          |
| 6           | –ë–∞–∑–∞ –¥–∞–Ω–Ω—ã—Ö - —ç—Ç–æ:                                         | 2          |
| 7           | –û—Ç–Ω–æ—à–µ–Ω–∏–µ - —ç—Ç–æ:                                           | 2          |
| 8           | –ö–æ–Ω—Ü–µ–ø—Ç—É–∞–ª—å–Ω–∞—è –º–æ–¥–µ–ª—å –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –¥–ª—è                     | 2          |
| 9           | –ö–∞–∫–æ–π —Ç–∏–ø –¥–∞–Ω–Ω—ã—Ö –Ω–µ –¥–æ–ø—É—Å—Ç–∏–º –≤ —Ä–µ–ª—è—Ü–∏–æ–Ω–Ω–æ–π —Ç–∞–±–ª–∏—Ü–µ?        | 2          |

*—Ç–∞–±–ª–∏—Ü–∞ attempt*

| attempt_id | student_id | subject_id | date_attempt | result |
|:---------------:|:---------------:|:---------------:|:---------------:|:---------------:|
| 1          | 1          | 2          | 2020-03-23   | 67     |
| 2          | 3          | 1          | 2020-03-23   | 100    |
| 3          | 4          | 2          | 2020-03-26   | 0      |
| 4          | 1          | 1          | 2020-04-15   | 33     |
| 5          | 3          | 1          | 2020-04-15   | 67     |
| 6          | 4          | 2          | 2020-04-21   | 100    |
| 7          | 3          | 1          | 2020-05-17   | 33     |
| 8          | 1          | 2          | 2020-06-12   | NULL   |

*—Ç–∞–±–ª–∏—Ü–∞ testing*

| testing_id | attempt_id | question_id | answer_id |
|:---------------:|:---------------:|:---------------:|:---------------:|
| 1          | 1          | 9           | 25        |
| 2          | 1          | 7           | 19        |
| 3          | 1          | 6           | 17        |
| 4          | 2          | 3           | 9         |
| 5          | 2          | 1           | 2         |
| 6          | 2          | 4           | 11        |
| 7          | 3          | 6           | 18        |
| 8          | 3          | 8           | 24        |
| 9          | 3          | 9           | 28        |
| 10         | 4          | 1           | 2         |
| 11         | 4          | 5           | 16        |
| 12         | 4          | 3           | 10        |
| 13         | 5          | 2           | 6         |
| 14         | 5          | 1           | 2         |
| 15         | 5          | 4           | 12        |
| 16         | 6          | 6           | 17        |
| 17         | 6          | 8           | 22        |
| 18         | 6          | 7           | 21        |
| 19         | 7          | 1           | 3         |
| 20         | 7          | 4           | 11        |
| 21         | 7          | 5           | 16        |

‚úî`–†–ï–®–ï–ù–ò–ï` ‚§µÔ∏è

```sql
INSERT INTO testing(attempt_id, question_id) 
SELECT 
  attempt_id, 
  question_id 
FROM 
  attempt 
  JOIN question USING(subject_id) 
WHERE 
  attempt_id = (
    SELECT 
      MAX(attempt_id) 
    FROM 
      attempt
  ) 
ORDER BY 
  RAND() 
LIMIT 
  3;
SELECT 
  * 
FROM 
  testing;
```

üîé `–†–ï–ó–£–õ–¨–¢–ê–¢` ‚§µÔ∏è

| testing_id | attempt_id | question_id | answer_id |
|:---------------:|:---------------:|:---------------:|:---------------:|
| 1          | 1          | 9           | 25        |
| 2          | 1          | 7           | 19        |
| 3          | 1          | 6           | 17        |
| 4          | 2          | 3           | 9         |
| 5          | 2          | 1           | 2         |
| 6          | 2          | 4           | 11        |
| 7          | 3          | 6           | 18        |
| 8          | 3          | 8           | 24        |
| 9          | 3          | 9           | 28        |
| 10         | 4          | 1           | 2         |
| 11         | 4          | 5           | 16        |
| 12         | 4          | 3           | 10        |
| 13         | 5          | 2           | 6         |
| 14         | 5          | 1           | 2         |
| 15         | 5          | 4           | 12        |
| 16         | 6          | 6           | 17        |
| 17         | 6          | 8           | 22        |
| 18         | 6          | 7           | 21        |
| 19         | 7          | 1           | 3         |
| 20         | 7          | 4           | 11        |
| 21         | 7          | 5           | 16        |
| 22         | 8          | 7           | NULL      |
| 23         | 8          | 8           | NULL      |
| 24         | 8          | 9           | NULL      |

---

‚ú≥ –®–∞–≥ 4. 

‚ùì*–ó–∞–¥–∞–Ω–∏–µ. –°—Ç—É–¥–µ–Ω—Ç –ø—Ä–æ—à–µ–ª —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ (—Ç–æ –µ—Å—Ç—å –≤—Å–µ –µ–≥–æ –æ—Ç–≤–µ—Ç—ã –∑–∞–Ω–µ—Å–µ–Ω—ã –≤ —Ç–∞–±–ª–∏—Ü—É testing), –¥–∞–ª–µ–µ –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ –≤—ã—á–∏—Å–ª–∏—Ç—å —Ä–µ–∑—É–ª—å—Ç–∞—Ç(–∑–∞–ø—Ä–æ—Å) –∏ –∑–∞–Ω–µ—Å—Ç–∏ –µ–≥–æ –≤ —Ç–∞–±–ª–∏—Ü—É attempt –¥–ª—è —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤—É—é—â–µ–π –ø–æ–ø—ã—Ç–∫–∏.  –†–µ–∑—É–ª—å—Ç–∞—Ç –ø–æ–ø—ã—Ç–∫–∏ –≤—ã—á–∏—Å–ª–∏—Ç—å –∫–∞–∫ –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –ø—Ä–∞–≤–∏–ª—å–Ω—ã—Ö –æ—Ç–≤–µ—Ç–æ–≤, –¥–µ–ª–µ–Ω–Ω–æ–µ –Ω–∞ 3 (–∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –≤–æ–ø—Ä–æ—Å–æ–≤ –≤ –∫–∞–∂–¥–æ–π –ø–æ–ø—ã—Ç–∫–µ) –∏ —É–º–Ω–æ–∂–µ–Ω–Ω–æ–µ –Ω–∞ 100. –†–µ–∑—É–ª—å—Ç–∞—Ç –æ–∫—Ä—É–≥–ª–∏—Ç—å –¥–æ —Ü–µ–ª–æ–≥–æ.  
–ë—É–¥–µ–º —Å—á–∏—Ç–∞—Ç—å, —á—Ç–æ –º—ã –∑–Ω–∞–µ–º id –ø–æ–ø—ã—Ç–∫–∏,  –¥–ª—è –∫–æ—Ç–æ—Ä–æ–π –≤—ã—á–∏—Å–ª—è–µ—Ç—Å—è —Ä–µ–∑—É–ª—å—Ç–∞—Ç, –≤ –Ω–∞—à–µ–º —Å–ª—É—á–∞–µ —ç—Ç–æ 8. –í —Ç–∞–±–ª–∏—Ü—É testing –∑–∞–Ω–µ—Å–µ–Ω—ã —Å–ª–µ–¥—É—é—â–∏–µ –æ—Ç–≤–µ—Ç—ã –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è:*

| testing_id | attempt_id | question_id | answer_id |
|:---------------:|:---------------:|:---------------:|:---------------:|
| 22         | 8          | 7           | 19        |
| 23         | 8          | 6           | 17        |
| 24         | 8          | 8           | 22        |

*–§—Ä–∞–≥–º–µ–Ω—Ç –ª–æ–≥–∏—á–µ—Å–∫–æ–π —Å—Ö–µ–º—ã –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö:*

![](https://ucarecdn.com/3d63945a-d5c5-44c8-a3c3-0c44479f7f30/)

*–ö–æ—Ä—Ä–µ–∫—Ç–∏—Ä—É–µ–º–∞—è —Ç–∞–±–ª–∏—Ü–∞:*

![](https://ucarecdn.com/d1382132-e039-43a2-8cba-30c5f195e4b6/)

*–ù–∞–ø–æ–ª–Ω–µ–Ω–∏–µ —Ç–∞–±–ª–∏—Ü answer, attempt, testing(–ø–µ—Ä–µ–¥ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏–µ–º —à–∞–≥–∞):*

*—Ç–∞–±–ª–∏—Ü–∞ answer*    

| answer_id | name_answer                                            | question_id | is_correct |
|:---------------:|:---------------:|:---------------:|:---------------:|
| 1         | UPDATE                                                 | 1           | 0          |
| 2         | SELECT                                                 | 1           | 1          |
| 3         | INSERT                                                 | 1           | 0          |
| 4         | GROUP BY                                               | 2           | 0          |
| 5         | FROM                                                   | 2           | 0          |
| 6         | WHERE                                                  | 2           | 1          |
| 7         | SELECT                                                 | 2           | 0          |
| 8         | SORT                                                   | 3           | 0          |
| 9         | ORDER BY                                               | 3           | 1          |
| 10        | RANG BY                                                | 3           | 0          |
| 11        | SELECT * FROM student                                  | 4           | 1          |
| 12        | SELECT student                                         | 4           | 0          |
| 13        | INNER JOIN                                             | 5           | 1          |
| 14        | LEFT JOIN                                              | 5           | 0          |
| 15        | RIGHT JOIN                                             | 5           | 0          |
| 16        | CROSS JOIN                                             | 5           | 0          |
| 17        | —Å–æ–≤–æ–∫—É–ø–Ω–æ—Å—Ç—å –¥–∞–Ω–Ω—ã—Ö, –æ—Ä–≥–∞–Ω–∏–∑–æ–≤–∞–Ω–Ω—ã—Ö–ø–æ –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–Ω—ã–º...  | 6           | 1          |
| 18        | —Å–æ–≤–æ–∫—É–ø–Ω–æ—Å—Ç—å –ø—Ä–æ–≥—Ä–∞–º–º –¥–ª—è —Ö—Ä–∞–Ω–µ–Ω–∏—è –∏–æ–±—Ä–∞–±–æ—Ç–∫–∏ ...      | 6           | 0          |
| 19        | —Å—Ç—Ä–æ–∫–∞                                                 | 7           | 0          |
| 20        | —Å—Ç–æ–ª–±–µ—Ü                                                | 7           | 0          |
| 21        | —Ç–∞–±–ª–∏—Ü–∞                                                | 7           | 1          |
| 22        | –æ–±–æ–±—â–µ–Ω–Ω–æ–µ –ø—Ä–µ–¥—Å—Ç–∞–≤–ª–µ–Ω–∏–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π –æ –¥–∞–Ω–Ω—ã—Ö        | 8           | 1          |
| 23        | –æ–ø–∏—Å–∞–Ω–∏–µ –ø—Ä–µ–¥—Å—Ç–∞–≤–ª–µ–Ω–∏—è –¥–∞–Ω–Ω—ã—Ö –≤ –ø–∞–º—è—Ç–∏ –∫–æ–º–ø—å—é—Ç–µ—Ä–∞      | 8           | 0          |
| 24        | –±–∞–∑–∞ –¥–∞–Ω–Ω—ã—Ö                                            | 8           | 0          |
| 25        | file                                                   | 9           | 1          |
| 26        | INT                                                    | 9           | 0          |
| 27        | VARCHAR                                                | 9           | 0          |
| 28        | DATE                                                   | 9           | 0          |

*—Ç–∞–±–ª–∏—Ü–∞ attempt*

| attempt_id | student_id | subject_id | date_attempt | result |
|:---------------:|:---------------:|:---------------:|:---------------:|:---------------:|
| 1          | 1          | 2          | 2020-03-23   | 67     |
| 2          | 3          | 1          | 2020-03-23   | 100    |
| 3          | 4          | 2          | 2020-03-26   | 0      |
| 4          | 1          | 1          | 2020-04-15   | 33     |
| 5          | 3          | 1          | 2020-04-15   | 67     |
| 6          | 4          | 2          | 2020-04-21   | 100    |
| 7          | 3          | 1          | 2020-05-17   | 33     |
| 8          | 1          | 2          | 2020-06-12   | NULL   |

*—Ç–∞–±–ª–∏—Ü–∞ testing*

| testing_id | attempt_id | question_id | answer_id |
|:---------------:|:---------------:|:---------------:|:---------------:|
| 1          | 1          | 9           | 25        |
| 2          | 1          | 7           | 19        |
| 3          | 1          | 6           | 17        |
| 4          | 2          | 3           | 9         |
| 5          | 2          | 1           | 2         |
| 6          | 2          | 4           | 11        |
| 7          | 3          | 6           | 18        |
| 8          | 3          | 8           | 24        |
| 9          | 3          | 9           | 28        |
| 10         | 4          | 1           | 2         |
| 11         | 4          | 5           | 16        |
| 12         | 4          | 3           | 10        |
| 13         | 5          | 2           | 6         |
| 14         | 5          | 1           | 2         |
| 15         | 5          | 4           | 12        |
| 16         | 6          | 6           | 17        |
| 17         | 6          | 8           | 22        |
| 18         | 6          | 7           | 21        |
| 19         | 7          | 1           | 3         |
| 20         | 7          | 4           | 11        |
| 21         | 7          | 5           | 16        |
| 22         | 8          | 7           | 19        |
| 23         | 8          | 6           | 17        |
| 24         | 8          | 8           | 22        |

‚úî`–†–ï–®–ï–ù–ò–ï` ‚§µÔ∏è

```sql
UPDATE 
  attempt 
SET 
  result = (
    SELECT 
      ROUND(
        SUM(is_correct)/ 3 * 100, 
        0
      ) 
    FROM 
      answer 
      JOIN testing USING(answer_id) 
    WHERE 
      attempt_id = 8
  ) 
WHERE 
  attempt_id = 8;
SELECT 
  * 
FROM 
  attempt;
```

üîé `–†–ï–ó–£–õ–¨–¢–ê–¢` ‚§µÔ∏è

| attempt_id | student_id | subject_id | date_attempt | result |
|:---------------:|:---------------:|:---------------:|:---------------:|:---------------:|
| 1          | 1          | 2          | 2020-03-23   | 67     |
| 2          | 3          | 1          | 2020-03-23   | 100    |
| 3          | 4          | 2          | 2020-03-26   | 0      |
| 4          | 1          | 1          | 2020-04-15   | 33     |
| 5          | 3          | 1          | 2020-04-15   | 67     |
| 6          | 4          | 2          | 2020-04-21   | 100    |
| 7          | 3          | 1          | 2020-05-17   | 33     |
| 8          | 1          | 2          | 2020-06-12   | 67     |

---

‚ú≥ –®–∞–≥ 5. 

‚ùì*–ó–∞–¥–∞–Ω–∏–µ. –£–¥–∞–ª–∏—Ç—å –∏–∑ —Ç–∞–±–ª–∏—Ü—ã attempt –≤—Å–µ –ø–æ–ø—ã—Ç–∫–∏, –≤—ã–ø–æ–ª–Ω–µ–Ω–Ω—ã–µ —Ä–∞–Ω—å—à–µ 1 –º–∞—è 2020 –≥–æ–¥–∞. –¢–∞–∫–∂–µ —É–¥–∞–ª–∏—Ç—å –∏ –≤—Å–µ —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤—É—é—â–∏–µ —ç—Ç–∏–º –ø–æ–ø—ã—Ç–∫–∞–º –≤–æ–ø—Ä–æ—Å—ã –∏–∑ —Ç–∞–±–ª–∏—Ü—ã testing, –∫–æ—Ç–æ—Ä–∞—è —Å–æ–∑–¥–∞–≤–∞–ª–∞—Å—å —Å–ª–µ–¥—É—é—â–∏–º –∑–∞–ø—Ä–æ—Å–æ–º:*

```sql
CREATE TABLE testing (
    testing_id INT PRIMARY KEY AUTO_INCREMENT, 
    attempt_id INT, 
    question_id INT, 
    answer_id INT,
    FOREIGN KEY (attempt_id)  REFERENCES attempt (attempt_id) ON DELETE CASCADE
);
```

*–§—Ä–∞–≥–º–µ–Ω—Ç –ª–æ–≥–∏—á–µ—Å–∫–æ–π —Å—Ö–µ–º—ã –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö:*

![](https://ucarecdn.com/a474d45f-603e-4c75-b581-8d6cdceabbd7/)

*–ù–∞–ø–æ–ª–Ω–µ–Ω–∏–µ —Ç–∞–±–ª–∏—Ü attempt, testing(–ø–µ—Ä–µ–¥ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏–µ–º —à–∞–≥–∞):*

*—Ç–∞–±–ª–∏—Ü–∞ attempt*

| attempt_id | student_id | subject_id | date_attempt | result |
|:---------------:|:---------------:|:---------------:|:---------------:|:---------------:|
| 1          | 1          | 2          | 2020-03-23   | 67     |
| 2          | 3          | 1          | 2020-03-23   | 100    |
| 3          | 4          | 2          | 2020-03-26   | 0      |
| 4          | 1          | 1          | 2020-04-15   | 33     |
| 5          | 3          | 1          | 2020-04-15   | 67     |
| 6          | 4          | 2          | 2020-04-21   | 100    |
| 7          | 3          | 1          | 2020-05-17   | 33     |
| 8          | 1          | 2          | 2020-06-12   | 67     |

*—Ç–∞–±–ª–∏—Ü–∞ testing*

| testing_id | attempt_id | question_id | answer_id |
|:---------------:|:---------------:|:---------------:|:---------------:|
| 1          | 1          | 9           | 25        |
| 2          | 1          | 7           | 19        |
| 3          | 1          | 6           | 17        |
| 4          | 2          | 3           | 9         |
| 5          | 2          | 1           | 2         |
| 6          | 2          | 4           | 11        |
| 7          | 3          | 6           | 18        |
| 8          | 3          | 8           | 24        |
| 9          | 3          | 9           | 28        |
| 10         | 4          | 1           | 2         |
| 11         | 4          | 5           | 16        |
| 12         | 4          | 3           | 10        |
| 13         | 5          | 2           | 6         |
| 14         | 5          | 1           | 2         |
| 15         | 5          | 4           | 12        |
| 16         | 6          | 6           | 17        |
| 17         | 6          | 8           | 22        |
| 18         | 6          | 7           | 21        |
| 19         | 7          | 1           | 3         |
| 20         | 7          | 4           | 11        |
| 21         | 7          | 5           | 16        |
| 22         | 8          | 7           | 19        |
| 23         | 8          | 6           | 17        |
| 24         | 8          | 8           | 22        |

‚úî`–†–ï–®–ï–ù–ò–ï` ‚§µÔ∏è

```sql
DELETE FROM 
  attempt 
WHERE 
  date_attempt < "2020-05-01";
SELECT 
  * 
FROM 
  attempt;
SELECT 
  * 
FROM 
  testing;
```

üîé `–†–ï–ó–£–õ–¨–¢–ê–¢` ‚§µÔ∏è

| attempt_id | student_id | subject_id | date_attempt | result |
|:---------------:|:---------------:|:---------------:|:---------------:|:---------------:|
| 7          | 3          | 1          | 2020-05-17   | 33     |
| 8          | 1          | 2          | 2020-06-12   | 67     |

| testing_id | attempt_id | question_id | answer_id |
|:---------------:|:---------------:|:---------------:|:---------------:|
| 19         | 7          | 1           | 3         |
| 20         | 7          | 4           | 11        |
| 21         | 7          | 5           | 16        |
| 22         | 8          | 7           | 19        |
| 23         | 8          | 6           | 17        |
| 24         | 8          | 8           | 22        |

---

## 3.3 –ë–∞–∑–∞ –¥–∞–Ω–Ω—ã—Ö ¬´–ê–±–∏—Ç—É—Ä–∏–µ–Ω—Ç¬ª, –∑–∞–ø—Ä–æ—Å—ã –Ω–∞ –≤—ã–±–æ—Ä–∫—É

–£–Ω–∏–≤–µ—Ä—Å–∏—Ç–µ—Ç —Å–æ—Å—Ç–æ–∏—Ç –∏–∑ —Å–æ–≤–æ–∫—É–ø–Ω–æ—Å—Ç–∏ —Ñ–∞–∫—É–ª—å—Ç–µ—Ç–æ–≤ (—à–∫–æ–ª). –ü–æ—Å—Ç—É–ø–ª–µ–Ω–∏–µ –∞–±–∏—Ç—É—Ä–∏–µ–Ω—Ç–æ–≤ –æ—Å—É—â–µ—Å—Ç–≤–ª—è–µ—Ç—Å—è –Ω–∞ –æ–±—Ä–∞–∑–æ–≤–∞—Ç–µ–ª—å–Ω—ã–µ –ø—Ä–æ–≥—Ä–∞–º–º—ã –ø–æ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–∞–º –ï–¥–∏–Ω–æ–≥–æ –≥–æ—Å—É–¥–∞—Ä—Å—Ç–≤–µ–Ω–Ω–æ–≥–æ —ç–∫–∑–∞–º–µ–Ω–∞ (–ï–ì–≠). –ö–∞–∂–¥–∞—è –æ–±—Ä–∞–∑–æ–≤–∞—Ç–µ–ª—å–Ω–∞—è –ø—Ä–æ–≥—Ä–∞–º–º–∞ –æ—Ç–Ω–æ—Å–∏—Ç—Å—è –∫ –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–Ω–æ–º—É —Ñ–∞–∫—É–ª—å—Ç–µ—Ç—É, –¥–ª—è –Ω–µ–µ –æ–ø—Ä–µ–¥–µ–ª–µ–Ω—ã –Ω–µ–æ–±—Ö–æ–¥–∏–º—ã–µ –¥–ª—è –ø–æ—Å—Ç—É–ø–ª–µ–Ω–∏—è –ø—Ä–µ–¥–º–µ—Ç—ã –ï–ì–≠, –º–∏–Ω–∏–º–∞–ª—å–Ω—ã–π –±–∞–ª–ª –ø–æ —ç—Ç–∏–º –ø—Ä–µ–¥–º–µ—Ç–∞–º, –∞ —Ç–∞–∫–∂–µ –ø–ª–∞–Ω –Ω–∞–±–æ—Ä–∞ (–∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –º–µ—Å—Ç) –Ω–∞ –æ–±—Ä–∞–∑–æ–≤–∞—Ç–µ–ª—å–Ω—É—é –ø—Ä–æ–≥—Ä–∞–º–º—É.

–í –ø—Ä–∏–µ–º–Ω—É—é –∫–æ–º–∏—Å—Å–∏—é –∞–±–∏—Ç—É—Ä–∏–µ–Ω—Ç—ã –ø–æ–¥–∞—é—Ç –∑–∞—è–≤–ª–µ–Ω–∏—è –Ω–∞ –æ–±—Ä–∞–∑–æ–≤–∞—Ç–µ–ª—å–Ω—É—é –ø—Ä–æ–≥—Ä–∞–º–º—É, –∫–∞–∂–¥—ã–π –∞–±–∏—Ç—É—Ä–∏–µ–Ω—Ç –º–æ–∂–µ—Ç –≤—ã–±—Ä–∞—Ç—å –Ω–µ—Å–∫–æ–ª—å–∫–æ –æ–±—Ä–∞–∑–æ–≤–∞—Ç–µ–ª—å–Ω—ã—Ö –ø—Ä–æ–≥—Ä–∞–º–º (–Ω–æ –Ω–µ –±–æ–ª–µ–µ —Ç—Ä–µ—Ö). –í –∑–∞—è–≤–ª–µ–Ω–∏–∏ —É–∫–∞–∑—ã–≤–∞–µ—Ç—Å—è —Ñ–∞–º–∏–ª–∏—è, –∏–º—è, –æ—Ç—á–µ—Å—Ç–≤–æ –∞–±–∏—Ç—É—Ä–∏–µ–Ω—Ç–∞, –∞ —Ç–∞–∫–∂–µ –µ–≥–æ –¥–æ—Å—Ç–∏–∂–µ–Ω–∏—è: –ø–æ–ª—É—á–∏–ª –ª–∏ –æ–Ω –º–µ–¥–∞–ª—å –∑–∞ –æ–±—É—á–µ–Ω–∏–µ –≤ —à–∫–æ–ª–µ, –∏–º–µ–µ—Ç –ª–∏ –∑–Ω–∞—á–æ–∫ –ì–¢–û –∏ –ø—Ä. –ü—Ä–∏ —ç—Ç–æ–º –∑–∞ –∫–∞–∂–¥–æ–µ –¥–æ—Å—Ç–∏–∂–µ–Ω–∏–µ –æ–ø—Ä–µ–¥–µ–ª–µ–Ω –¥–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–π –±–∞–ª–ª. –ê–±–∏—Ç—É—Ä–∏–µ–Ω—Ç –ø—Ä–µ–¥–æ—Å—Ç–∞–≤–ª—è–µ—Ç —Å–µ—Ä—Ç–∏—Ñ–∏–∫–∞—Ç —Å —Ä–µ–∑—É–ª—å—Ç–∞—Ç–∞–º–∏ —Å–¥–∞—á–∏  –ï–ì–≠. –ï—Å–ª–∏ –∞–±–∏—Ç—É—Ä–∏–µ–Ω—Ç –≤—ã–±–∏—Ä–∞–µ—Ç –æ–±—Ä–∞–∑–æ–≤–∞—Ç–µ–ª—å–Ω—É—é –ø—Ä–æ–≥—Ä–∞–º–º—É, —Ç–æ —É –Ω–µ–≥–æ –æ–±—è–∑–∞—Ç–µ–ª—å–Ω–æ –¥–æ–ª–∂–Ω—ã –±—ã—Ç—å —Å–¥–∞–Ω—ã –ø—Ä–µ–¥–º–µ—Ç—ã, –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–Ω—ã–µ –Ω–∞ —ç—Ç—É –ø—Ä–æ–≥—Ä–∞–º–º—É, –ø—Ä–∏—á–µ–º –±–∞–ª–ª –¥–æ–ª–∂–µ–Ω –±—ã—Ç—å –Ω–µ –º–µ–Ω—å—à–µ –º–∏–Ω–∏–º–∞–ª—å–Ω–æ–≥–æ –ø–æ –¥–∞–Ω–Ω–æ–º—É –ø—Ä–µ–¥–º–µ—Ç—É.

–ó–∞—á–∏—Å–ª–µ–Ω–∏–µ –∞–±–∏—Ç—É—Ä–∏–µ–Ω—Ç–æ–≤ –æ—Å—É—â–µ—Å—Ç–≤–ª—è–µ—Ç—Å—è —Ç–∞–∫: —Å–Ω–∞—á–∞–ª–∞ –≤—ã—á–∏—Å–ª—è–µ—Ç—Å—è —Å—É–º–º–∞ –±–∞–ª–ª–æ–≤ –ø–æ –ø—Ä–µ–¥–º–µ—Ç–∞–º –Ω–∞ –∫–∞–∂–¥—É—é –æ–±—Ä–∞–∑–æ–≤–∞—Ç–µ–ª—å–Ω—É—é –ø—Ä–æ–≥—Ä–∞–º–º—É, –¥–æ–±–∞–≤–ª—è—é—Ç—Å—è –±–∞–ª–ª—ã –¥–æ—Å—Ç–∏–∂–µ–Ω–∏—è, –∑–∞—Ç–µ–º –∞–±–∏—Ç—É—Ä–∏–µ–Ω—Ç—ã —Å–æ—Ä—Ç–∏—Ä—É—é—Ç—Å—è –≤ –ø–æ—Ä—è–¥–∫–µ —É–±—ã–≤–∞–Ω–∏—è —Å—É–º–º—ã –±–∞–ª–ª–æ–≤ –∏ –æ—Ç–±–∏—Ä–∞—é—Ç—Å—è –ø–µ—Ä–≤—ã–µ –ø–æ –∫–æ–ª–∏—á–µ—Å—Ç–≤—É –º–µ—Å—Ç, –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–Ω–æ–º—É –ø–ª–∞–Ω–æ–º –Ω–∞–±–æ—Ä–∞.

–ö–æ–Ω—Ü–µ–ø—Ç—É–∞–ª—å–Ω–∞—è —Å—Ö–µ–º–∞ –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö:

![](https://ucarecdn.com/b39b62db-8870-428b-a279-e5e0d5241195/)

–õ–æ–≥–∏—á–µ—Å–∫–∞—è —Å—Ö–µ–º–∞ –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö:

![](https://ucarecdn.com/12fe86b0-6e53-4d8b-ba52-64f48d692adb/)

‚ú≥ –®–∞–≥ 2. 

‚ùì*–ó–∞–¥–∞–Ω–∏–µ. –í—ã–≤–µ—Å—Ç–∏ –∞–±–∏—Ç—É—Ä–∏–µ–Ω—Ç–æ–≤, –∫–æ—Ç–æ—Ä—ã–µ —Ö–æ—Ç—è—Ç –ø–æ—Å—Ç—É–ø–∞—Ç—å –Ω–∞ –æ–±—Ä–∞–∑–æ–≤–∞—Ç–µ–ª—å–Ω—É—é –ø—Ä–æ–≥—Ä–∞–º–º—É ¬´–ú–µ—Ö–∞—Ç—Ä–æ–Ω–∏–∫–∞ –∏ —Ä–æ–±–æ—Ç–æ—Ç–µ—Ö–Ω–∏–∫–∞¬ª –≤ –æ—Ç—Å–æ—Ä—Ç–∏—Ä–æ–≤–∞–Ω–Ω–æ–º –ø–æ —Ñ–∞–º–∏–ª–∏—è–º –≤–∏–¥–µ.*

*–§—Ä–∞–≥–º–µ–Ω—Ç –ª–æ–≥–∏—á–µ—Å–∫–æ–π —Å—Ö–µ–º—ã –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö:*

![](https://ucarecdn.com/5bafc977-00f6-4709-80b1-1ff175681d19/)

*–ù–∞–ø–æ–ª–Ω–µ–Ω–∏–µ —Ç–∞–±–ª–∏—Ü program, enrollee, program_enrollee:*

*—Ç–∞–±–ª–∏—Ü–∞ program*

| program_id | name_program                        | department_id | plan |
|:---------------:|:---------------:|:---------------:|:---------------:|
| 1          | –ü—Ä–∏–∫–ª–∞–¥–Ω–∞—è –º–∞—Ç–µ–º–∞—Ç–∏–∫–∞ –∏ –∏–Ω—Ñ–æ—Ä–º–∞—Ç–∏–∫–∞ | 2             | 2    |
| 2          | –ú–∞—Ç–µ–º–∞—Ç–∏–∫–∞ –∏ –∫–æ–º–ø—å—é—Ç–µ—Ä–Ω—ã–µ –Ω–∞—É–∫–∏     | 2             | 1    |
| 3          | –ü—Ä–∏–∫–ª–∞–¥–Ω–∞—è –º–µ—Ö–∞–Ω–∏–∫–∞                 | 1             | 2    |
| 4          | –ú–µ—Ö–∞—Ç—Ä–æ–Ω–∏–∫–∞ –∏ —Ä–æ–±–æ—Ç–æ—Ç–µ—Ö–Ω–∏–∫–∞         | 1             | 3    |

*—Ç–∞–±–ª–∏—Ü–∞ enrollee*

| enrollee_id | name_enrollee   |
|:---------------:|:---------------:|
| 1           | –ë–∞—Ä–∞–Ω–æ–≤ –ü–∞–≤–µ–ª   |
| 2           | –ê–±—Ä–∞–º–æ–≤–∞ –ö–∞—Ç—è   |
| 3           | –°–µ–º–µ–Ω–æ–≤ –ò–≤–∞–Ω    |
| 4           | –Ø–∫–æ–≤–ª–µ–≤–∞ –ì–∞–ª–∏–Ω–∞ |
| 5           | –ü–æ–ø–æ–≤ –ò–ª—å—è      |
| 6           | –°—Ç–µ–ø–∞–Ω–æ–≤–∞ –î–∞—Ä—å—è |

*—Ç–∞–±–ª–∏—Ü–∞ program_enrollee*

| program_enrollee_id | program_id | enrollee_id |
|:---------------:|:---------------:|:---------------:|
| 1                   | 3          | 1           |
| 2                   | 4          | 1           |
| 3                   | 1          | 1           |
| 4                   | 2          | 2           |
| 5                   | 1          | 2           |
| 6                   | 1          | 3           |
| 7                   | 2          | 3           |
| 8                   | 4          | 3           |
| 9                   | 3          | 4           |
| 10                  | 3          | 5           |
| 11                  | 4          | 5           |
| 12                  | 2          | 6           |
| 13                  | 3          | 6           |
| 14                  | 4          | 6           |

‚úî`–†–ï–®–ï–ù–ò–ï` ‚§µÔ∏è

```sql
SELECT 
  name_enrollee 
FROM 
  enrollee 
  JOIN program_enrollee USING(enrollee_id) 
  JOIN program USING(program_id) 
WHERE 
  name_program = '–ú–µ—Ö–∞—Ç—Ä–æ–Ω–∏–∫–∞ –∏ —Ä–æ–±–æ—Ç–æ—Ç–µ—Ö–Ω–∏–∫–∞' 
ORDER BY 
  1;
```

üîé `–†–ï–ó–£–õ–¨–¢–ê–¢` ‚§µÔ∏è

| name_enrollee   |
|:---------------:|
| –ë–∞—Ä–∞–Ω–æ–≤ –ü–∞–≤–µ–ª   |
| –ü–æ–ø–æ–≤ –ò–ª—å—è      |
| –°–µ–º–µ–Ω–æ–≤ –ò–≤–∞–Ω    |
| –°—Ç–µ–ø–∞–Ω–æ–≤–∞ –î–∞—Ä—å—è |

---

‚ú≥ –®–∞–≥ 3. 

‚ùì*–ó–∞–¥–∞–Ω–∏–µ. –í—ã–≤–µ—Å—Ç–∏ –æ–±—Ä–∞–∑–æ–≤–∞—Ç–µ–ª—å–Ω—ã–µ –ø—Ä–æ–≥—Ä–∞–º–º—ã, –Ω–∞ –∫–æ—Ç–æ—Ä—ã–µ –¥–ª—è –ø–æ—Å—Ç—É–ø–ª–µ–Ω–∏—è –Ω–µ–æ–±—Ö–æ–¥–∏–º –ø—Ä–µ–¥–º–µ—Ç ¬´–ò–Ω—Ñ–æ—Ä–º–∞—Ç–∏–∫–∞¬ª. –ü—Ä–æ–≥—Ä–∞–º–º—ã –æ—Ç—Å–æ—Ä—Ç–∏—Ä–æ–≤–∞—Ç—å –≤ –æ–±—Ä–∞—Ç–Ω–æ–º –∞–ª—Ñ–∞–≤–∏—Ç–Ω–æ–º –ø–æ—Ä—è–¥–∫–µ.*

*–§—Ä–∞–≥–º–µ–Ω—Ç –ª–æ–≥–∏—á–µ—Å–∫–æ–π —Å—Ö–µ–º—ã –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö:*

![](https://ucarecdn.com/8b1f2861-3ed6-4533-9ed0-10fde1ec0f92/)

*–ù–∞–ø–æ–ª–Ω–µ–Ω–∏–µ —Ç–∞–±–ª–∏—Ü program, subject, program_subject:*

*—Ç–∞–±–ª–∏—Ü–∞ program*

| program_id | name_program                        | department_id | plan |
|:---------------:|:---------------:|:---------------:|:---------------:|
| 1          | –ü—Ä–∏–∫–ª–∞–¥–Ω–∞—è –º–∞—Ç–µ–º–∞—Ç–∏–∫–∞ –∏ –∏–Ω—Ñ–æ—Ä–º–∞—Ç–∏–∫–∞ | 2             | 2    |
| 2          | –ú–∞—Ç–µ–º–∞—Ç–∏–∫–∞ –∏ –∫–æ–º–ø—å—é—Ç–µ—Ä–Ω—ã–µ –Ω–∞—É–∫–∏     | 2             | 1    |
| 3          | –ü—Ä–∏–∫–ª–∞–¥–Ω–∞—è –º–µ—Ö–∞–Ω–∏–∫–∞                 | 1             | 2    |
| 4          | –ú–µ—Ö–∞—Ç—Ä–æ–Ω–∏–∫–∞ –∏ —Ä–æ–±–æ—Ç–æ—Ç–µ—Ö–Ω–∏–∫–∞         | 1             | 3    |

*—Ç–∞–±–ª–∏—Ü–∞ subject*

| subject_id | name_subject |
|:---------------:|:---------------:|
| 1          | –†—É—Å—Å–∫–∏–π —è–∑—ã–∫ |
| 2          | –ú–∞—Ç–µ–º–∞—Ç–∏–∫–∞   |
| 3          | –§–∏–∑–∏–∫–∞       |
| 4          | –ò–Ω—Ñ–æ—Ä–º–∞—Ç–∏–∫–∞  |

*—Ç–∞–±–ª–∏—Ü–∞ program_subject*

| program_subject_id | program_id | subject_id | min_result |
|:---------------:|:---------------:|:---------------:|:---------------:|
| 1                  | 1          | 1          | 40         |
| 2                  | 1          | 2          | 50         |
| 3                  | 1          | 4          | 60         |
| 4                  | 2          | 1          | 30         |
| 5                  | 2          | 2          | 50         |
| 6                  | 2          | 4          | 60         |
| 7                  | 3          | 1          | 30         |
| 8                  | 3          | 2          | 45         |
| 9                  | 3          | 3          | 45         |
| 10                 | 4          | 1          | 40         |
| 11                 | 4          | 2          | 45         |
| 12                 | 4          | 3          | 45         |

‚úî`–†–ï–®–ï–ù–ò–ï` ‚§µÔ∏è

```sql
SELECT 
  name_program 
FROM 
  program 
  JOIN program_subject USING(program_id) 
  JOIN subject USING(subject_id) 
WHERE 
  name_subject = '–ò–Ω—Ñ–æ—Ä–º–∞—Ç–∏–∫–∞' 
ORDER BY 
  1 DESC;
```

üîé `–†–ï–ó–£–õ–¨–¢–ê–¢` ‚§µÔ∏è

| name_program                        |
|:---------------:|
| –ü—Ä–∏–∫–ª–∞–¥–Ω–∞—è –º–∞—Ç–µ–º–∞—Ç–∏–∫–∞ –∏ –∏–Ω—Ñ–æ—Ä–º–∞—Ç–∏–∫–∞ |
| –ú–∞—Ç–µ–º–∞—Ç–∏–∫–∞ –∏ –∫–æ–º–ø—å—é—Ç–µ—Ä–Ω—ã–µ –Ω–∞—É–∫–∏     |

---

‚ú≥ –®–∞–≥ 4. 

‚ùì*–ó–∞–¥–∞–Ω–∏–µ. –í—ã–≤–µ–¥–∏—Ç–µ –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –∞–±–∏—Ç—É—Ä–∏–µ–Ω—Ç–æ–≤, —Å–¥–∞–≤—à–∏—Ö –ï–ì–≠ –ø–æ –∫–∞–∂–¥–æ–º—É –ø—Ä–µ–¥–º–µ—Ç—É, –º–∞–∫—Å–∏–º–∞–ª—å–Ω–æ–µ, –º–∏–Ω–∏–º–∞–ª—å–Ω–æ–µ –∏ —Å—Ä–µ–¥–Ω–µ–µ –∑–Ω–∞—á–µ–Ω–∏–µ –±–∞–ª–ª–æ–≤ –ø–æ –ø—Ä–µ–¥–º–µ—Ç—É –ï–ì–≠. –í—ã—á–∏—Å–ª—è–µ–º—ã–µ —Å—Ç–æ–ª–±—Ü—ã –Ω–∞–∑–≤–∞—Ç—å –ö–æ–ª–∏—á–µ—Å—Ç–≤–æ, –ú–∞–∫—Å–∏–º—É–º, –ú–∏–Ω–∏–º—É–º, –°—Ä–µ–¥–Ω–µ–µ. –ò–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é –æ—Ç—Å–æ—Ä—Ç–∏—Ä–æ–≤–∞—Ç—å –ø–æ –Ω–∞–∑–≤–∞–Ω–∏—é –ø—Ä–µ–¥–º–µ—Ç–∞ –≤ –∞–ª—Ñ–∞–≤–∏—Ç–Ω–æ–º –ø–æ—Ä—è–¥–∫–µ, —Å—Ä–µ–¥–Ω–µ–µ –∑–Ω–∞—á–µ–Ω–∏–µ –æ–∫—Ä—É–≥–ª–∏—Ç—å –¥–æ –æ–¥–Ω–æ–≥–æ –∑–Ω–∞–∫–∞ –ø–æ—Å–ª–µ –∑–∞–ø—è—Ç–æ–π.*

*–§—Ä–∞–≥–º–µ–Ω—Ç –ª–æ–≥–∏—á–µ—Å–∫–æ–π —Å—Ö–µ–º—ã –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö:*

![](https://ucarecdn.com/b519096f-729d-43ef-b4b2-a752f8169843/)

*–ù–∞–ø–æ–ª–Ω–µ–Ω–∏–µ —Ç–∞–±–ª–∏—Ü subject, enrollee_subject:*

*—Ç–∞–±–ª–∏—Ü–∞ subject*

| subject_id | name_subject |
|:---------------:|:---------------:|
| 1          | –†—É—Å—Å–∫–∏–π —è–∑—ã–∫ |
| 2          | –ú–∞—Ç–µ–º–∞—Ç–∏–∫–∞   |
| 3          | –§–∏–∑–∏–∫–∞       |
| 4          | –ò–Ω—Ñ–æ—Ä–º–∞—Ç–∏–∫–∞  |

*—Ç–∞–±–ª–∏—Ü–∞ enrollee_subject*

| enrollee_subject_id | enrollee_id | subject_id | result |
|:---------------:|:---------------:|:---------------:|:---------------:|
| 1                   | 1           | 1          | 68     |
| 2                   | 1           | 2          | 70     |
| 3                   | 1           | 3          | 41     |
| 4                   | 1           | 4          | 75     |
| 5                   | 2           | 1          | 75     |
| 6                   | 2           | 2          | 70     |
| 7                   | 2           | 4          | 81     |
| 8                   | 3           | 1          | 85     |
| 9                   | 3           | 2          | 67     |
| 10                  | 3           | 3          | 90     |
| 11                  | 3           | 4          | 78     |
| 12                  | 4           | 1          | 82     |
| 13                  | 4           | 2          | 86     |
| 14                  | 4           | 3          | 70     |
| 15                  | 5           | 1          | 65     |
| 16                  | 5           | 2          | 67     |
| 17                  | 5           | 3          | 60     |
| 18                  | 6           | 1          | 90     |
| 19                  | 6           | 2          | 92     |
| 20                  | 6           | 3          | 88     |
| 21                  | 6           | 4          | 94     |

‚úî`–†–ï–®–ï–ù–ò–ï` ‚§µÔ∏è

```sql
SELECT 
  name_subject, 
  COUNT(enrollee_id) AS –ö–æ–ª–∏—á–µ—Å—Ç–≤–æ, 
  MAX(result) AS –ú–∞–∫—Å–∏–º—É–º, 
  MIN(result) AS –ú–∏–Ω–∏–º—É–º, 
  ROUND(
    AVG(result), 
    1
  ) AS –°—Ä–µ–¥–Ω–µ–µ 
FROM 
  subject 
  JOIN enrollee_subject USING(subject_id) 
GROUP BY 
  1 
ORDER BY 
  1;
```

üîé `–†–ï–ó–£–õ–¨–¢–ê–¢` ‚§µÔ∏è

| name_subject | –ö–æ–ª–∏—á–µ—Å—Ç–≤–æ | –ú–∞–∫—Å–∏–º—É–º | –ú–∏–Ω–∏–º—É–º | –°—Ä–µ–¥–Ω–µ–µ |
|:---------------:|:---------------:|:---------------:|:---------------:|:---------------:|
| –ò–Ω—Ñ–æ—Ä–º–∞—Ç–∏–∫–∞  | 4          | 94       | 75      | 82.0    |
| –ú–∞—Ç–µ–º–∞—Ç–∏–∫–∞   | 6          | 92       | 67      | 75.3    |
| –†—É—Å—Å–∫–∏–π —è–∑—ã–∫ | 6          | 90       | 65      | 77.5    |
| –§–∏–∑–∏–∫–∞       | 5          | 90       | 41      | 69.8    |

---

‚ú≥ –®–∞–≥ 5. 

‚ùì*–ó–∞–¥–∞–Ω–∏–µ. –í—ã–≤–µ—Å—Ç–∏ –æ–±—Ä–∞–∑–æ–≤–∞—Ç–µ–ª—å–Ω—ã–µ –ø—Ä–æ–≥—Ä–∞–º–º—ã, –¥–ª—è –∫–æ—Ç–æ—Ä—ã—Ö –º–∏–Ω–∏–º–∞–ª—å–Ω—ã–π –±–∞–ª–ª –ï–ì–≠ –ø–æ –∫–∞–∂–¥–æ–º—É –ø—Ä–µ–¥–º–µ—Ç—É –±–æ–ª—å—à–µ –∏–ª–∏ —Ä–∞–≤–µ–Ω 40 –±–∞–ª–ª–∞–º. –ü—Ä–æ–≥—Ä–∞–º–º—ã –≤—ã–≤–µ—Å—Ç–∏ –≤ –æ—Ç—Å–æ—Ä—Ç–∏—Ä–æ–≤–∞–Ω–Ω–æ–º –ø–æ –∞–ª—Ñ–∞–≤–∏—Ç—É –≤–∏–¥–µ.*

*–§—Ä–∞–≥–º–µ–Ω—Ç –ª–æ–≥–∏—á–µ—Å–∫–æ–π —Å—Ö–µ–º—ã –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö:*

![](https://ucarecdn.com/c159caa8-0d39-41f8-b5bf-7ccb16669df9/)

*–ù–∞–ø–æ–ª–Ω–µ–Ω–∏–µ —Ç–∞–±–ª–∏—Ü program, program_subject:*

*—Ç–∞–±–ª–∏—Ü–∞ program*

| program_id | name_program                        | department_id | plan |
|:---------------:|:---------------:|:---------------:|:---------------:|
| 1          | –ü—Ä–∏–∫–ª–∞–¥–Ω–∞—è –º–∞—Ç–µ–º–∞—Ç–∏–∫–∞ –∏ –∏–Ω—Ñ–æ—Ä–º–∞—Ç–∏–∫–∞ | 2             | 2    |
| 2          | –ú–∞—Ç–µ–º–∞—Ç–∏–∫–∞ –∏ –∫–æ–º–ø—å—é—Ç–µ—Ä–Ω—ã–µ –Ω–∞—É–∫–∏     | 2             | 1    |
| 3          | –ü—Ä–∏–∫–ª–∞–¥–Ω–∞—è –º–µ—Ö–∞–Ω–∏–∫–∞                 | 1             | 2    |
| 4          | –ú–µ—Ö–∞—Ç—Ä–æ–Ω–∏–∫–∞ –∏ —Ä–æ–±–æ—Ç–æ—Ç–µ—Ö–Ω–∏–∫–∞         | 1             | 3    |

*—Ç–∞–±–ª–∏—Ü–∞ program_subject*

| program_subject_id | program_id | subject_id | min_result |
|:---------------:|:---------------:|:---------------:|:---------------:|
| 1                  | 1          | 1          | 40         |
| 2                  | 1          | 2          | 50         |
| 3                  | 1          | 4          | 60         |
| 4                  | 2          | 1          | 30         |
| 5                  | 2          | 2          | 50         |
| 6                  | 2          | 4          | 60         |
| 7                  | 3          | 1          | 30         |
| 8                  | 3          | 2          | 45         |
| 9                  | 3          | 3          | 45         |
| 10                 | 4          | 1          | 40         |
| 11                 | 4          | 2          | 45         |
| 12                 | 4          | 3          | 45         |

‚úî`–†–ï–®–ï–ù–ò–ï` ‚§µÔ∏è

```sql
SELECT 
  name_program 
FROM 
  program 
  JOIN program_subject USING(program_id) 
GROUP BY 
  1 
HAVING 
  MIN(min_result) >= 40 
ORDER BY 
  1;
```

üîé `–†–ï–ó–£–õ–¨–¢–ê–¢` ‚§µÔ∏è

| name_program                        |
|:---------------:|
| –ú–µ—Ö–∞—Ç—Ä–æ–Ω–∏–∫–∞ –∏ —Ä–æ–±–æ—Ç–æ—Ç–µ—Ö–Ω–∏–∫–∞         |
| –ü—Ä–∏–∫–ª–∞–¥–Ω–∞—è –º–∞—Ç–µ–º–∞—Ç–∏–∫–∞ –∏ –∏–Ω—Ñ–æ—Ä–º–∞—Ç–∏–∫–∞ |

---

‚ú≥ –®–∞–≥ 6. 

‚ùì*–ó–∞–¥–∞–Ω–∏–µ. –í—ã–≤–µ—Å—Ç–∏ –æ–±—Ä–∞–∑–æ–≤–∞—Ç–µ–ª—å–Ω—ã–µ –ø—Ä–æ–≥—Ä–∞–º–º—ã, –∫–æ—Ç–æ—Ä—ã–µ –∏–º–µ—é—Ç —Å–∞–º—ã–π –±–æ–ª—å—à–æ–π –ø–ª–∞–Ω –Ω–∞–±–æ—Ä–∞,  –≤–º–µ—Å—Ç–µ —Å —ç—Ç–æ–π –≤–µ–ª–∏—á–∏–Ω–æ–π.*

*–§—Ä–∞–≥–º–µ–Ω—Ç –ª–æ–≥–∏—á–µ—Å–∫–æ–π —Å—Ö–µ–º—ã –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö:*

![](https://ucarecdn.com/c59b5da0-f7bc-47ae-bd7d-882a3ccd84a3/)

*–ù–∞–ø–æ–ª–Ω–µ–Ω–∏–µ —Ç–∞–±–ª–∏—Ü—ã program:*

*—Ç–∞–±–ª–∏—Ü–∞ program*

| program_id | name_program                        | department_id | plan |
|:---------------:|:---------------:|:---------------:|:---------------:|
| 1          | –ü—Ä–∏–∫–ª–∞–¥–Ω–∞—è –º–∞—Ç–µ–º–∞—Ç–∏–∫–∞ –∏ –∏–Ω—Ñ–æ—Ä–º–∞—Ç–∏–∫–∞ | 2             | 2    |
| 2          | –ú–∞—Ç–µ–º–∞—Ç–∏–∫–∞ –∏ –∫–æ–º–ø—å—é—Ç–µ—Ä–Ω—ã–µ –Ω–∞—É–∫–∏     | 2             | 1    |
| 3          | –ü—Ä–∏–∫–ª–∞–¥–Ω–∞—è –º–µ—Ö–∞–Ω–∏–∫–∞                 | 1             | 2    |
| 4          | –ú–µ—Ö–∞—Ç—Ä–æ–Ω–∏–∫–∞ –∏ —Ä–æ–±–æ—Ç–æ—Ç–µ—Ö–Ω–∏–∫–∞         | 1             | 3    |

‚úî`–†–ï–®–ï–ù–ò–ï` ‚§µÔ∏è

```sql
SELECT 
  name_program, 
  plan 
FROM 
  program 
WHERE 
  plan = (
    SELECT 
      MAX(plan) 
    FROM 
      program
  );
```

üîé `–†–ï–ó–£–õ–¨–¢–ê–¢` ‚§µÔ∏è

| name_program                | plan |
|:---------------:|:---------------:|
| –ú–µ—Ö–∞—Ç—Ä–æ–Ω–∏–∫–∞ –∏ —Ä–æ–±–æ—Ç–æ—Ç–µ—Ö–Ω–∏–∫–∞ | 3    |

---

‚ú≥ –®–∞–≥ 7. 

‚ùì*–ó–∞–¥–∞–Ω–∏–µ. –ü–æ—Å—á–∏—Ç–∞—Ç—å, —Å–∫–æ–ª—å–∫–æ –¥–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã—Ö –±–∞–ª–ª–æ–≤ –ø–æ–ª—É—á–∏—Ç –∫–∞–∂–¥—ã–π –∞–±–∏—Ç—É—Ä–∏–µ–Ω—Ç. –°—Ç–æ–ª–±–µ—Ü —Å –¥–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–º–∏ –±–∞–ª–ª–∞–º–∏ –Ω–∞–∑–≤–∞—Ç—å –ë–æ–Ω—É—Å. –ò–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é –≤—ã–≤–µ—Å—Ç–∏ –≤ –æ—Ç—Å–æ—Ä—Ç–∏—Ä–æ–≤–∞–Ω–Ω–æ–º –ø–æ —Ñ–∞–º–∏–ª–∏—è–º –≤–∏–¥–µ.*

*–§—Ä–∞–≥–º–µ–Ω—Ç –ª–æ–≥–∏—á–µ—Å–∫–æ–π —Å—Ö–µ–º—ã –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö:*

![](https://ucarecdn.com/4bd9ba3f-142d-436f-9207-6512de694370/)

*–ù–∞–ø–æ–ª–Ω–µ–Ω–∏–µ —Ç–∞–±–ª–∏—Ü achievement, enrollee, enrollee_achievement:*

*—Ç–∞–±–ª–∏—Ü–∞ achievement*

| achievement_id | name_achievement      | bonus |
|:---------------:|:---------------:|:---------------:|
| 1              | –ó–æ–ª–æ—Ç–∞—è –º–µ–¥–∞–ª—å        | 5     |
| 2              | –°–µ—Ä–µ–±—Ä—è–Ω–∞—è –º–µ–¥–∞–ª—å     | 3     |
| 3              | –ó–æ–ª–æ—Ç–æ–π –∑–Ω–∞—á–æ–∫ –ì–¢–û    | 3     |
| 4              | –°–µ—Ä–µ–±—Ä—è–Ω—ã–π –∑–Ω–∞—á–æ–∫ –ì–¢–û | 1     |

*—Ç–∞–±–ª–∏—Ü–∞ enrollee*

| enrollee_id | name_enrollee   |
|:---------------:|:---------------:|
| 1           | –ë–∞—Ä–∞–Ω–æ–≤ –ü–∞–≤–µ–ª   |
| 2           | –ê–±—Ä–∞–º–æ–≤–∞ –ö–∞—Ç—è   |
| 3           | –°–µ–º–µ–Ω–æ–≤ –ò–≤–∞–Ω    |
| 4           | –Ø–∫–æ–≤–ª–µ–≤–∞ –ì–∞–ª–∏–Ω–∞ |
| 5           | –ü–æ–ø–æ–≤ –ò–ª—å—è      |
| 6           | –°—Ç–µ–ø–∞–Ω–æ–≤–∞ –î–∞—Ä—å—è |

*—Ç–∞–±–ª–∏—Ü–∞ enrollee_achievement*

| enrollee_achiev_id | enrollee_id | achievement_id |
|:---------------:|:---------------:|:---------------:|
| 1                  | 1           | 2              |
| 2                  | 1           | 3              |
| 3                  | 3           | 1              |
| 4                  | 4           | 4              |
| 5                  | 5           | 1              |
| 6                  | 5           | 3              |

‚úî`–†–ï–®–ï–ù–ò–ï` ‚§µÔ∏è

```sql
SELECT 
  name_enrollee, 
  SUM(
    IF(bonus IS NULL, 0, bonus)
  ) AS –ë–æ–Ω—É—Å 
FROM 
  enrollee 
  LEFT JOIN enrollee_achievement USING(enrollee_id) 
  LEFT JOIN achievement USING(achievement_id) 
GROUP BY 
  1 
ORDER BY 
  1;
```

üîé `–†–ï–ó–£–õ–¨–¢–ê–¢` ‚§µÔ∏è

| name_enrollee   | –ë–æ–Ω—É—Å |
|:---------------:|:---------------:|
| –ê–±—Ä–∞–º–æ–≤–∞ –ö–∞—Ç—è   | 0     |
| –ë–∞—Ä–∞–Ω–æ–≤ –ü–∞–≤–µ–ª   | 6     |
| –ü–æ–ø–æ–≤ –ò–ª—å—è      | 8     |
| –°–µ–º–µ–Ω–æ–≤ –ò–≤–∞–Ω    | 5     |
| –°—Ç–µ–ø–∞–Ω–æ–≤–∞ –î–∞—Ä—å—è | 0     |
| –Ø–∫–æ–≤–ª–µ–≤–∞ –ì–∞–ª–∏–Ω–∞ | 1     |

---

‚ú≥ –®–∞–≥ 8. 

‚ùì*–ó–∞–¥–∞–Ω–∏–µ. –í—ã–≤–µ–¥–∏—Ç–µ —Å–∫–æ–ª—å–∫–æ —á–µ–ª–æ–≤–µ–∫ –ø–æ–¥–∞–ª–æ –∑–∞—è–≤–ª–µ–Ω–∏–µ –Ω–∞ –∫–∞–∂–¥—É—é –æ–±—Ä–∞–∑–æ–≤–∞—Ç–µ–ª—å–Ω—É—é –ø—Ä–æ–≥—Ä–∞–º–º—É –∏ –∫–æ–Ω–∫—É—Ä—Å –Ω–∞ –Ω–µ–µ (—á–∏—Å–ª–æ –ø–æ–¥–∞–Ω–Ω—ã—Ö –∑–∞—è–≤–ª–µ–Ω–∏–π –¥–µ–ª–µ–Ω–Ω–æ–µ –Ω–∞ –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –º–µ—Å—Ç –ø–æ –ø–ª–∞–Ω—É), –æ–∫—Ä—É–≥–ª–µ–Ω–Ω—ã–π –¥–æ 2-—Ö –∑–Ω–∞–∫–æ–≤ –ø–æ—Å–ª–µ –∑–∞–ø—è—Ç–æ–π. –í –∑–∞–ø—Ä–æ—Å–µ –≤—ã–≤–µ—Å—Ç–∏ –Ω–∞–∑–≤–∞–Ω–∏–µ —Ñ–∞–∫—É–ª—å—Ç–µ—Ç–∞, –∫ –∫–æ—Ç–æ—Ä–æ–º—É –æ—Ç–Ω–æ—Å–∏—Ç—Å—è –æ–±—Ä–∞–∑–æ–≤–∞—Ç–µ–ª—å–Ω–∞—è –ø—Ä–æ–≥—Ä–∞–º–º–∞, –Ω–∞–∑–≤–∞–Ω–∏–µ –æ–±—Ä–∞–∑–æ–≤–∞—Ç–µ–ª—å–Ω–æ–π –ø—Ä–æ–≥—Ä–∞–º–º—ã, –ø–ª–∞–Ω –Ω–∞–±–æ—Ä–∞ –∞–±–∏—Ç—É—Ä–∏–µ–Ω—Ç–æ–≤ –Ω–∞ –æ–±—Ä–∞–∑–æ–≤–∞—Ç–µ–ª—å–Ω—É—é –ø—Ä–æ–≥—Ä–∞–º–º—É (plan), –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –ø–æ–¥–∞–Ω–Ω—ã—Ö –∑–∞—è–≤–ª–µ–Ω–∏–π (–ö–æ–ª–∏—á–µ—Å—Ç–≤–æ) –∏ –ö–æ–Ω–∫—É—Ä—Å. –ò–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é –æ—Ç—Å–æ—Ä—Ç–∏—Ä–æ–≤–∞—Ç—å –≤ –ø–æ—Ä—è–¥–∫–µ —É–±—ã–≤–∞–Ω–∏—è –∫–æ–Ω–∫—É—Ä—Å–∞.*

*–§—Ä–∞–≥–º–µ–Ω—Ç –ª–æ–≥–∏—á–µ—Å–∫–æ–π —Å—Ö–µ–º—ã –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö:*

![](https://ucarecdn.com/232b551a-2fbc-435e-85e1-513a8bea6043/)

*–ù–∞–ø–æ–ª–Ω–µ–Ω–∏–µ —Ç–∞–±–ª–∏—Ü department, program, program_enrollee:*

*—Ç–∞–±–ª–∏—Ü–∞ department*

| department_id | name_department         |
|:---------------:|:---------------:|
| 1             | –ò–Ω–∂–µ–Ω–µ—Ä–Ω–∞—è —à–∫–æ–ª–∞        |
| 2             | –®–∫–æ–ª–∞ –µ—Å—Ç–µ—Å—Ç–≤–µ–Ω–Ω—ã—Ö –Ω–∞—É–∫ |

*—Ç–∞–±–ª–∏—Ü–∞ program*

| program_id | name_program                        | department_id | plan |
|:---------------:|:---------------:|:---------------:|:---------------:|
| 1          | –ü—Ä–∏–∫–ª–∞–¥–Ω–∞—è –º–∞—Ç–µ–º–∞—Ç–∏–∫–∞ –∏ –∏–Ω—Ñ–æ—Ä–º–∞—Ç–∏–∫–∞ | 2             | 2    |
| 2          | –ú–∞—Ç–µ–º–∞—Ç–∏–∫–∞ –∏ –∫–æ–º–ø—å—é—Ç–µ—Ä–Ω—ã–µ –Ω–∞—É–∫–∏     | 2             | 1    |
| 3          | –ü—Ä–∏–∫–ª–∞–¥–Ω–∞—è –º–µ—Ö–∞–Ω–∏–∫–∞                 | 1             | 2    |
| 4          | –ú–µ—Ö–∞—Ç—Ä–æ–Ω–∏–∫–∞ –∏ —Ä–æ–±–æ—Ç–æ—Ç–µ—Ö–Ω–∏–∫–∞         | 1             | 3    |

*—Ç–∞–±–ª–∏—Ü–∞ program_enrollee*

| program_enrollee_id | program_id | enrollee_id |
|:---------------:|:---------------:|:---------------:|
| 1                   | 3          | 1           |
| 2                   | 4          | 1           |
| 3                   | 1          | 1           |
| 4                   | 2          | 2           |
| 5                   | 1          | 2           |
| 6                   | 1          | 3           |
| 7                   | 2          | 3           |
| 8                   | 4          | 3           |
| 9                   | 3          | 4           |
| 10                  | 3          | 5           |
| 11                  | 4          | 5           |
| 12                  | 2          | 6           |
| 13                  | 3          | 6           |
| 14                  | 4          | 6           |

‚úî`–†–ï–®–ï–ù–ò–ï` ‚§µÔ∏è

```sql
SELECT 
  name_department, 
  name_program, 
  plan, 
  COUNT(enrollee_id) AS –ö–æ–ª–∏—á–µ—Å—Ç–≤–æ, 
  ROUND(
    (
      COUNT(enrollee_id) / plan
    ), 
    2
  ) AS –ö–æ–Ω–∫—É—Ä—Å 
FROM 
  department 
  JOIN program USING(department_id) 
  JOIN program_enrollee USING(program_id) 
GROUP BY 
  1, 
  2, 
  3 
ORDER BY 
  5 DESC;
```

üîé `–†–ï–ó–£–õ–¨–¢–ê–¢` ‚§µÔ∏è

| name_department         | name_program                        | plan | –ö–æ–ª–∏—á–µ—Å—Ç–≤–æ | –ö–æ–Ω–∫—É—Ä—Å |
|:---------------:|:---------------:|:---------------:|:---------------:|:---------------:|
| –®–∫–æ–ª–∞ –µ—Å—Ç–µ—Å—Ç–≤–µ–Ω–Ω—ã—Ö –Ω–∞—É–∫ | –ú–∞—Ç–µ–º–∞—Ç–∏–∫–∞ –∏ –∫–æ–º–ø—å—é—Ç–µ—Ä–Ω—ã–µ –Ω–∞—É–∫–∏     | 1    | 3          | 3.00    |
| –ò–Ω–∂–µ–Ω–µ—Ä–Ω–∞—è —à–∫–æ–ª–∞        | –ü—Ä–∏–∫–ª–∞–¥–Ω–∞—è –º–µ—Ö–∞–Ω–∏–∫–∞                 | 2    | 4          | 2.00    |
| –®–∫–æ–ª–∞ –µ—Å—Ç–µ—Å—Ç–≤–µ–Ω–Ω—ã—Ö –Ω–∞—É–∫ | –ü—Ä–∏–∫–ª–∞–¥–Ω–∞—è –º–∞—Ç–µ–º–∞—Ç–∏–∫–∞ –∏ –∏–Ω—Ñ–æ—Ä–º–∞—Ç–∏–∫–∞ | 2    | 3          | 1.50    |
| –ò–Ω–∂–µ–Ω–µ—Ä–Ω–∞—è —à–∫–æ–ª–∞        | –ú–µ—Ö–∞—Ç—Ä–æ–Ω–∏–∫–∞ –∏ —Ä–æ–±–æ—Ç–æ—Ç–µ—Ö–Ω–∏–∫–∞         | 3    | 4          | 1.33    |

---

‚ú≥ –®–∞–≥ 9. 

‚ùì*–ó–∞–¥–∞–Ω–∏–µ. –í—ã–≤–µ—Å—Ç–∏ –æ–±—Ä–∞–∑–æ–≤–∞—Ç–µ–ª—å–Ω—ã–µ –ø—Ä–æ–≥—Ä–∞–º–º—ã, –Ω–∞ –∫–æ—Ç–æ—Ä—ã–µ –¥–ª—è –ø–æ—Å—Ç—É–ø–ª–µ–Ω–∏—è –Ω–µ–æ–±—Ö–æ–¥–∏–º—ã –ø—Ä–µ–¥–º–µ—Ç ¬´–ò–Ω—Ñ–æ—Ä–º–∞—Ç–∏–∫–∞¬ª –∏ ¬´–ú–∞—Ç–µ–º–∞—Ç–∏–∫–∞¬ª –≤ –æ—Ç—Å–æ—Ä—Ç–∏—Ä–æ–≤–∞–Ω–Ω–æ–º –ø–æ –Ω–∞–∑–≤–∞–Ω–∏—é –ø—Ä–æ–≥—Ä–∞–º–º –≤–∏–¥–µ.*

*–õ–æ–≥–∏—á–µ—Å–∫–∞—è —Å—Ö–µ–º—ã –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö (—á—Ç–æ–±—ã –ø–æ—Ç—Ä–µ–Ω–∏—Ä–æ–≤–∞—Ç—å—Å—è –≤—ã–±–∏—Ä–∞—Ç—å —Ç–∞–±–ª–∏—Ü—ã –¥–ª—è –∑–∞–ø—Ä–æ—Å–∞):*

![](https://ucarecdn.com/98c706e5-0118-4fa9-ae09-4a934ece5bc8/)

*–ù–∞–ø–æ–ª–Ω–µ–Ω–∏–µ —Ç–∞–±–ª–∏—Ü:*

*—Ç–∞–±–ª–∏—Ü–∞ department*

| department_id | name_department         |
|:---------------:|:---------------:|
| 1             | –ò–Ω–∂–µ–Ω–µ—Ä–Ω–∞—è —à–∫–æ–ª–∞        |
| 2             | –®–∫–æ–ª–∞ –µ—Å—Ç–µ—Å—Ç–≤–µ–Ω–Ω—ã—Ö –Ω–∞—É–∫ |

*—Ç–∞–±–ª–∏—Ü–∞ program*

| program_id | name_program                        | department_id | plan |
|:---------------:|:---------------:|:---------------:|:---------------:|
| 1          | –ü—Ä–∏–∫–ª–∞–¥–Ω–∞—è –º–∞—Ç–µ–º–∞—Ç–∏–∫–∞ –∏ –∏–Ω—Ñ–æ—Ä–º–∞—Ç–∏–∫–∞ | 2             | 2    |
| 2          | –ú–∞—Ç–µ–º–∞—Ç–∏–∫–∞ –∏ –∫–æ–º–ø—å—é—Ç–µ—Ä–Ω—ã–µ –Ω–∞—É–∫–∏     | 2             | 1    |
| 3          | –ü—Ä–∏–∫–ª–∞–¥–Ω–∞—è –º–µ—Ö–∞–Ω–∏–∫–∞                 | 1             | 2    |
| 4          | –ú–µ—Ö–∞—Ç—Ä–æ–Ω–∏–∫–∞ –∏ —Ä–æ–±–æ—Ç–æ—Ç–µ—Ö–Ω–∏–∫–∞         | 1             | 3    |

*—Ç–∞–±–ª–∏—Ü–∞ enrollee*

| enrollee_id | name_enrollee   |
|:---------------:|:---------------:|
| 1           | –ë–∞—Ä–∞–Ω–æ–≤ –ü–∞–≤–µ–ª   |
| 2           | –ê–±—Ä–∞–º–æ–≤–∞ –ö–∞—Ç—è   |
| 3           | –°–µ–º–µ–Ω–æ–≤ –ò–≤–∞–Ω    |
| 4           | –Ø–∫–æ–≤–ª–µ–≤–∞ –ì–∞–ª–∏–Ω–∞ |
| 5           | –ü–æ–ø–æ–≤ –ò–ª—å—è      |
| 6           | –°—Ç–µ–ø–∞–Ω–æ–≤–∞ –î–∞—Ä—å—è |

*—Ç–∞–±–ª–∏—Ü–∞ subject*

| subject_id | name_subject |
|:---------------:|:---------------:|
| 1          | –†—É—Å—Å–∫–∏–π —è–∑—ã–∫ |
| 2          | –ú–∞—Ç–µ–º–∞—Ç–∏–∫–∞   |
| 3          | –§–∏–∑–∏–∫–∞       |
| 4          | –ò–Ω—Ñ–æ—Ä–º–∞—Ç–∏–∫–∞  |

*—Ç–∞–±–ª–∏—Ü–∞ program_subject*

| program_subject_id | program_id | subject_id | min_result |
|:---------------:|:---------------:|:---------------:|:---------------:|
| 1                  | 1          | 1          | 40         |
| 2                  | 1          | 2          | 50         |
| 3                  | 1          | 4          | 60         |
| 4                  | 2          | 1          | 30         |
| 5                  | 2          | 2          | 50         |
| 6                  | 2          | 4          | 60         |
| 7                  | 3          | 1          | 30         |
| 8                  | 3          | 2          | 45         |
| 9                  | 3          | 3          | 45         |
| 10                 | 4          | 1          | 40         |
| 11                 | 4          | 2          | 45         |
| 12                 | 4          | 3          | 45         |

*—Ç–∞–±–ª–∏—Ü–∞ program_enrollee*

| program_enrollee_id | program_id | enrollee_id |
|:---------------:|:---------------:|:---------------:|
| 1                   | 3          | 1           |
| 2                   | 4          | 1           |
| 3                   | 1          | 1           |
| 4                   | 2          | 2           |
| 5                   | 1          | 2           |
| 6                   | 1          | 3           |
| 7                   | 2          | 3           |
| 8                   | 4          | 3           |
| 9                   | 3          | 4           |
| 10                  | 3          | 5           |
| 11                  | 4          | 5           |
| 12                  | 2          | 6           |
| 13                  | 3          | 6           |
| 14                  | 4          | 6           |

*—Ç–∞–±–ª–∏—Ü–∞ enrollee_subject*

| enrollee_subject_id | enrollee_id | subject_id | result |
|:---------------:|:---------------:|:---------------:|:---------------:|
| 1                   | 1           | 1          | 68     |
| 2                   | 1           | 2          | 70     |
| 3                   | 1           | 3          | 41     |
| 4                   | 1           | 4          | 75     |
| 5                   | 2           | 1          | 75     |
| 6                   | 2           | 2          | 70     |
| 7                   | 2           | 4          | 81     |
| 8                   | 3           | 1          | 85     |
| 9                   | 3           | 2          | 67     |
| 10                  | 3           | 3          | 90     |
| 11                  | 3           | 4          | 78     |
| 12                  | 4           | 1          | 82     |
| 13                  | 4           | 2          | 86     |
| 14                  | 4           | 3          | 70     |
| 15                  | 5           | 1          | 65     |
| 16                  | 5           | 2          | 67     |
| 17                  | 5           | 3          | 60     |
| 18                  | 6           | 1          | 90     |
| 19                  | 6           | 2          | 92     |
| 20                  | 6           | 3          | 88     |
| 21                  | 6           | 4          | 94     |

*—Ç–∞–±–ª–∏—Ü–∞ achievement*

| achievement_id | name_achievement      | bonus |
|:---------------:|:---------------:|:---------------:|
| 1              | –ó–æ–ª–æ—Ç–∞—è –º–µ–¥–∞–ª—å        | 5     |
| 2              | –°–µ—Ä–µ–±—Ä—è–Ω–∞—è –º–µ–¥–∞–ª—å     | 3     |
| 3              | –ó–æ–ª–æ—Ç–æ–π –∑–Ω–∞—á–æ–∫ –ì–¢–û    | 3     |
| 4              | –°–µ—Ä–µ–±—Ä—è–Ω—ã–π –∑–Ω–∞—á–æ–∫ –ì–¢–û | 1     |

*—Ç–∞–±–ª–∏—Ü–∞ enrollee_achievement*

| enrollee_achiev_id | enrollee_id | achievement_id |
|:---------------:|:---------------:|:---------------:|
| 1                  | 1           | 2              |
| 2                  | 1           | 3              |
| 3                  | 3           | 1              |
| 4                  | 4           | 4              |
| 5                  | 5           | 1              |
| 6                  | 5           | 3              |

‚úî`–†–ï–®–ï–ù–ò–ï` ‚§µÔ∏è

```sql
SELECT 
  name_program 
FROM 
  program 
  JOIN program_subject USING(program_id) 
  JOIN subject USING(subject_id) 
WHERE 
  name_subject IN(
    '–ò–Ω—Ñ–æ—Ä–º–∞—Ç–∏–∫–∞', '–ú–∞—Ç–µ–º–∞—Ç–∏–∫–∞'
  ) 
GROUP BY 
  1 
HAVING 
  COUNT(name_program) = 2 
ORDER BY 
  1;
```

üîé `–†–ï–ó–£–õ–¨–¢–ê–¢` ‚§µÔ∏è

| name_program                        |
|:---------------:|
| –ú–∞—Ç–µ–º–∞—Ç–∏–∫–∞ –∏ –∫–æ–º–ø—å—é—Ç–µ—Ä–Ω—ã–µ –Ω–∞—É–∫–∏     |
| –ü—Ä–∏–∫–ª–∞–¥–Ω–∞—è –º–∞—Ç–µ–º–∞—Ç–∏–∫–∞ –∏ –∏–Ω—Ñ–æ—Ä–º–∞—Ç–∏–∫–∞ |

---

‚ú≥ –®–∞–≥ 10. 

‚ùì*–ó–∞–¥–∞–Ω–∏–µ. –ü–æ—Å—á–∏—Ç–∞—Ç—å –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –±–∞–ª–ª–æ–≤ –∫–∞–∂–¥–æ–≥–æ –∞–±–∏—Ç—É—Ä–∏–µ–Ω—Ç–∞ –Ω–∞ –∫–∞–∂–¥—É—é –æ–±—Ä–∞–∑–æ–≤–∞—Ç–µ–ª—å–Ω—É—é –ø—Ä–æ–≥—Ä–∞–º–º—É, –Ω–∞ –∫–æ—Ç–æ—Ä—É—é –æ–Ω –ø–æ–¥–∞–ª –∑–∞—è–≤–ª–µ–Ω–∏–µ, –ø–æ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–∞–º –ï–ì–≠. –í —Ä–µ–∑—É–ª—å—Ç–∞—Ç –≤–∫–ª—é—á–∏—Ç—å –Ω–∞–∑–≤–∞–Ω–∏–µ –æ–±—Ä–∞–∑–æ–≤–∞—Ç–µ–ª—å–Ω–æ–π –ø—Ä–æ–≥—Ä–∞–º–º—ã, —Ñ–∞–º–∏–ª–∏—é –∏ –∏–º—è –∞–±–∏—Ç—É—Ä–∏–µ–Ω—Ç–∞, –∞ —Ç–∞–∫–∂–µ —Å—Ç–æ–ª–±–µ—Ü —Å —Å—É–º–º–æ–π –±–∞–ª–ª–æ–≤, –∫–æ—Ç–æ—Ä—ã–π –Ω–∞–∑–≤–∞—Ç—å itog. –ò–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é –≤—ã–≤–µ—Å—Ç–∏ –≤ –æ—Ç—Å–æ—Ä—Ç–∏—Ä–æ–≤–∞–Ω–Ω–æ–º —Å–Ω–∞—á–∞–ª–∞ –ø–æ –æ–±—Ä–∞–∑–æ–≤–∞—Ç–µ–ª—å–Ω–æ–π –ø—Ä–æ–≥—Ä–∞–º–º–µ, –∞ –ø–æ—Ç–æ–º –ø–æ —É–±—ã–≤–∞–Ω–∏—é —Å—É–º–º—ã –±–∞–ª–ª–æ–≤ –≤–∏–¥–µ.*

*–§—Ä–∞–≥–º–µ–Ω—Ç –ª–æ–≥–∏—á–µ—Å–∫–æ–π —Å—Ö–µ–º—ã –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö:*

![](https://ucarecdn.com/4f7e6cd2-4d21-46a0-b7ba-52132f8c1fb8/)

*–ù–∞–ø–æ–ª–Ω–µ–Ω–∏–µ —Ç–∞–±–ª–∏—Ü:*

*—Ç–∞–±–ª–∏—Ü–∞ department*

| department_id | name_department         |
|:---------------:|:---------------:|
| 1             | –ò–Ω–∂–µ–Ω–µ—Ä–Ω–∞—è —à–∫–æ–ª–∞        |
| 2             | –®–∫–æ–ª–∞ –µ—Å—Ç–µ—Å—Ç–≤–µ–Ω–Ω—ã—Ö –Ω–∞—É–∫ |

*—Ç–∞–±–ª–∏—Ü–∞ program*

| program_id | name_program                        | department_id | plan |
|:---------------:|:---------------:|:---------------:|:---------------:|
| 1          | –ü—Ä–∏–∫–ª–∞–¥–Ω–∞—è –º–∞—Ç–µ–º–∞—Ç–∏–∫–∞ –∏ –∏–Ω—Ñ–æ—Ä–º–∞—Ç–∏–∫–∞ | 2             | 2    |
| 2          | –ú–∞—Ç–µ–º–∞—Ç–∏–∫–∞ –∏ –∫–æ–º–ø—å—é—Ç–µ—Ä–Ω—ã–µ –Ω–∞—É–∫–∏     | 2             | 1    |
| 3          | –ü—Ä–∏–∫–ª–∞–¥–Ω–∞—è –º–µ—Ö–∞–Ω–∏–∫–∞                 | 1             | 2    |
| 4          | –ú–µ—Ö–∞—Ç—Ä–æ–Ω–∏–∫–∞ –∏ —Ä–æ–±–æ—Ç–æ—Ç–µ—Ö–Ω–∏–∫–∞         | 1             | 3    |

*—Ç–∞–±–ª–∏—Ü–∞ enrollee*

| enrollee_id | name_enrollee   |
|:---------------:|:---------------:|
| 1           | –ë–∞—Ä–∞–Ω–æ–≤ –ü–∞–≤–µ–ª   |
| 2           | –ê–±—Ä–∞–º–æ–≤–∞ –ö–∞—Ç—è   |
| 3           | –°–µ–º–µ–Ω–æ–≤ –ò–≤–∞–Ω    |
| 4           | –Ø–∫–æ–≤–ª–µ–≤–∞ –ì–∞–ª–∏–Ω–∞ |
| 5           | –ü–æ–ø–æ–≤ –ò–ª—å—è      |
| 6           | –°—Ç–µ–ø–∞–Ω–æ–≤–∞ –î–∞—Ä—å—è |

*—Ç–∞–±–ª–∏—Ü–∞ subject*

| subject_id | name_subject |
|:---------------:|:---------------:|
| 1          | –†—É—Å—Å–∫–∏–π —è–∑—ã–∫ |
| 2          | –ú–∞—Ç–µ–º–∞—Ç–∏–∫–∞   |
| 3          | –§–∏–∑–∏–∫–∞       |
| 4          | –ò–Ω—Ñ–æ—Ä–º–∞—Ç–∏–∫–∞  |

*—Ç–∞–±–ª–∏—Ü–∞ program_subject*

| program_subject_id | program_id | subject_id | min_result |
|:---------------:|:---------------:|:---------------:|:---------------:|
| 1                  | 1          | 1          | 40         |
| 2                  | 1          | 2          | 50         |
| 3                  | 1          | 4          | 60         |
| 4                  | 2          | 1          | 30         |
| 5                  | 2          | 2          | 50         |
| 6                  | 2          | 4          | 60         |
| 7                  | 3          | 1          | 30         |
| 8                  | 3          | 2          | 45         |
| 9                  | 3          | 3          | 45         |
| 10                 | 4          | 1          | 40         |
| 11                 | 4          | 2          | 45         |
| 12                 | 4          | 3          | 45         |

*—Ç–∞–±–ª–∏—Ü–∞ program_enrollee*

| program_enrollee_id | program_id | enrollee_id |
|:---------------:|:---------------:|:---------------:|
| 1                   | 3          | 1           |
| 2                   | 4          | 1           |
| 3                   | 1          | 1           |
| 4                   | 2          | 2           |
| 5                   | 1          | 2           |
| 6                   | 1          | 3           |
| 7                   | 2          | 3           |
| 8                   | 4          | 3           |
| 9                   | 3          | 4           |
| 10                  | 3          | 5           |
| 11                  | 4          | 5           |
| 12                  | 2          | 6           |
| 13                  | 3          | 6           |
| 14                  | 4          | 6           |

*—Ç–∞–±–ª–∏—Ü–∞ enrollee_subject*

| enrollee_subject_id | enrollee_id | subject_id | result |
|:---------------:|:---------------:|:---------------:|:---------------:|
| 1                   | 1           | 1          | 68     |
| 2                   | 1           | 2          | 70     |
| 3                   | 1           | 3          | 41     |
| 4                   | 1           | 4          | 75     |
| 5                   | 2           | 1          | 75     |
| 6                   | 2           | 2          | 70     |
| 7                   | 2           | 4          | 81     |
| 8                   | 3           | 1          | 85     |
| 9                   | 3           | 2          | 67     |
| 10                  | 3           | 3          | 90     |
| 11                  | 3           | 4          | 78     |
| 12                  | 4           | 1          | 82     |
| 13                  | 4           | 2          | 86     |
| 14                  | 4           | 3          | 70     |
| 15                  | 5           | 1          | 65     |
| 16                  | 5           | 2          | 67     |
| 17                  | 5           | 3          | 60     |
| 18                  | 6           | 1          | 90     |
| 19                  | 6           | 2          | 92     |
| 20                  | 6           | 3          | 88     |
| 21                  | 6           | 4          | 94     |

*—Ç–∞–±–ª–∏—Ü–∞ achievement*

| achievement_id | name_achievement      | bonus |
|:---------------:|:---------------:|:---------------:|
| 1              | –ó–æ–ª–æ—Ç–∞—è –º–µ–¥–∞–ª—å        | 5     |
| 2              | –°–µ—Ä–µ–±—Ä—è–Ω–∞—è –º–µ–¥–∞–ª—å     | 3     |
| 3              | –ó–æ–ª–æ—Ç–æ–π –∑–Ω–∞—á–æ–∫ –ì–¢–û    | 3     |
| 4              | –°–µ—Ä–µ–±—Ä—è–Ω—ã–π –∑–Ω–∞—á–æ–∫ –ì–¢–û | 1     |

*—Ç–∞–±–ª–∏—Ü–∞ enrollee_achievement*

| enrollee_achiev_id | enrollee_id | achievement_id |
|:---------------:|:---------------:|:---------------:|
| 1                  | 1           | 2              |
| 2                  | 1           | 3              |
| 3                  | 3           | 1              |
| 4                  | 4           | 4              |
| 5                  | 5           | 1              |
| 6                  | 5           | 3              |

‚úî`–†–ï–®–ï–ù–ò–ï` ‚§µÔ∏è

```sql
SELECT 
  name_program, 
  name_enrollee, 
  SUM(result) AS itog 
FROM 
  program_enrollee 
  JOIN enrollee_subject USING(enrollee_id) 
  JOIN program_subject USING(program_id, subject_id) 
  JOIN enrollee USING(enrollee_id) 
  JOIN program USING(program_id) 
GROUP BY 
  name_program, 
  name_enrollee 
ORDER BY 
  1, 
  3 DESC;
```

üîé `–†–ï–ó–£–õ–¨–¢–ê–¢` ‚§µÔ∏è

| name_program                        | name_enrollee   | itog |
|:---------------:|:---------------:|:---------------:|
| –ú–∞—Ç–µ–º–∞—Ç–∏–∫–∞ –∏ –∫–æ–º–ø—å—é—Ç–µ—Ä–Ω—ã–µ –Ω–∞—É–∫–∏     | –°—Ç–µ–ø–∞–Ω–æ–≤–∞ –î–∞—Ä—å—è | 276  |
| –ú–∞—Ç–µ–º–∞—Ç–∏–∫–∞ –∏ –∫–æ–º–ø—å—é—Ç–µ—Ä–Ω—ã–µ –Ω–∞—É–∫–∏     | –°–µ–º–µ–Ω–æ–≤ –ò–≤–∞–Ω    | 230  |
| –ú–∞—Ç–µ–º–∞—Ç–∏–∫–∞ –∏ –∫–æ–º–ø—å—é—Ç–µ—Ä–Ω—ã–µ –Ω–∞—É–∫–∏     | –ê–±—Ä–∞–º–æ–≤–∞ –ö–∞—Ç—è   | 226  |
| –ú–µ—Ö–∞—Ç—Ä–æ–Ω–∏–∫–∞ –∏ —Ä–æ–±–æ—Ç–æ—Ç–µ—Ö–Ω–∏–∫–∞         | –°—Ç–µ–ø–∞–Ω–æ–≤–∞ –î–∞—Ä—å—è | 270  |
| –ú–µ—Ö–∞—Ç—Ä–æ–Ω–∏–∫–∞ –∏ —Ä–æ–±–æ—Ç–æ—Ç–µ—Ö–Ω–∏–∫–∞         | –°–µ–º–µ–Ω–æ–≤ –ò–≤–∞–Ω    | 242  |
| –ú–µ—Ö–∞—Ç—Ä–æ–Ω–∏–∫–∞ –∏ —Ä–æ–±–æ—Ç–æ—Ç–µ—Ö–Ω–∏–∫–∞         | –ü–æ–ø–æ–≤ –ò–ª—å—è      | 192  |
| –ú–µ—Ö–∞—Ç—Ä–æ–Ω–∏–∫–∞ –∏ —Ä–æ–±–æ—Ç–æ—Ç–µ—Ö–Ω–∏–∫–∞         | –ë–∞—Ä–∞–Ω–æ–≤ –ü–∞–≤–µ–ª   | 179  |
| –ü—Ä–∏–∫–ª–∞–¥–Ω–∞—è –º–∞—Ç–µ–º–∞—Ç–∏–∫–∞ –∏ –∏–Ω—Ñ–æ—Ä–º–∞—Ç–∏–∫–∞ | –°–µ–º–µ–Ω–æ–≤ –ò–≤–∞–Ω    | 230  |
| –ü—Ä–∏–∫–ª–∞–¥–Ω–∞—è –º–∞—Ç–µ–º–∞—Ç–∏–∫–∞ –∏ –∏–Ω—Ñ–æ—Ä–º–∞—Ç–∏–∫–∞ | –ê–±—Ä–∞–º–æ–≤–∞ –ö–∞—Ç—è   | 226  |
| –ü—Ä–∏–∫–ª–∞–¥–Ω–∞—è –º–∞—Ç–µ–º–∞—Ç–∏–∫–∞ –∏ –∏–Ω—Ñ–æ—Ä–º–∞—Ç–∏–∫–∞ | –ë–∞—Ä–∞–Ω–æ–≤ –ü–∞–≤–µ–ª   | 213  |
| –ü—Ä–∏–∫–ª–∞–¥–Ω–∞—è –º–µ—Ö–∞–Ω–∏–∫–∞                 | –°—Ç–µ–ø–∞–Ω–æ–≤–∞ –î–∞—Ä—å—è | 270  |
| –ü—Ä–∏–∫–ª–∞–¥–Ω–∞—è –º–µ—Ö–∞–Ω–∏–∫–∞                 | –Ø–∫–æ–≤–ª–µ–≤–∞ –ì–∞–ª–∏–Ω–∞ | 238  |
| –ü—Ä–∏–∫–ª–∞–¥–Ω–∞—è –º–µ—Ö–∞–Ω–∏–∫–∞                 | –ü–æ–ø–æ–≤ –ò–ª—å—è      | 192  |
| –ü—Ä–∏–∫–ª–∞–¥–Ω–∞—è –º–µ—Ö–∞–Ω–∏–∫–∞                 | –ë–∞—Ä–∞–Ω–æ–≤ –ü–∞–≤–µ–ª   | 179  |

---

‚ú≥ –®–∞–≥ 11. 

‚ùì*–ó–∞–¥–∞–Ω–∏–µ. –í—ã–≤–µ—Å—Ç–∏ –Ω–∞–∑–≤–∞–Ω–∏–µ –æ–±—Ä–∞–∑–æ–≤–∞—Ç–µ–ª—å–Ω–æ–π –ø—Ä–æ–≥—Ä–∞–º–º—ã –∏ —Ñ–∞–º–∏–ª–∏—é —Ç–µ—Ö –∞–±–∏—Ç—É—Ä–∏–µ–Ω—Ç–æ–≤, –∫–æ—Ç–æ—Ä—ã–µ –ø–æ–¥–∞–≤–∞–ª–∏ –¥–æ–∫—É–º–µ–Ω—Ç—ã –Ω–∞ —ç—Ç—É –æ–±—Ä–∞–∑–æ–≤–∞—Ç–µ–ª—å–Ω—É—é –ø—Ä–æ–≥—Ä–∞–º–º—É, –Ω–æ –Ω–µ –º–æ–≥—É—Ç –±—ã—Ç—å –∑–∞—á–∏—Å–ª–µ–Ω—ã –Ω–∞ –Ω–µ–µ. –≠—Ç–∏ –∞–±–∏—Ç—É—Ä–∏–µ–Ω—Ç—ã –∏–º–µ—é—Ç —Ä–µ–∑—É–ª—å—Ç–∞—Ç –ø–æ –æ–¥–Ω–æ–º—É –∏–ª–∏ –Ω–µ—Å–∫–æ–ª—å–∫–∏–º –ø—Ä–µ–¥–º–µ—Ç–∞–º –ï–ì–≠, –Ω–µ–æ–±—Ö–æ–¥–∏–º—ã–º –¥–ª—è –ø–æ—Å—Ç—É–ø–ª–µ–Ω–∏—è –Ω–∞ —ç—Ç—É –æ–±—Ä–∞–∑–æ–≤–∞—Ç–µ–ª—å–Ω—É—é –ø—Ä–æ–≥—Ä–∞–º–º—É, –º–µ–Ω—å—à–µ –º–∏–Ω–∏–º–∞–ª—å–Ω–æ–≥–æ –±–∞–ª–ª–∞. –ò–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é –≤—ã–≤–µ—Å—Ç–∏ –≤ –æ—Ç—Å–æ—Ä—Ç–∏—Ä–æ–≤–∞–Ω–Ω–æ–º —Å–Ω–∞—á–∞–ª–∞ –ø–æ –ø—Ä–æ–≥—Ä–∞–º–º–∞–º, –∞ –ø–æ—Ç–æ–º –ø–æ —Ñ–∞–º–∏–ª–∏—è–º –∞–±–∏—Ç—É—Ä–∏–µ–Ω—Ç–æ–≤ –≤–∏–¥–µ.  
–ù–∞–ø—Ä–∏–º–µ—Ä, –ë–∞—Ä–∞–Ω–æ–≤ –ü–∞–≤–µ–ª –ø–æ ¬´–§–∏–∑–∏–∫–µ¬ª –Ω–∞–±—Ä–∞–ª 41 –±–∞–ª–ª, –∞  –¥–ª—è –æ–±—Ä–∞–∑–æ–≤–∞—Ç–µ–ª—å–Ω–æ–π –ø—Ä–æ–≥—Ä–∞–º–º—ã ¬´–ü—Ä–∏–∫–ª–∞–¥–Ω–∞—è –º–µ—Ö–∞–Ω–∏–∫–∞¬ª –º–∏–Ω–∏–º–∞–ª—å–Ω—ã–π –±–∞–ª–ª –ø–æ —ç—Ç–æ–º—É –ø—Ä–µ–¥–º–µ—Ç—É –æ–ø—Ä–µ–¥–µ–ª–µ–Ω –≤ 45 –±–∞–ª–ª–æ–≤. –°–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å–Ω–æ, –∞–±–∏—Ç—É—Ä–∏–µ–Ω—Ç –Ω–∞ –¥–∞–Ω–Ω—É—é –ø—Ä–æ–≥—Ä–∞–º–º—É –Ω–µ –º–æ–∂–µ—Ç –ø–æ—Å—Ç—É–ø–∏—Ç—å.*

*–î–ª—è —ç—Ç–æ–≥–æ –∑–∞–¥–∞–Ω–∏—è –≤ –±–∞–∑—É –¥–∞–Ω–Ω—ã—Ö –¥–æ–±–∞–≤–ª–µ–Ω–∞ —Å—Ç—Ä–æ–∫–∞:*

```sql
INSERT INTO enrollee_subject (enrollee_id, subject_id, result) VALUES (2, 3, 41);
```

*–î–æ–±–∞–≤–ª–µ–Ω —á–µ–ª–æ–≤–µ–∫, –∫–æ—Ç–æ—Ä—ã–π —Å–¥–∞–≤–∞–ª –§–∏–∑–∏–∫—É, –Ω–æ –Ω–µ –ø–æ–¥–∞–ª –¥–æ–∫—É–º–µ–Ω—Ç—ã –Ω–∏ –Ω–∞ –æ–¥–Ω—É –æ–±—Ä–∞–∑–æ–≤–∞—Ç–µ–ª—å–Ω—É—é –ø—Ä–æ–≥—Ä–∞–º–º—É, –≥–¥–µ —ç—Ç–æ—Ç –ø—Ä–µ–¥–º–µ—Ç –Ω—É–∂–µ–Ω.*

*–õ–æ–≥–∏—á–µ—Å–∫–∞—è —Å—Ö–µ–º—ã –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö (—á—Ç–æ–±—ã –ø–æ—Ç—Ä–µ–Ω–∏—Ä–æ–≤–∞—Ç—å—Å—è –≤—ã–±–∏—Ä–∞—Ç—å —Ç–∞–±–ª–∏—Ü—ã –¥–ª—è –∑–∞–ø—Ä–æ—Å–∞):*

![](https://ucarecdn.com/98c706e5-0118-4fa9-ae09-4a934ece5bc8/)

*–ù–∞–ø–æ–ª–Ω–µ–Ω–∏–µ —Ç–∞–±–ª–∏—Ü:*

*—Ç–∞–±–ª–∏—Ü–∞ department*

| department_id | name_department         |
|:---------------:|:---------------:|
| 1             | –ò–Ω–∂–µ–Ω–µ—Ä–Ω–∞—è —à–∫–æ–ª–∞        |
| 2             | –®–∫–æ–ª–∞ –µ—Å—Ç–µ—Å—Ç–≤–µ–Ω–Ω—ã—Ö –Ω–∞—É–∫ |

*—Ç–∞–±–ª–∏—Ü–∞ program*

| program_id | name_program                        | department_id | plan |
|:---------------:|:---------------:|:---------------:|:---------------:|
| 1          | –ü—Ä–∏–∫–ª–∞–¥–Ω–∞—è –º–∞—Ç–µ–º–∞—Ç–∏–∫–∞ –∏ –∏–Ω—Ñ–æ—Ä–º–∞—Ç–∏–∫–∞ | 2             | 2    |
| 2          | –ú–∞—Ç–µ–º–∞—Ç–∏–∫–∞ –∏ –∫–æ–º–ø—å—é—Ç–µ—Ä–Ω—ã–µ –Ω–∞—É–∫–∏     | 2             | 1    |
| 3          | –ü—Ä–∏–∫–ª–∞–¥–Ω–∞—è –º–µ—Ö–∞–Ω–∏–∫–∞                 | 1             | 2    |
| 4          | –ú–µ—Ö–∞—Ç—Ä–æ–Ω–∏–∫–∞ –∏ —Ä–æ–±–æ—Ç–æ—Ç–µ—Ö–Ω–∏–∫–∞         | 1             | 3    |

*—Ç–∞–±–ª–∏—Ü–∞ enrollee*

| enrollee_id | name_enrollee   |
|:---------------:|:---------------:|
| 1           | –ë–∞—Ä–∞–Ω–æ–≤ –ü–∞–≤–µ–ª   |
| 2           | –ê–±—Ä–∞–º–æ–≤–∞ –ö–∞—Ç—è   |
| 3           | –°–µ–º–µ–Ω–æ–≤ –ò–≤–∞–Ω    |
| 4           | –Ø–∫–æ–≤–ª–µ–≤–∞ –ì–∞–ª–∏–Ω–∞ |
| 5           | –ü–æ–ø–æ–≤ –ò–ª—å—è      |
| 6           | –°—Ç–µ–ø–∞–Ω–æ–≤–∞ –î–∞—Ä—å—è |

*—Ç–∞–±–ª–∏—Ü–∞ subject*

| subject_id | name_subject |
|:---------------:|:---------------:|
| 1          | –†—É—Å—Å–∫–∏–π —è–∑—ã–∫ |
| 2          | –ú–∞—Ç–µ–º–∞—Ç–∏–∫–∞   |
| 3          | –§–∏–∑–∏–∫–∞       |
| 4          | –ò–Ω—Ñ–æ—Ä–º–∞—Ç–∏–∫–∞  |

*—Ç–∞–±–ª–∏—Ü–∞ program_subject*

| program_subject_id | program_id | subject_id | min_result |
|:---------------:|:---------------:|:---------------:|:---------------:|
| 1                  | 1          | 1          | 40         |
| 2                  | 1          | 2          | 50         |
| 3                  | 1          | 4          | 60         |
| 4                  | 2          | 1          | 30         |
| 5                  | 2          | 2          | 50         |
| 6                  | 2          | 4          | 60         |
| 7                  | 3          | 1          | 30         |
| 8                  | 3          | 2          | 45         |
| 9                  | 3          | 3          | 45         |
| 10                 | 4          | 1          | 40         |
| 11                 | 4          | 2          | 45         |
| 12                 | 4          | 3          | 45         |

*—Ç–∞–±–ª–∏—Ü–∞ program_enrollee*

| program_enrollee_id | program_id | enrollee_id |
|:---------------:|:---------------:|:---------------:|
| 1                   | 3          | 1           |
| 2                   | 4          | 1           |
| 3                   | 1          | 1           |
| 4                   | 2          | 2           |
| 5                   | 1          | 2           |
| 6                   | 1          | 3           |
| 7                   | 2          | 3           |
| 8                   | 4          | 3           |
| 9                   | 3          | 4           |
| 10                  | 3          | 5           |
| 11                  | 4          | 5           |
| 12                  | 2          | 6           |
| 13                  | 3          | 6           |
| 14                  | 4          | 6           |

*—Ç–∞–±–ª–∏—Ü–∞ enrollee_subject*

| enrollee_subject_id | enrollee_id | subject_id | result |
|:---------------:|:---------------:|:---------------:|:---------------:|
| 1                   | 1           | 1          | 68     |
| 2                   | 1           | 2          | 70     |
| 3                   | 1           | 3          | 41     |
| 4                   | 1           | 4          | 75     |
| 5                   | 2           | 1          | 75     |
| 6                   | 2           | 2          | 70     |
| 7                   | 2           | 4          | 81     |
| 8                   | 3           | 1          | 85     |
| 9                   | 3           | 2          | 67     |
| 10                  | 3           | 3          | 90     |
| 11                  | 3           | 4          | 78     |
| 12                  | 4           | 1          | 82     |
| 13                  | 4           | 2          | 86     |
| 14                  | 4           | 3          | 70     |
| 15                  | 5           | 1          | 65     |
| 16                  | 5           | 2          | 67     |
| 17                  | 5           | 3          | 60     |
| 18                  | 6           | 1          | 90     |
| 19                  | 6           | 2          | 92     |
| 20                  | 6           | 3          | 88     |
| 21                  | 6           | 4          | 94     |

*—Ç–∞–±–ª–∏—Ü–∞ achievement*

| achievement_id | name_achievement      | bonus |
|:---------------:|:---------------:|:---------------:|
| 1              | –ó–æ–ª–æ—Ç–∞—è –º–µ–¥–∞–ª—å        | 5     |
| 2              | –°–µ—Ä–µ–±—Ä—è–Ω–∞—è –º–µ–¥–∞–ª—å     | 3     |
| 3              | –ó–æ–ª–æ—Ç–æ–π –∑–Ω–∞—á–æ–∫ –ì–¢–û    | 3     |
| 4              | –°–µ—Ä–µ–±—Ä—è–Ω—ã–π –∑–Ω–∞—á–æ–∫ –ì–¢–û | 1     |

*—Ç–∞–±–ª–∏—Ü–∞ enrollee_achievement*

| enrollee_achiev_id | enrollee_id | achievement_id |
|:---------------:|:---------------:|:---------------:|
| 1                  | 1           | 2              |
| 2                  | 1           | 3              |
| 3                  | 3           | 1              |
| 4                  | 4           | 4              |
| 5                  | 5           | 1              |
| 6                  | 5           | 3              |

‚úî`–†–ï–®–ï–ù–ò–ï` ‚§µÔ∏è

```sql
SELECT 
  name_program, 
  name_enrollee 
FROM 
  enrollee 
  JOIN program_enrollee USING(enrollee_id) 
  JOIN program USING(program_id) 
  JOIN program_subject USING(program_id) 
  JOIN subject USING(subject_id) 
  JOIN enrollee_subject USING(subject_id, enrollee_id) 
WHERE 
  result < min_result 
GROUP BY 
  1, 
  2 
ORDER BY 
  1, 
  2;
```

üîé `–†–ï–ó–£–õ–¨–¢–ê–¢` ‚§µÔ∏è

| name_program                | name_enrollee |
|:---------------:|:---------------:|
| –ú–µ—Ö–∞—Ç—Ä–æ–Ω–∏–∫–∞ –∏ —Ä–æ–±–æ—Ç–æ—Ç–µ—Ö–Ω–∏–∫–∞ | –ë–∞—Ä–∞–Ω–æ–≤ –ü–∞–≤–µ–ª |
| –ü—Ä–∏–∫–ª–∞–¥–Ω–∞—è –º–µ—Ö–∞–Ω–∏–∫–∞         | –ë–∞—Ä–∞–Ω–æ–≤ –ü–∞–≤–µ–ª |

---

## 3.4 –ë–∞–∑–∞ –¥–∞–Ω–Ω—ã—Ö ¬´–ê–±–∏—Ç—É—Ä–∏–µ–Ω—Ç¬ª, –∑–∞–ø—Ä–æ—Å—ã –∫–æ—Ä—Ä–µ–∫—Ç–∏—Ä–æ–≤–∫–∏

‚ú≥ –®–∞–≥ 2. 

‚ùì*–ó–∞–¥–∞–Ω–∏–µ. –°–æ–∑–¥–∞—Ç—å –≤—Å–ø–æ–º–æ–≥–∞—Ç–µ–ª—å–Ω—É—é —Ç–∞–±–ª–∏—Ü—É applicant,  –∫—É–¥–∞ –≤–∫–ª—é—á–∏—Ç—å id –æ–±—Ä–∞–∑–æ–≤–∞—Ç–µ–ª—å–Ω–æ–π –ø—Ä–æ–≥—Ä–∞–º–º—ã, id –∞–±–∏—Ç—É—Ä–∏–µ–Ω—Ç–∞, —Å—É–º–º—É –±–∞–ª–ª–æ–≤ –∞–±–∏—Ç—É—Ä–∏–µ–Ω—Ç–æ–≤ (—Å—Ç–æ–ª–±–µ—Ü itog) –≤ –æ—Ç—Å–æ—Ä—Ç–∏—Ä–æ–≤–∞–Ω–Ω–æ–º —Å–Ω–∞—á–∞–ª–∞ –ø–æ id –æ–±—Ä–∞–∑–æ–≤–∞—Ç–µ–ª—å–Ω–æ–π –ø—Ä–æ–≥—Ä–∞–º–º—ã, –∞ –ø–æ—Ç–æ–º –ø–æ —É–±—ã–≤–∞–Ω–∏—é —Å—É–º–º—ã –±–∞–ª–ª–æ–≤ –≤–∏–¥–µ (–∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –∑–∞–ø—Ä–æ—Å –∏–∑ –ø—Ä–µ–¥—ã–¥—É—â–µ–≥–æ —É—Ä–æ–∫–∞).*

*–§—Ä–∞–≥–º–µ–Ω—Ç –ª–æ–≥–∏—á–µ—Å–∫–æ–π —Å—Ö–µ–º—ã –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö:*

![](https://ucarecdn.com/f80c65d2-82b4-4ae7-8036-3181302256ee/)

‚úî`–†–ï–®–ï–ù–ò–ï` ‚§µÔ∏è

```sql
CREATE TABLE applicant AS 
SELECT 
  program_id, 
  enrollee_subject.enrollee_id, 
  SUM(result) AS itog 
FROM 
  program_enrollee 
  JOIN enrollee_subject USING(enrollee_id) 
  JOIN program_subject USING(program_id, subject_id) 
  JOIN enrollee USING(enrollee_id) 
  JOIN program USING(program_id) 
GROUP BY 
  1, 
  2 
ORDER BY 
  1, 
  3 DESC;
SELECT 
  * 
FROM 
  applicant;
```

üîé `–†–ï–ó–£–õ–¨–¢–ê–¢` ‚§µÔ∏è

| program_id | enrollee_id | itog |
|:---------------:|:---------------:|:---------------:|
| 1          | 3           | 230  |
| 1          | 2           | 226  |
| 1          | 1           | 213  |
| 2          | 6           | 276  |
| 2          | 3           | 230  |
| 2          | 2           | 226  |
| 3          | 6           | 270  |
| 3          | 4           | 238  |
| 3          | 5           | 192  |
| 3          | 1           | 179  |
| 4          | 6           | 270  |
| 4          | 3           | 242  |
| 4          | 5           | 192  |
| 4          | 1           | 179  |

---

‚ú≥ –®–∞–≥ 3. 

‚ùì*–ó–∞–¥–∞–Ω–∏–µ. –ò–∑ —Ç–∞–±–ª–∏—Ü—ã applicant, —Å–æ–∑–¥–∞–Ω–Ω–æ–π –Ω–∞ –ø—Ä–µ–¥—ã–¥—É—â–µ–º —à–∞–≥–µ, —É–¥–∞–ª–∏—Ç—å –∑–∞–ø–∏—Å–∏, –µ—Å–ª–∏ –∞–±–∏—Ç—É—Ä–∏–µ–Ω—Ç –Ω–∞ –≤—ã–±—Ä–∞–Ω–Ω—É—é –æ–±—Ä–∞–∑–æ–≤–∞—Ç–µ–ª—å–Ω—É—é –ø—Ä–æ–≥—Ä–∞–º–º—É –Ω–µ –Ω–∞–±—Ä–∞–ª –º–∏–Ω–∏–º–∞–ª—å–Ω–æ–≥–æ –±–∞–ª–ª–∞ —Ö–æ—Ç—è –±—ã –ø–æ –æ–¥–Ω–æ–º—É –ø—Ä–µ–¥–º–µ—Ç—É (–∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –∑–∞–ø—Ä–æ—Å –∏–∑ –ø—Ä–µ–¥—ã–¥—É—â–µ–≥–æ —É—Ä–æ–∫–∞).*

*–§—Ä–∞–≥–º–µ–Ω—Ç –ª–æ–≥–∏—á–µ—Å–∫–æ–π —Å—Ö–µ–º—ã –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö:*

![](https://ucarecdn.com/823d0242-0982-4087-b52b-94aabc9bbb94/)

*—Ç–∞–±–ª–∏—Ü–∞ applicant:*

![](https://ucarecdn.com/de0838ba-43ec-4cf8-a237-fad5de177b5a/)

‚úî`–†–ï–®–ï–ù–ò–ï` ‚§µÔ∏è

```sql
DELETE FROM 
  applicant USING applicant 
  JOIN program_subject USING(program_id) 
  JOIN enrollee_subject USING(subject_id, enrollee_id) 
WHERE 
  result < min_result;
SELECT 
  * 
FROM 
  applicant;
```

üîé `–†–ï–ó–£–õ–¨–¢–ê–¢` ‚§µÔ∏è

| program_id | enrollee_id | itog |
|:---------------:|:---------------:|:---------------:|
| 1          | 3           | 230  |
| 1          | 2           | 226  |
| 1          | 1           | 213  |
| 2          | 6           | 276  |
| 2          | 3           | 230  |
| 2          | 2           | 226  |
| 3          | 6           | 270  |
| 3          | 4           | 238  |
| 3          | 5           | 192  |
| 4          | 6           | 270  |
| 4          | 3           | 242  |
| 4          | 5           | 192  |

---

‚ú≥ –®–∞–≥ 4. 

‚ùì*–ó–∞–¥–∞–Ω–∏–µ. –ü–æ–≤—ã—Å–∏—Ç—å –∏—Ç–æ–≥–æ–≤—ã–µ –±–∞–ª–ª—ã –∞–±–∏—Ç—É—Ä–∏–µ–Ω—Ç–æ–≤ –≤ —Ç–∞–±–ª–∏—Ü–µ applicant –Ω–∞ –∑–Ω–∞—á–µ–Ω–∏—è –¥–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã—Ö –±–∞–ª–ª–æ–≤ (–∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –∑–∞–ø—Ä–æ—Å –∏–∑ –ø—Ä–µ–¥—ã–¥—É—â–µ–≥–æ —É—Ä–æ–∫–∞).*

*–§—Ä–∞–≥–º–µ–Ω—Ç –ª–æ–≥–∏—á–µ—Å–∫–æ–π —Å—Ö–µ–º—ã –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö:*

![](https://ucarecdn.com/14d04390-f8c1-4245-be43-dfb319b12ffc/)

*–°—Ç—Ä—É–∫—Ç—É—Ä–∞ –∫–æ—Ä—Ä–µ–∫—Ç–∏—Ä—É–µ–º–æ–π —Ç–∞–±–ª–∏—Ü—ã:*

![](https://ucarecdn.com/72ed7dbb-3a6c-450f-8825-37071fd73eb3/)

‚úî`–†–ï–®–ï–ù–ò–ï` ‚§µÔ∏è

```sql
UPDATE 
  applicant 
  JOIN (
    SELECT 
      enrollee_id, 
      IFNULL(
        SUM(bonus), 
        0
      ) AS Bonus2 
    FROM 
      enrollee_achievement 
      JOIN achievement USING(achievement_id) 
    GROUP BY 
      enrollee_id
  ) AS t USING(enrollee_id) 
SET 
  itog = itog + Bonus2;
SELECT 
  * 
FROM 
  applicant;
```

üîé `–†–ï–ó–£–õ–¨–¢–ê–¢` ‚§µÔ∏è

| program_id | enrollee_id | itog |
|:---------------:|:---------------:|:---------------:|
| 1          | 3           | 235  |
| 1          | 2           | 226  |
| 1          | 1           | 219  |
| 2          | 6           | 276  |
| 2          | 3           | 235  |
| 2          | 2           | 226  |
| 3          | 6           | 270  |
| 3          | 4           | 239  |
| 3          | 5           | 200  |
| 4          | 6           | 270  |
| 4          | 3           | 247  |
| 4          | 5           | 200  |

---

‚ú≥ –®–∞–≥ 5. 

‚ùì*–ó–∞–¥–∞–Ω–∏–µ. –ü–æ—Å–∫–æ–ª—å–∫—É –ø—Ä–∏ –¥–æ–±–∞–≤–ª–µ–Ω–∏–∏ –¥–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã—Ö –±–∞–ª–ª–æ–≤, –∞–±–∏—Ç—É—Ä–∏–µ–Ω—Ç—ã –ø–æ –∫–∞–∂–¥–æ–π –æ–±—Ä–∞–∑–æ–≤–∞—Ç–µ–ª—å–Ω–æ–π –ø—Ä–æ–≥—Ä–∞–º–º–µ –º–æ–≥—É—Ç —Å–ª–µ–¥–æ–≤–∞—Ç—å –Ω–µ –≤ –ø–æ—Ä—è–¥–∫–µ —É–±—ã–≤–∞–Ω–∏—è —Å—É–º–º–∞—Ä–Ω—ã—Ö –±–∞–ª–ª–æ–≤, –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ —Å–æ–∑–¥–∞—Ç—å –Ω–æ–≤—É—é —Ç–∞–±–ª–∏—Ü—É applicant_order –Ω–∞ –æ—Å–Ω–æ–≤–µ —Ç–∞–±–ª–∏—Ü—ã applicant. –ü—Ä–∏ —Å–æ–∑–¥–∞–Ω–∏–∏ —Ç–∞–±–ª–∏—Ü—ã –¥–∞–Ω–Ω—ã–µ –Ω—É–∂–Ω–æ –æ—Ç—Å–æ—Ä—Ç–∏—Ä–æ–≤–∞—Ç—å —Å–Ω–∞—á–∞–ª–∞ –ø–æ id –æ–±—Ä–∞–∑–æ–≤–∞—Ç–µ–ª—å–Ω–æ–π –ø—Ä–æ–≥—Ä–∞–º–º—ã, –ø–æ—Ç–æ–º –ø–æ —É–±—ã–≤–∞–Ω–∏—é –∏—Ç–æ–≥–æ–≤–æ–≥–æ –±–∞–ª–ª–∞. –ê —Ç–∞–±–ª–∏—Ü—É applicant, –∫–æ—Ç–æ—Ä–∞—è –±—ã–ª–∞ —Å–æ–∑–¥–∞–Ω–∞ –∫–∞–∫ –≤—Å–ø–æ–º–æ–≥–∞—Ç–µ–ª—å–Ω–∞—è, –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ —É–¥–∞–ª–∏—Ç—å.*

*–°—Ç—Ä—É–∫—Ç—É—Ä–∞ –∫–æ—Ä—Ä–µ–∫—Ç–∏—Ä—É–µ–º–æ–π —Ç–∞–±–ª–∏—Ü—ã:*

![](https://ucarecdn.com/72ed7dbb-3a6c-450f-8825-37071fd73eb3/)

‚úî`–†–ï–®–ï–ù–ò–ï` ‚§µÔ∏è

```sql
CREATE TABLE applicant_order AS 
SELECT 
  program_id, 
  enrollee_id, 
  itog 
FROM 
  applicant 
ORDER BY 
  1, 
  3 DESC;
SELECT 
  * 
FROM 
  applicant_order;
DROP 
  TABLE applicant;
```

üîé `–†–ï–ó–£–õ–¨–¢–ê–¢` ‚§µÔ∏è

| program_id | enrollee_id | itog |
|:---------------:|:---------------:|:---------------:|
| 1          | 3           | 235  |
| 1          | 2           | 226  |
| 1          | 1           | 219  |
| 2          | 6           | 276  |
| 2          | 3           | 235  |
| 2          | 2           | 226  |
| 3          | 6           | 270  |
| 3          | 4           | 239  |
| 3          | 5           | 200  |
| 4          | 6           | 270  |
| 4          | 3           | 247  |
| 4          | 5           | 200  |

---

‚ú≥ –®–∞–≥ 6. 

‚ùì*–ó–∞–¥–∞–Ω–∏–µ. –í–∫–ª—é—á–∏—Ç—å –≤ —Ç–∞–±–ª–∏—Ü—É applicant_order –Ω–æ–≤—ã–π —Å—Ç–æ–ª–±–µ—Ü str_id —Ü–µ–ª–æ–≥–æ —Ç–∏–ø–∞ , —Ä–∞—Å–ø–æ–ª–æ–∂–∏—Ç—å –µ–≥–æ –ø–µ—Ä–µ–¥ –ø–µ—Ä–≤—ã–º.*

*–°—Ç—Ä—É–∫—Ç—É—Ä–∞ –∫–æ—Ä—Ä–µ–∫—Ç–∏—Ä—É–µ–º–æ–π —Ç–∞–±–ª–∏—Ü—ã:*

![](https://ucarecdn.com/56d55eb1-112b-406f-a961-a656d00f3258/)

‚úî`–†–ï–®–ï–ù–ò–ï` ‚§µÔ∏è

```sql
ALTER TABLE 
  applicant_order 
ADD 
  str_id int FIRST;
```

üîé `–†–ï–ó–£–õ–¨–¢–ê–¢` ‚§µÔ∏è

| str_id | program_id | enrollee_id | itog |
|:---------------:|:---------------:|:---------------:|:---------------:|
| Null   | 1          | 3           | 235  |
| Null   | 1          | 2           | 226  |
| Null   | 1          | 1           | 219  |
| Null   | 2          | 6           | 276  |
| Null   | 2          | 3           | 235  |
| Null   | 2          | 2           | 226  |
| Null   | 3          | 6           | 270  |
| Null   | 3          | 4           | 239  |
| Null   | 3          | 5           | 200  |
| Null   | 4          | 6           | 270  |
| Null   | 4          | 3           | 247  |
| Null   | 4          | 5           | 200  |

---

‚ú≥ –®–∞–≥ 7. 

‚ùì*–ó–∞–¥–∞–Ω–∏–µ. –ó–∞–Ω–µ—Å—Ç–∏ –≤ —Å—Ç–æ–ª–±–µ—Ü str_id —Ç–∞–±–ª–∏—Ü—ã applicant_order –Ω—É–º–µ—Ä–∞—Ü–∏—é –∞–±–∏—Ç—É—Ä–∏–µ–Ω—Ç–æ–≤, –∫–æ—Ç–æ—Ä–∞—è –Ω–∞—á–∏–Ω–∞–µ—Ç—Å—è —Å 1 –¥–ª—è –∫–∞–∂–¥–æ–π –æ–±—Ä–∞–∑–æ–≤–∞—Ç–µ–ª—å–Ω–æ–π –ø—Ä–æ–≥—Ä–∞–º–º—ã.*

*–°—Ç—Ä—É–∫—Ç—É—Ä–∞ –∫–æ—Ä—Ä–µ–∫—Ç–∏—Ä—É–µ–º–æ–π —Ç–∞–±–ª–∏—Ü—ã:*

![](https://ucarecdn.com/53f4570a-9e0b-4ae7-934b-d74795b99693/)

‚úî`–†–ï–®–ï–ù–ò–ï` ‚§µÔ∏è

```sql
SET 
  @row_num := 1;
SET 
  @num_pr := 0;
UPDATE 
  applicant_order 
SET 
  str_id = IF(
    program_id = @num_pr, 
    @row_num := @row_num + 1, 
    @row_num := 1 
    AND @num_pr := @num_pr + 1
  );
SELECT 
  * 
FROM 
  applicant_order;
```

üîé `–†–ï–ó–£–õ–¨–¢–ê–¢` ‚§µÔ∏è

| str_id | program_id | enrollee_id | itog |
|:---------------:|:---------------:|:---------------:|:---------------:|
| 1      | 1          | 3           | 235  |
| 2      | 1          | 2           | 226  |
| 3      | 1          | 1           | 219  |
| 1      | 2          | 6           | 276  |
| 2      | 2          | 3           | 235  |
| 3      | 2          | 2           | 226  |
| 1      | 3          | 6           | 270  |
| 2      | 3          | 4           | 239  |
| 3      | 3          | 5           | 200  |
| 1      | 4          | 6           | 270  |
| 2      | 4          | 3           | 247  |
| 3      | 4          | 5           | 200  |

---

‚ú≥ –®–∞–≥ 8. 

‚ùì*–ó–∞–¥–∞–Ω–∏–µ. –°–æ–∑–¥–∞—Ç—å —Ç–∞–±–ª–∏—Ü—É student,  –≤ –∫–æ—Ç–æ—Ä—É—é –≤–∫–ª—é—á–∏—Ç—å –∞–±–∏—Ç—É—Ä–∏–µ–Ω—Ç–æ–≤, –∫–æ—Ç–æ—Ä—ã–µ –º–æ–≥—É—Ç –±—ã—Ç—å —Ä–µ–∫–æ–º–µ–Ω–¥–æ–≤–∞–Ω—ã –∫ –∑–∞—á–∏—Å–ª–µ–Ω–∏—é  –≤ —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤–∏–∏ —Å –ø–ª–∞–Ω–æ–º –Ω–∞–±–æ—Ä–∞. –ò–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é –æ—Ç—Å–æ—Ä—Ç–∏—Ä–æ–≤–∞—Ç—å —Å–Ω–∞—á–∞–ª–∞ –≤ –∞–ª—Ñ–∞–≤–∏—Ç–Ω–æ–º –ø–æ—Ä—è–¥–∫–µ –ø–æ –Ω–∞–∑–≤–∞–Ω–∏—é –ø—Ä–æ–≥—Ä–∞–º–º, –∞ –ø–æ—Ç–æ–º –ø–æ —É–±—ã–≤–∞–Ω–∏—é –∏—Ç–æ–≥–æ–≤–æ–≥–æ –±–∞–ª–ª–∞.*

*–§—Ä–∞–≥–º–µ–Ω—Ç –ª–æ–≥–∏—á–µ—Å–∫–æ–π —Å—Ö–µ–º—ã –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö:*

![](https://ucarecdn.com/21cacbbd-ab78-4347-b1a4-1df3791c875c/)

‚úî`–†–ï–®–ï–ù–ò–ï` ‚§µÔ∏è

```sql
CREATE TABLE student 
SELECT 
  name_program, 
  name_enrollee, 
  itog 
FROM 
  enrollee 
  JOIN applicant_order USING(enrollee_id) 
  JOIN program USING(program_id) 
WHERE 
  str_id <= plan 
ORDER BY 
  name_program, 
  itog DESC;
SELECT 
  * 
FROM 
  student;
```

üîé `–†–ï–ó–£–õ–¨–¢–ê–¢` ‚§µÔ∏è

|name_program                        | name_enrollee   | itog |
|:---------------:|:---------------:|:---------------:|
| –ú–∞—Ç–µ–º–∞—Ç–∏–∫–∞ –∏ –∫–æ–º–ø—å—é—Ç–µ—Ä–Ω—ã–µ –Ω–∞—É–∫–∏     | –°—Ç–µ–ø–∞–Ω–æ–≤–∞ –î–∞—Ä—å—è | 276  |
| –ú–µ—Ö–∞—Ç—Ä–æ–Ω–∏–∫–∞ –∏ —Ä–æ–±–æ—Ç–æ—Ç–µ—Ö–Ω–∏–∫–∞         | –°—Ç–µ–ø–∞–Ω–æ–≤–∞ –î–∞—Ä—å—è | 270  |
| –ú–µ—Ö–∞—Ç—Ä–æ–Ω–∏–∫–∞ –∏ —Ä–æ–±–æ—Ç–æ—Ç–µ—Ö–Ω–∏–∫–∞         | –°–µ–º–µ–Ω–æ–≤ –ò–≤–∞–Ω    | 247  |
| –ú–µ—Ö–∞—Ç—Ä–æ–Ω–∏–∫–∞ –∏ —Ä–æ–±–æ—Ç–æ—Ç–µ—Ö–Ω–∏–∫–∞         | –ü–æ–ø–æ–≤ –ò–ª—å—è      | 200  |
| –ü—Ä–∏–∫–ª–∞–¥–Ω–∞—è –º–∞—Ç–µ–º–∞—Ç–∏–∫–∞ –∏ –∏–Ω—Ñ–æ—Ä–º–∞—Ç–∏–∫–∞ | –°–µ–º–µ–Ω–æ–≤ –ò–≤–∞–Ω    | 235  |
| –ü—Ä–∏–∫–ª–∞–¥–Ω–∞—è –º–∞—Ç–µ–º–∞—Ç–∏–∫–∞ –∏ –∏–Ω—Ñ–æ—Ä–º–∞—Ç–∏–∫–∞ | –ê–±—Ä–∞–º–æ–≤–∞ –ö–∞—Ç—è   | 226  |
| –ü—Ä–∏–∫–ª–∞–¥–Ω–∞—è –º–µ—Ö–∞–Ω–∏–∫–∞                 | –°—Ç–µ–ø–∞–Ω–æ–≤–∞ –î–∞—Ä—å—è | 270  |
| –ü—Ä–∏–∫–ª–∞–¥–Ω–∞—è –º–µ—Ö–∞–Ω–∏–∫–∞                 | –Ø–∫–æ–≤–ª–µ–≤–∞ –ì–∞–ª–∏–Ω–∞ | 239  |

---

## 3.5 –ë–∞–∑–∞ –¥–∞–Ω–Ω—ã—Ö "–£—á–µ–±–Ω–∞—è –∞–Ω–∞–ª–∏—Ç–∏–∫–∞ –ø–æ –∫—É—Ä—Å—É"

–ö—É—Ä—Å –Ω–∞ –ø–ª–∞—Ç—Ñ–æ—Ä–º–µ Stepik —Å–æ—Å—Ç–æ–∏—Ç –∏–∑ –Ω–µ—Å–∫–æ–ª—å–∫–∏—Ö –º–æ–¥—É–ª–µ–π, –∫–∞–∂–¥—ã–π –º–æ–¥—É–ª—å –≤–∫–ª—é—á–∞–µ—Ç –Ω–µ—Å–∫–æ–ª—å–∫–æ —É—Ä–æ–∫–æ–≤, –¥–ª—è –∫–∞–∂–¥–æ–≥–æ —É—Ä–æ–∫–∞ —Ö—Ä–∞–Ω–∏—Ç—Å—è –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è –æ –µ–≥–æ –ø–æ–ª–æ–∂–µ–Ω–∏–∏ –≤ –º–æ–¥—É–ª–µ. –ö–∞–∂–¥—ã–π —É—Ä–æ–∫ —Å–æ—Å—Ç–æ–∏—Ç –∏–∑ –ø–æ—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å–Ω–æ—Å—Ç–∏ —à–∞–≥–æ–≤. –ö–∞–∂–¥—ã–π —à–∞–≥ –∏–º–µ–µ—Ç —Å–≤–æ–π —Ç–∏–ø (—ç—Ç–æ –º–æ–∂–µ—Ç –±—ã—Ç—å —Ç–µ–∫—Å—Ç, –∑–∞–¥–∞–Ω–∏–µ –Ω–∞ SQL –∏ –ø—Ä.) –∏ —Ç–∞–∫–∂–µ –ø–æ—Ä—è–¥–∫–æ–≤—ã–π –Ω–æ–º–µ—Ä –≤ —É—Ä–æ–∫–µ.

–ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–∏ —Ä–µ–≥–∏—Å—Ç—Ä–∏—Ä—É—é—Ç—Å—è –Ω–∞ –∫—É—Ä—Å–µ, —É–∫–∞–∑—ã–≤–∞—é—Ç —Å–≤–æ–µ –∏–º—è. –ö–æ–≥–¥–∞ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –ø—Ä–æ—Ö–æ–¥–∏—Ç –∫—É—Ä—Å –Ω–∞ –ø–ª–∞—Ç—Ñ–æ—Ä–º–µ Stepik, –≤—Å–µ –µ–≥–æ –¥–µ–π—Å—Ç–≤–∏—è –æ—Å—Ç–∞–≤–ª—è—é—Ç "—Ü–∏—Ñ—Ä–æ–≤–æ–π —Å–ª–µ–¥": –∫–∞–∫–∏–µ –∑–∞–¥–∞–Ω–∏—è –∏ –∫–æ–≥–¥–∞ –æ–Ω –≤—ã–ø–æ–ª–Ω–∏–ª, —Å–∫–æ–ª—å–∫–æ –ø–æ–ø—ã—Ç–æ–∫ —Å–¥–µ–ª–∞–ª, –ø—Ä–∞–≤–∏–ª—å–Ω–æ –ª–∏ —Ä–µ—à–∏–ª –∑–∞–¥–∞–Ω–∏–µ. –¢–∞–∫–∂–µ —Ö—Ä–∞–Ω—è—Ç—Å—è –≤—Å–µ –µ–≥–æ –∫–æ–º–º–µ–Ω—Ç–∞—Ä–∏–∏. –ï—Å–ª–∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –ø—Ä–æ—Ö–æ–¥–∏—Ç –∫—É—Ä—Å –∏ –ø–æ–ª—É—á–∞–µ—Ç —Å–µ—Ä—Ç–∏—Ñ–∏–∫–∞—Ç, —Ç–æ —Å–æ—Ö—Ä–∞–Ω—è–µ—Ç—Å—è –¥–∞—Ç–∞ –µ–≥–æ –≤—ã–¥–∞—á–∏. –í—Å—è —ç—Ç–∞ –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è —è–≤–ª—è–µ—Ç—Å—è –ø–µ—Ä–≤–∏—á–Ω–æ–π –¥–ª—è —É—á–µ–±–Ω–æ–π –∞–Ω–∞–ª–∏—Ç–∏–∫–∏.

–£—á–µ–±–Ω–∞—è –∞–Ω–∞–ª–∏—Ç–∏–∫–∞ ‚Äì —ç—Ç–æ –∏–∑–º–µ—Ä–µ–Ω–∏–µ, —Å–±–æ—Ä, –∞–Ω–∞–ª–∏–∑ –∏ –ø—Ä–µ–¥—Å—Ç–∞–≤–ª–µ–Ω–∏–µ –¥–∞–Ω–Ω—ã—Ö –æ–± –æ–±—É—á–∞—é—â–∏—Ö—Å—è –∏ –∏—Ö –¥–µ–π—Å—Ç–≤–∏—è—Ö –Ω–∞ online –ø–ª–∞—Ç—Ñ–æ—Ä–º–µ —Å —Ü–µ–ª—å—é –ø–æ–Ω–∏–º–∞–Ω–∏—è –∏ –æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏–∏ —É—á–µ–±–Ω–æ–≥–æ –ø—Ä–æ—Ü–µ—Å—Å–∞ –∏ —Ç–æ–π —Å—Ä–µ–¥—ã, –≥–¥–µ —ç—Ç–æ—Ç –ø—Ä–æ—Ü–µ—Å—Å –ø—Ä–æ–∏—Å—Ö–æ–¥–∏—Ç.

–î–ª—è –¥–∞–Ω–Ω–æ–≥–æ —É—Ä–æ–∫–∞ –±—ã–ª–∞ —Å–æ–∑–¥–∞–Ω–∞ –±–∞–∑–∞ –¥–∞–Ω–Ω—ã—Ö —Å –ø–æ–ª–Ω—ã–º –æ–ø–∏—Å–∞–Ω–∏–µ–º —Å—Ç—Ä—É–∫—Ç—É—Ä—ã –∫—É—Ä—Å–∞. –£—á–µ–±–Ω–∞—è –∞–Ω–∞–ª–∏—Ç–∏–∫–∞ –∂–µ –≤–∫–ª—é—á–µ–Ω–∞ –≤ –±–∞–∑—É –Ω–µ –≤ –ø–æ–ª–Ω–æ–º –æ–±—ä–µ–º–µ, –∞ —Ç–æ–ª—å–∫–æ –¥–ª—è –Ω–µ–∫–æ—Ç–æ—Ä–æ–π –≥—Ä—É–ø–ø—ã –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π –∏–∑-–∑–∞ –±–æ–ª—å—à–æ–≥–æ –æ–±—ä–µ–º–∞ –¥–∞–Ω–Ω—ã—Ö. –¢–∞–∫, –Ω–∞–ø—Ä–∏–º–µ—Ä, –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è –æ —Ä–µ—à–µ–Ω–∏—è—Ö 17000 –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π –ø–æ –Ω–∞—à–µ–º—É –∫—É—Ä—Å—É –∑–∞ –ø–æ–ª–≥–æ–¥–∞ –µ–≥–æ —Å—É—â–µ—Å—Ç–≤–æ–≤–∞–Ω–∏—è —Å–æ–¥–µ—Ä–∂–∏—Ç 534500 –∑–∞–ø–∏—Å–µ–π. 

–ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π –¥–ª—è –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö —É—Ä–æ–∫–∞ –º—ã –æ—Ç–æ–±—Ä–∞–ª–∏ —Ç–∞–∫:

–æ—Ç–±—Ä–æ—Å–∏–ª–∏ –≤—Å–µ—Ö, –∫—Ç–æ –Ω–µ –≤—ã–ø–æ–ª–Ω–∏–ª –Ω–∏ –æ–¥–Ω–æ–≥–æ –∑–∞–¥–∞–Ω–∏—è (–∏—Ö –æ–∫–∞–∑–∞–ª–æ—Å—å 8800);
—Å–≥—Ä—É–ø–ø–∏—Ä–æ–≤–∞–ª–∏ –æ—Å—Ç–∞–≤—à–∏—Ö—Å—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π –≤ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ –æ—Ç –∫–æ–ª–∏—á–µ—Å—Ç–≤–∞ —Ä–µ—à–µ–Ω–Ω—ã—Ö –∑–∞–¥–∞–Ω–∏–π, –≤–æ—Ç —á—Ç–æ –ø–æ–ª—É—á–∏–ª–æ—Å—å (—Å—á–∏—Ç–∞–µ–º, —á—Ç–æ —Ç–µ, –∫—Ç–æ –Ω–µ –æ—Ç—Å—ã–ª–∞–ª –∑–∞–¥–∞–Ω–∏—è –±–æ–ª—å—à–µ –º–µ—Å—è—Ü–∞, –ø–æ–∫–∏–Ω—É–ª–∏ –∫—É—Ä—Å):

|	|–í—Å–µ–≥–æ	|–ó–∞–∫–æ–Ω—á–∏–ª–∏ –æ–±—É—á–µ–Ω–∏–µ –∏–ª–∏ –ø–æ–∫–∏–Ω—É–ª–∏ –∫—É—Ä—Å |–ê–∫—Ç–∏–≤–Ω—ã–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–∏|
|:---------------:|:---------------:|:---------------:|:---------------:|
|–í—ã–ø–æ–ª–Ω–∏–ª–∏ –≤—Å–µ –∑–∞–¥–∞–Ω–∏—è	|116	|75	|41|
|–ü–æ–ª—É—á–∏–ª–∏ —Å–µ—Ä—Ç–∏—Ñ–∏–∫–∞—Ç	|617	|470	|147|
|–¢—Ä–µ—Ç–∏–π –º–æ–¥—É–ª—å	|225	|220	|5|
|–í—Ç–æ—Ä–æ–π –º–æ–¥—É–ª—å	|940	|762	|178|
|–ü–µ—Ä–≤—ã–π –º–æ–¥—É–ª—å, 5-7 —É—Ä–æ–∫	|1077	|891	|186|
|–ü–µ—Ä–≤—ã–π –º–æ–¥—É–ª—å, 4 —É—Ä–æ–∫	|701	|589	|112|
|–ü–µ—Ä–≤—ã–π –º–æ–¥—É–ª—å, 3 —É—Ä–æ–∫	|823	|670	|153|
|–ü–µ—Ä–≤—ã–π –º–æ–¥—É–ª—å, 2 —É—Ä–æ–∫	|1268	|1044	|224|
|–ü–µ—Ä–≤—ã–π –º–æ–¥—É–ª—å, 1 —É—Ä–æ–∫	|2430	|2020	|410|

+ –∑–∞—Ç–µ–º –æ—Ç–æ–±—Ä–∞–ª–∏ —Ç–∏–ø–∏—á–Ω—ã—Ö –ø—Ä–µ–¥—Å—Ç–∞–≤–∏—Ç–µ–ª–µ–π –≥—Ä—É–ø–ø –±–æ–ª–µ–µ –∏–ª–∏ –º–µ–Ω–µ–µ –ø—Ä–æ–ø–æ—Ä—Ü–∏–æ–Ω–∞–ª—å–Ω–æ —á–∏—Å–ª–µ–Ω–Ω–æ—Å—Ç–∏ –∫–∞–∂–¥–æ–π –≥—Ä—É–ø–ø—ã (–∏–º–µ–Ω–∞ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π, –∫–æ–Ω–µ—á–Ω–æ, –∑–∞–º–µ–Ω–∏–ª–∏);
+ –ø–æ—Å–∫–æ–ª—å–∫—É –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–∏ –æ—Ç–ø—Ä–∞–≤–ª—è–ª–∏ –æ—Ç 1 –¥–æ 1000 —Ä–µ—à–µ–Ω–∏–π –∑–∞ –≤—Ä–µ–º—è –ø—Ä–æ—Ö–æ–∂–¥–µ–Ω–∏—è –∫—É—Ä—Å–∞, –≤ –±–∞–∑—É –≤–∫–ª—é—á–∏–ª–∏ —Ç–æ–ª—å–∫–æ –ø–æ–ø—ã—Ç–∫–∏  —à–∞–≥–æ–≤, –æ—Ç–Ω–æ—Å—è—â–∏—Ö—Å—è –∫ —É—Ä–æ–∫–∞–º 1.2, 2.2 –∏ 2.4.
–ü–æ–ª—É—á–∏–ª–æ—Å—å 64 –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è –∏ –±–æ–ª–µ–µ 2000 –∏—Ö –ø–æ–ø—ã—Ç–æ

[–ù–∞–ø–æ–ª–Ω–µ–Ω–∏–µ —Ç–∞–±–ª–∏—Ü](https://stepik.org/lesson/404275/step/1?unit=393473)

‚ú≥ –®–∞–≥ 2. 

‚ùì*–ó–∞–¥–∞–Ω–∏–µ. –û—Ç–æ–±—Ä–∞—Ç—å –≤—Å–µ —à–∞–≥–∏, –≤ –∫–æ—Ç–æ—Ä—ã—Ö —Ä–∞—Å—Å–º–∞—Ç—Ä–∏–≤–∞—é—Ç—Å—è –≤–ª–æ–∂–µ–Ω–Ω—ã–µ –∑–∞–ø—Ä–æ—Å—ã (—Ç–æ –µ—Å—Ç—å –≤ –Ω–∞–∑–≤–∞–Ω–∏–∏ —à–∞–≥–∞ —É–ø–æ–º–∏–Ω–∞—é—Ç—Å—è –≤–ª–æ–∂–µ–Ω–Ω—ã–µ –∑–∞–ø—Ä–æ—Å—ã). –£–∫–∞–∑–∞—Ç—å –∫ –∫–∞–∫–æ–º—É —É—Ä–æ–∫—É –∏ –º–æ–¥—É–ª—é –æ–Ω–∏ –æ—Ç–Ω–æ—Å—è—Ç—Å—è. –î–ª—è —ç—Ç–æ–≥–æ –≤—ã–≤–µ—Å—Ç–∏ 3 –ø–æ–ª—è:*   
+ *–≤ –ø–æ–ª–µ –ú–æ–¥—É–ª—å —É–∫–∞–∑–∞—Ç—å –Ω–æ–º–µ—Ä –º–æ–¥—É–ª—è –∏ –µ–≥–æ –Ω–∞–∑–≤–∞–Ω–∏–µ —á–µ—Ä–µ–∑ –ø—Ä–æ–±–µ–ª;*  
+ *–≤ –ø–æ–ª–µ –£—Ä–æ–∫ —É–∫–∞–∑–∞—Ç—å –Ω–æ–º–µ—Ä –º–æ–¥—É–ª—è, –ø–æ—Ä—è–¥–∫–æ–≤—ã–π –Ω–æ–º–µ—Ä —É—Ä–æ–∫–∞ (lesson_position) —á–µ—Ä–µ–∑ —Ç–æ—á–∫—É –∏ –Ω–∞–∑–≤–∞–Ω–∏–µ —É—Ä–æ–∫–∞ —á–µ—Ä–µ–∑ –ø—Ä–æ–±–µ–ª;*  
+ *–≤ –ø–æ–ª–µ –®–∞–≥ —É–∫–∞–∑–∞—Ç—å –Ω–æ–º–µ—Ä –º–æ–¥—É–ª—è, –ø–æ—Ä—è–¥–∫–æ–≤—ã–π –Ω–æ–º–µ—Ä —É—Ä–æ–∫–∞ (lesson_position) —á–µ—Ä–µ–∑ —Ç–æ—á–∫—É, –ø–æ—Ä—è–¥–∫–æ–≤—ã–π –Ω–æ–º–µ—Ä —à–∞–≥–∞ (step_position) —á–µ—Ä–µ–∑ —Ç–æ—á–∫—É –∏ –Ω–∞–∑–≤–∞–Ω–∏–µ —à–∞–≥–∞ —á–µ—Ä–µ–∑ –ø—Ä–æ–±–µ–ª.*

*–î–ª–∏–Ω—É –ø–æ–ª–µ–π –ú–æ–¥—É–ª—å –∏ –£—Ä–æ–∫ –æ–≥—Ä–∞–Ω–∏—á–∏—Ç—å 19 —Å–∏–º–≤–æ–ª–∞–º–∏, –ø—Ä–∏ —ç—Ç–æ–º —Å–ª–∏—à–∫–æ–º –¥–ª–∏–Ω–Ω—ã–µ –Ω–∞–¥–ø–∏—Å–∏ –æ–±–æ–∑–Ω–∞—á–∏—Ç—å –º–Ω–æ–≥–æ—Ç–æ—á–∏–µ–º –≤ –∫–æ–Ω—Ü–µ (16 —Å–∏–º–≤–æ–ª–æ–≤ - —ç—Ç–æ –Ω–æ–º–µ—Ä –º–æ–¥—É–ª—è –∏–ª–∏ —É—Ä–æ–∫–∞, –ø—Ä–æ–±–µ–ª –∏  –Ω–∞–∑–≤–∞–Ω–∏–µ –£—Ä–æ–∫–∞ –∏–ª–∏ –ú–æ–¥—É–ª—è –∫ –Ω–∏–º –ø—Ä–∏—Å–æ–µ–¥–∏–Ω–∏—Ç—å "..."). –ò–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é –æ—Ç—Å–æ—Ä—Ç–∏—Ä–æ–≤–∞—Ç—å –ø–æ –≤–æ–∑—Ä–∞—Å—Ç–∞–Ω–∏—é –Ω–æ–º–µ—Ä–æ–≤ –º–æ–¥—É–ª–µ–π, –ø–æ—Ä—è–¥–∫–æ–≤—ã—Ö –Ω–æ–º–µ—Ä–æ–≤ —É—Ä–æ–∫–æ–≤ –∏ –ø–æ—Ä—è–¥–∫–æ–≤—ã—Ö –Ω–æ–º–µ—Ä–æ–≤ —à–∞–≥–æ–≤.*

*–§—Ä–∞–≥–º–µ–Ω—Ç –ª–æ–≥–∏—á–µ—Å–∫–æ–π —Å—Ö–µ–º—ã –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö:*

![](https://ucarecdn.com/da5f161d-0dd9-497c-a9fd-3c3a94ee45b8/)

‚úî`–†–ï–®–ï–ù–ò–ï` ‚§µÔ∏è

```sql
SELECT 
  CONCAT(
    LEFT(
      CONCAT(module_id, ' ', module_name), 
      16
    ), 
    '...'
  ) AS –ú–æ–¥—É–ª—å, 
  CONCAT(
    LEFT(
      CONCAT(
        module_id, '.', lesson_position, ' ', 
        lesson_name
      ), 
      16
    ), 
    '...'
  ) AS –£—Ä–æ–∫, 
  CONCAT(
    module_id, '.', lesson_position, '.', 
    step_position, ' ', step_name
  ) AS –®–∞–≥ 
FROM 
  module 
  JOIN lesson USING(module_id) 
  JOIN step USING(lesson_id) 
WHERE 
  step_name LIKE '%–ª–æ–∂–µ–Ω–Ω% –∑–∞–ø—Ä–æ—Å%' 
ORDER BY 
  module_id, 
  lesson_id, 
  step_id;
```

üîé `–†–ï–ó–£–õ–¨–¢–ê–¢` ‚§µÔ∏è

| –ú–æ–¥—É–ª—å              | –£—Ä–æ–∫                | –®–∞–≥                                                         |
|:---------------:|:---------------:|:---------------:|
| 1 –û—Å–Ω–æ–≤—ã —Ä–µ–ª—è—Ü–∏–æ... | 1.4 –í–ª–æ–∂–µ–Ω–Ω—ã–µ –∑–∞... | 1.4.2 –í–ª–æ–∂–µ–Ω–Ω—ã–π –∑–∞–ø—Ä–æ—Å, –≤–æ–∑–≤—Ä–∞—â–∞—é—â–∏–π –æ–¥–Ω–æ –∑–Ω–∞—á–µ–Ω–∏–µ          |
| 1 –û—Å–Ω–æ–≤—ã —Ä–µ–ª—è—Ü–∏–æ... | 1.4 –í–ª–æ–∂–µ–Ω–Ω—ã–µ –∑–∞... | 1.4.3 –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ –≤–ª–æ–∂–µ–Ω–Ω–æ–≥–æ –∑–∞–ø—Ä–æ—Å–∞ –≤ –≤—ã—Ä–∞–∂–µ–Ω–∏–∏          |
| 1 –û—Å–Ω–æ–≤—ã —Ä–µ–ª—è—Ü–∏–æ... | 1.4 –í–ª–æ–∂–µ–Ω–Ω—ã–µ –∑–∞... | 1.4.4 –í–ª–æ–∂–µ–Ω–Ω—ã–π –∑–∞–ø—Ä–æ—Å, –æ–ø–µ—Ä–∞—Ç–æ—Ä IN                         |
| 1 –û—Å–Ω–æ–≤—ã —Ä–µ–ª—è—Ü–∏–æ... | 1.4 –í–ª–æ–∂–µ–Ω–Ω—ã–µ –∑–∞... | 1.4.5 –í–ª–æ–∂–µ–Ω–Ω—ã–π –∑–∞–ø—Ä–æ—Å, –æ–ø–µ—Ä–∞—Ç–æ—Ä—ã ANY –∏ ALL                 |
| 1 –û—Å–Ω–æ–≤—ã —Ä–µ–ª—è—Ü–∏–æ... | 1.4 –í–ª–æ–∂–µ–Ω–Ω—ã–µ –∑–∞... | 1.4.6 –í–ª–æ–∂–µ–Ω–Ω—ã–π –∑–∞–ø—Ä–æ—Å –ø–æ—Å–ª–µ SELECT                         |
| 1 –û—Å–Ω–æ–≤—ã —Ä–µ–ª—è—Ü–∏–æ... | 1.5 –ó–∞–ø—Ä–æ—Å—ã –∫–æ—Ä—Ä... | 1.5.5 –î–æ–±–∞–≤–ª–µ–Ω–∏–µ –∑–∞–ø–∏—Å–µ–π, –≤–ª–æ–∂–µ–Ω–Ω—ã–µ –∑–∞–ø—Ä–æ—Å—ã                 |
| 2 –ó–∞–ø—Ä–æ—Å—ã SQL –∫ ... | 2.2 –ó–∞–ø—Ä–æ—Å—ã –Ω–∞ –≤... | 2.2.7 –ó–∞–ø—Ä–æ—Å—ã –¥–ª—è –Ω–µ—Å–∫–æ–ª—å–∫–∏—Ö —Ç–∞–±–ª–∏—Ü —Å–æ –≤–ª–æ–∂–µ–Ω–Ω—ã–º–∏ –∑–∞–ø—Ä–æ—Å–∞–º–∏ |
| 2 –ó–∞–ø—Ä–æ—Å—ã SQL –∫ ... | 2.2 –ó–∞–ø—Ä–æ—Å—ã –Ω–∞ –≤... | 2.2.8 –í–ª–æ–∂–µ–Ω–Ω—ã–µ –∑–∞–ø—Ä–æ—Å—ã –≤ –æ–ø–µ—Ä–∞—Ç–æ—Ä–∞—Ö —Å–æ–µ–¥–∏–Ω–µ–Ω–∏—è             |
| 2 –ó–∞–ø—Ä–æ—Å—ã SQL –∫ ... | 2.3 –ó–∞–ø—Ä–æ—Å—ã –∫–æ—Ä—Ä... | 2.3.5 –ó–∞–ø—Ä–æ—Å –Ω–∞ –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ, –≤–ª–æ–∂–µ–Ω–Ω—ã–µ –∑–∞–ø—Ä–æ—Å—ã               |

---

‚ú≥ –®–∞–≥ 3. 

‚ùì*–ó–∞–¥–∞–Ω–∏–µ. –ó–∞–ø–æ–ª–Ω–∏—Ç—å —Ç–∞–±–ª–∏—Ü—É step_keyword —Å–ª–µ–¥—É—é—â–∏–º –æ–±—Ä–∞–∑–æ–º: –µ—Å–ª–∏ –∫–ª—é—á–µ–≤–æ–µ —Å–ª–æ–≤–æ –µ—Å—Ç—å –≤ –Ω–∞–∑–≤–∞–Ω–∏–∏ —à–∞–≥–∞, —Ç–æ –≤–∫–ª—é—á–∏—Ç—å –≤ step_keyword —Å—Ç—Ä–æ–∫—É —Å id —à–∞–≥–∞ –∏ id –∫–ª—é—á–µ–≤–æ–≥–æ —Å–ª–æ–≤–∞.*

*–§—Ä–∞–≥–º–µ–Ω—Ç –ª–æ–≥–∏—á–µ—Å–∫–æ–π —Å—Ö–µ–º—ã –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö:*

![](https://ucarecdn.com/ac7f46e6-bc33-4aa9-9240-c35f638eee4f/)

‚úî`–†–ï–®–ï–ù–ò–ï` ‚§µÔ∏è

```sql
INSERT INTO step_keyword(step_id, keyword_id) 
SELECT 
  step_id, 
  keyword_id 
FROM 
  keyword CROSS 
  JOIN step 
WHERE 
  regexp_instr(
    step_name, 
    concat('\\b', keyword_name, '\\b')
  );
SELECT 
  * 
FROM 
  step_keyword;
```

üîé `–†–ï–ó–£–õ–¨–¢–ê–¢` ‚§µÔ∏è

| step_id | keyword_id |
|:---------------:|:---------------:|
| 38      | 1          |
| 81      | 3          |
| 82      | 4          |
| 82      | 5          |
| 82      | 6          |
| 81      | 7          |
| 82      | 7          |
| 83      | 7          |
| 83      | 8          |
| 47      | 10         |
| 47      | 11         |
| 42      | 15         |
| 43      | 16         |
| 44      | 16         |
| 42      | 17         |
| 43      | 18         |
| 46      | 18         |
| 43      | 19         |
| 88      | 26         |
| 112     | 27         |
| 113     | 27         |
| 37      | 28         |
| 37      | 29         |
| 18      | 30         |
| 36      | 30         |
| 19      | 31         |
| 18      | 32         |

---

‚ú≥ –®–∞–≥ 4. 

‚ùì*–ó–∞–¥–∞–Ω–∏–µ. –†–µ–∞–ª–∏–∑–æ–≤–∞—Ç—å –ø–æ–∏—Å–∫ –ø–æ –∫–ª—é—á–µ–≤—ã–º —Å–ª–æ–≤–∞–º. –í—ã–≤–µ—Å—Ç–∏ —à–∞–≥–∏, —Å –∫–æ—Ç–æ—Ä—ã–º–∏ —Å–≤—è–∑–∞–Ω—ã –∫–ª—é—á–µ–≤—ã–µ —Å–ª–æ–≤–∞ MAX –∏ AVG –æ–¥–Ω–æ–≤—Ä–µ–º–µ–Ω–Ω–æ. –î–ª—è —à–∞–≥–æ–≤ —É–∫–∞–∑–∞—Ç—å id –º–æ–¥—É–ª—è, –ø–æ–∑–∏—Ü–∏—é —É—Ä–æ–∫–∞ –≤ –º–æ–¥—É–ª–µ, –ø–æ–∑–∏—Ü–∏—é —à–∞–≥–∞ –≤ —É—Ä–æ–∫–µ —á–µ—Ä–µ–∑ —Ç–æ—á–∫—É, –ø–æ—Å–ª–µ –ø–æ–∑–∏—Ü–∏–∏ —à–∞–≥–∞ –ø–µ—Ä–µ–¥ –∑–∞–≥–æ–ª–æ–≤–∫–æ–º - –ø—Ä–æ–±–µ–ª. –ü–æ–∑–∏—Ü–∏—é —à–∞–≥–∞ –≤ —É—Ä–æ–∫–µ –≤—ã–≤–µ—Å—Ç–∏ –≤ –≤–∏–¥–µ –¥–≤—É—Ö —Ü–∏—Ñ—Ä (–µ—Å–ª–∏ –ø–æ–∑–∏—Ü–∏—è —à–∞–≥–∞ –º–µ–Ω—å—à–µ 10, —Ç–æ –ø–µ—Ä–µ–¥ —Ü–∏—Ñ—Ä–æ–π –ø–æ—Å—Ç–∞–≤–∏—Ç—å 0). –°—Ç–æ–ª–±–µ—Ü –Ω–∞–∑–≤–∞—Ç—å –®–∞–≥. –ò–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é –æ—Ç—Å–æ—Ä—Ç–∏—Ä–æ–≤–∞—Ç—å –ø–æ –ø–µ—Ä–≤–æ–º—É —Å—Ç–æ–ª–±—Ü—É –≤ –∞–ª—Ñ–∞–≤–∏—Ç–Ω–æ–º –ø–æ—Ä—è–¥–∫–µ.*

*–§—Ä–∞–≥–º–µ–Ω—Ç –ª–æ–≥–∏—á–µ—Å–∫–æ–π —Å—Ö–µ–º—ã –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö:*

![](https://ucarecdn.com/11b91b0f-e8c1-42b2-a34d-1e8ad5e41960/)

‚úî`–†–ï–®–ï–ù–ò–ï` ‚§µÔ∏è

```sql
SELECT 
  CONCAT(
    module_id, 
    '.', 
    lesson_position, 
    IF(
      step_position < 10, 
      CONCAT('.0', step_position), 
      CONCAT('.', step_position)
    ), 
    ' ', 
    step_name
  ) AS –®–∞–≥ 
FROM 
  step_keyword 
  JOIN step USING(step_id) 
  JOIN lesson USING(lesson_id) 
  JOIN module USING(module_id) 
  JOIN keyword USING(keyword_id) 
WHERE 
  keyword_name like '%AVG%' 
  OR keyword_name like '%MAX%' 
GROUP BY 
  step_id 
HAVING 
  COUNT(keyword_name) = 2 
ORDER BY 
  step_position;
```

üîé `–†–ï–ó–£–õ–¨–¢–ê–¢` ‚§µÔ∏è

| –®–∞–≥                                                     |
|:---------------:|
| 1.3.04 –í—ã–±–æ—Ä–∫–∞ –¥–∞–Ω–Ω—ã—Ö, –≥—Ä—É–ø–ø–æ–≤—ã–µ —Ñ—É–Ω–∫—Ü–∏–∏ MIN, MAX –∏ AVG |
| 1.4.06 –í–ª–æ–∂–µ–Ω–Ω—ã–π –∑–∞–ø—Ä–æ—Å –ø–æ—Å–ª–µ SELECT                    |

---

‚ú≥ –®–∞–≥ 5. –í—ã–±–æ—Ä–∫–∞ –¥–∞–Ω–Ω—ã—Ö –ø–æ –Ω–µ—Å–∫–æ–ª—å–∫–∏–º —É—Å–ª–æ–≤–∏—è–º, –æ–ø–µ—Ä–∞—Ç–æ—Ä CASE

‚ùì*–ó–∞–¥–∞–Ω–∏–µ. –ü–æ—Å—á–∏—Ç–∞—Ç—å, —Å–∫–æ–ª—å–∫–æ —Å—Ç—É–¥–µ–Ω—Ç–æ–≤ –æ—Ç–Ω–æ—Å–∏—Ç—Å—è –∫ –∫–∞–∂–¥–æ–π –≥—Ä—É–ø–ø–µ. –°—Ç–æ–ª–±—Ü—ã –Ω–∞–∑–≤–∞—Ç—å –ì—Ä—É–ø–ø–∞, –ò–Ω—Ç–µ—Ä–≤–∞–ª, –ö–æ–ª–∏—á–µ—Å—Ç–≤–æ. –£–∫–∞–∑–∞—Ç—å –≥—Ä–∞–Ω–∏—Ü—ã –∏–Ω—Ç–µ—Ä–≤–∞–ª–∞.*

‚úî`–†–ï–®–ï–ù–ò–ï` ‚§µÔ∏è

```sql
SELECT  
    CASE
        WHEN rate <= 10 THEN "I"
        WHEN rate <= 15 THEN "II"
        WHEN rate <= 27 THEN "III"
        ELSE "IV"
    END AS –ì—Ä—É–ø–ø–∞, 
    CASE
        WHEN rate <= 10 THEN "–æ—Ç 0 –¥–æ 10"
        WHEN rate <= 15 THEN "–æ—Ç 11 –¥–æ 15"
        WHEN rate <= 27 THEN "–æ—Ç 16 –¥–æ 27"
        ELSE "–±–æ–ª—å—à–µ 27"
    END AS –ò–Ω—Ç–µ—Ä–≤–∞–ª, COUNT(student_id) AS –ö–æ–ª–∏—á–µ—Å—Ç–≤–æ
FROM 
  (
    SELECT 
      student_id, 
      COUNT(*) AS rate 
    FROM 
      (
        SELECT 
          student_id, 
          step_id 
        FROM 
          step_student 
        WHERE 
          result = "correct" 
        GROUP BY 
          student_id, 
          step_id
      ) query_in 
    GROUP BY 
      student_id 
    ORDER BY 
      2
  ) query_in_1 
GROUP BY 
  –ì—Ä—É–ø–ø–∞, 
  –ò–Ω—Ç–µ—Ä–≤–∞–ª;
```

üîé `–†–ï–ó–£–õ–¨–¢–ê–¢` ‚§µÔ∏è

| –ì—Ä—É–ø–ø–∞ | –ò–Ω—Ç–µ—Ä–≤–∞–ª    | –ö–æ–ª–∏—á–µ—Å—Ç–≤–æ |
|:---------------:|:---------------:|:---------------:|
| I      | –æ—Ç 0 –¥–æ 10  | 10         |
| II     | –æ—Ç 11 –¥–æ 15 | 27         |
| III    | –æ—Ç 16 –¥–æ 27 | 9          |
| IV     | –±–æ–ª—å—à–µ 27   | 18         |

---

‚ú≥ –®–∞–≥ 6. –¢–∞–±–ª–∏—á–Ω—ã–µ –≤—ã—Ä–∞–∂–µ–Ω–∏—è, –æ–ø–µ—Ä–∞—Ç–æ—Ä WITH

‚ùì*–ó–∞–¥–∞–Ω–∏–µ. –ò—Å–ø—Ä–∞–≤–∏—Ç—å –∑–∞–ø—Ä–æ—Å –ø—Ä–∏–º–µ—Ä–∞ —Ç–∞–∫: –¥–ª—è —à–∞–≥–æ–≤, –∫–æ—Ç–æ—Ä—ã–µ  –Ω–µ –∏–º–µ—é—Ç –Ω–µ–≤–µ—Ä–Ω—ã—Ö –æ—Ç–≤–µ—Ç–æ–≤,  —É–∫–∞–∑–∞—Ç—å 100 –∫–∞–∫ –ø—Ä–æ—Ü–µ–Ω—Ç —É—Å–ø–µ—à–Ω—ã—Ö –ø–æ–ø—ã—Ç–æ–∫, –µ—Å–ª–∏ –∂–µ —à–∞–≥ –Ω–µ –∏–º–µ–µ—Ç –≤–µ—Ä–Ω—ã—Ö –æ—Ç–≤–µ—Ç–æ–≤, —É–∫–∞–∑–∞—Ç—å 0. –ò–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é –æ—Ç—Å–æ—Ä—Ç–∏—Ä–æ–≤–∞—Ç—å —Å–Ω–∞—á–∞–ª–∞ –ø–æ –≤–æ–∑—Ä–∞—Å—Ç–∞–Ω–∏—é —É—Å–ø–µ—à–Ω–æ—Å—Ç–∏, –∞ –∑–∞—Ç–µ–º –ø–æ –Ω–∞–∑–≤–∞–Ω–∏—é —à–∞–≥–∞ –≤ –∞–ª—Ñ–∞–≤–∏—Ç–Ω–æ–º –ø–æ—Ä—è–¥–∫–µ.*

‚úî`–†–ï–®–ï–ù–ò–ï` ‚§µÔ∏è

```sql
WITH get_count_correct (st_n_c, count_correct) AS (
  SELECT 
    step_name, 
    count(*) 
  FROM 
    step 
    INNER JOIN step_student USING (step_id) 
  WHERE 
    result = "correct" 
  GROUP BY 
    step_name
), 
get_count_wrong (st_n_w, count_wrong) AS (
  SELECT 
    step_name, 
    count(*) 
  FROM 
    step 
    INNER JOIN step_student USING (step_id) 
  WHERE 
    result = "wrong" 
  GROUP BY 
    step_name
) 
SELECT 
  st_n_c AS –®–∞–≥, 
  CASE WHEN ROUND(
    count_correct / (count_correct + count_wrong)* 100
  ) IS NULL THEN 100 ELSE ROUND(
    count_correct / (count_correct + count_wrong)* 100
  ) END AS –£—Å–ø–µ—à–Ω–æ—Å—Ç—å 
FROM 
  get_count_correct 
  LEFT JOIN get_count_wrong ON st_n_c = st_n_w 
UNION 
SELECT 
  st_n_w AS –®–∞–≥, 
  CASE WHEN ROUND(
    count_correct / (count_correct + count_wrong)* 100
  ) IS NULL THEN 0 ELSE ROUND(
    count_correct / (count_correct + count_wrong)* 100
  ) END AS –£—Å–ø–µ—à–Ω–æ—Å—Ç—å 
FROM 
  get_count_correct 
  RIGHT JOIN get_count_wrong ON st_n_c = st_n_w 
ORDER BY 
  –£—Å–ø–µ—à–Ω–æ—Å—Ç—å + 0, 
  1 ASC;
```

üîé `–†–ï–ó–£–õ–¨–¢–ê–¢` ‚§µÔ∏è

| –®–∞–≥                                                                      | –£—Å–ø–µ—à–Ω–æ—Å—Ç—å |
|:---------------:|:---------------:|
| –ó–∞–¥–∞–Ω–∏–µ. –†–∞–±–æ—Ç–∞ —Å –∞—Ä—Ö–∏–≤–Ω–æ–π —Ç–∞–±–ª–∏—Ü–µ–π, –æ–ø–µ—Ä–∞—Ç–æ—Ä UNION, —á–∞—Å—Ç—å 1             | 0          |
| –í—ã–±–æ—Ä–∫–∞ –¥–∞–Ω–Ω—ã—Ö, –æ–ø–µ—Ä–∞—Ç–æ—Ä LIKE                                            | 19         |
| –í–ª–æ–∂–µ–Ω–Ω—ã–µ –∑–∞–ø—Ä–æ—Å—ã –≤ –æ–ø–µ—Ä–∞—Ç–æ—Ä–∞—Ö —Å–æ–µ–¥–∏–Ω–µ–Ω–∏—è                                | 32         |
| –ó–∞–¥–∞–Ω–∏–µ. –í—ã–≤–µ—Å—Ç–∏ —Å–∞–º—ã–π –ø–æ–ø—É–ª—è—Ä–Ω—ã–π –∂–∞–Ω—Ä                                   | 33         |
| –ó–∞–ø—Ä–æ—Å—ã –¥–ª—è –Ω–µ—Å–∫–æ–ª—å–∫–∏—Ö —Ç–∞–±–ª–∏—Ü —Å –≥—Ä—É–ø–ø–∏—Ä–æ–≤–∫–æ–π                             | 33         |
| –ó–∞–¥–∞–Ω–∏–µ. –í—ã–≤–µ—Å—Ç–∏ –∑–∞–∫–∞–∑—ã, –¥–æ—Å—Ç–∞–≤–ª–µ–Ω–Ω—ã–µ —Å –æ–ø–æ–∑–¥–∞–Ω–∏–µ–º                       | 35         |
| –ó–∞–¥–∞–Ω–∏–µ. –í—ã–≤–µ—Å—Ç–∏ –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é –æ –¥–≤–∏–∂–µ–Ω–∏–∏ –∫–∞–∂–¥–æ–≥–æ –∑–∞–∫–∞–∑–∞                    | 36         |
| –ó–∞–ø—Ä–æ—Å—ã –¥–ª—è –Ω–µ—Å–∫–æ–ª—å–∫–∏—Ö —Ç–∞–±–ª–∏—Ü —Å–æ –≤–ª–æ–∂–µ–Ω–Ω—ã–º–∏ –∑–∞–ø—Ä–æ—Å–∞–º–∏                    | 36         |
| –ó–∞–¥–∞–Ω–∏–µ. –í—ã–≤–µ—Å—Ç–∏ –ø–æ–¥—Ä–æ–±–Ω—É—é –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é –æ –∫–∞–∂–¥–æ–º –∑–∞–∫–∞–∑–µ                    | 37         |
| –í—ã–±–æ—Ä–∫–∞ –¥–∞–Ω–Ω—ã—Ö, –≤—ã—á–∏—Å–ª—è–µ–º—ã–µ —Å—Ç–æ–ª–±—Ü—ã, –ª–æ–≥–∏—á–µ—Å–∫–∏–µ —Ñ—É–Ω–∫—Ü–∏–∏                  | 44         |
| –û–ø–µ—Ä–∞—Ü–∏—è —Å–æ–µ–¥–∏–Ω–µ–Ω–∏–µ, –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ USING()                               | 45         |
| –ü–µ—Ä–µ–∫—Ä–µ—Å—Ç–Ω–æ–µ —Å–æ–µ–¥–∏–Ω–µ–Ω–∏–µ CROSS JOIN                                       | 45         |
| –ó–∞–¥–∞–Ω–∏–µ. –í—ã–≤–µ—Å—Ç–∏ –≥–æ—Ä–æ–¥–∞, –≤ –∫–æ—Ç–æ—Ä—ã—Ö –∂–∏–≤—É—Ç –∫–ª–∏–µ–Ω—Ç—ã –º–∞–≥–∞–∑–∏–Ω–∞                | 48         |
| –ó–∞–¥–∞–Ω–∏–µ. –ü–æ—Å—á–∏—Ç–∞—Ç—å, —Å–∫–æ–ª—å–∫–æ —Ä–∞–∑ –±—ã–ª–∞ –∑–∞–∫–∞–∑–∞–Ω–∞ –∫–∞–∂–¥–∞—è –∫–Ω–∏–≥–∞               | 48         |
| –ó–∞–ø—Ä–æ—Å—ã –Ω–∞ –æ—Å–Ω–æ–≤–µ —Ç—Ä–µ—Ö –∏ –±–æ–ª–µ–µ —Å–≤—è–∑–∞–Ω–Ω—ã—Ö —Ç–∞–±–ª–∏—Ü                          | 49         |
| –í—ã–±–æ—Ä–∫–∞ –¥–∞–Ω–Ω—ã—Ö —Å —Å–æ—Ä—Ç–∏—Ä–æ–≤–∫–æ–π                                             | 53         |
| –í–Ω–µ—à–Ω–µ–µ —Å–æ–µ–¥–∏–Ω–µ–Ω–∏–µ LEFT –∏ RIGHT OUTER JOIN                               | 55         |
| –ó–∞–ø—Ä–æ—Å—ã –Ω–∞ –≤—ã–±–æ—Ä–∫—É –∏–∑ –Ω–µ—Å–∫–æ–ª—å–∫–∏—Ö —Ç–∞–±–ª–∏—Ü                                  | 58         |
| –í—ã–±–æ—Ä–∫–∞ –¥–∞–Ω–Ω—ã—Ö, –≤—ã—á–∏—Å–ª—è–µ–º—ã–µ —Å—Ç–æ–ª–±—Ü—ã, –º–∞—Ç–µ–º–∞—Ç–∏—á–µ—Å–∫–∏–µ —Ñ—É–Ω–∫—Ü–∏–∏              | 59         |
| –ó–∞–¥–∞–Ω–∏–µ. –í—ã–≤–µ—Å—Ç–∏ –∫–ª–∏–µ–Ω—Ç–æ–≤, –∫–æ—Ç–æ—Ä—ã–µ –∑–∞–∫–∞–∑—ã–≤–∞–ª–∏ –∫–Ω–∏–≥–∏ –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–Ω–æ–≥–æ –∞–≤—Ç–æ—Ä–∞ | 63         |
| –ó–∞–¥–∞–Ω–∏–µ. –í—ã–≤–µ—Å—Ç–∏ –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é –æ–± –æ–ø–ª–∞—Ç–µ –∫–∞–∂–¥–æ–≥–æ –∑–∞–∫–∞–∑–∞                     | 65         |
| –í—ã–±–æ—Ä–∫–∞ –¥–∞–Ω–Ω—ã—Ö, –ª–æ–≥–∏—á–µ—Å–∫–∏–µ –æ–ø–µ—Ä–∞—Ü–∏–∏                                      | 67         |
| –ü—Ä–æ–µ–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –∫–æ–Ω—Ü–µ–ø—Ç—É–∞–ª—å–Ω–æ–π –º–æ–¥–µ–ª–∏ –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö                         | 70         |
| –í—ã–±–æ—Ä–∫–∞ –¥–∞–Ω–Ω—ã—Ö, –æ–ø–µ—Ä–∞—Ç–æ—Ä—ã BETWEEN, IN                                    | 72         |
| –í—ã–±–æ—Ä–∫–∞ –¥–∞–Ω–Ω—ã—Ö —Å —Å–æ–∑–¥–∞–Ω–∏–µ–º –≤—ã—á–∏—Å–ª—è–µ–º–æ–≥–æ —Å—Ç–æ–ª–±—Ü–∞                          | 74         |
| –í—ã–±–æ—Ä–∫–∞ –æ—Ç–¥–µ–ª—å–Ω—ã—Ö —Å—Ç–æ–ª–±—Ü–æ–≤                                               | 76         |
| –°–æ–µ–¥–∏–Ω–µ–Ω–∏–µ INNER JOIN                                                    | 78         |
| –í—ã–±–æ—Ä–∫–∞ –¥–∞–Ω–Ω—ã—Ö –ø–æ —É—Å–ª–æ–≤–∏—é                                                | 81         |
| –í—ã–±–æ—Ä–∫–∞ –æ—Ç–¥–µ–ª—å–Ω—ã—Ö —Å—Ç–æ–ª–±—Ü–æ–≤ –∏ –ø—Ä–∏—Å–≤–æ–µ–Ω–∏–µ –∏–º –Ω–æ–≤—ã—Ö –∏–º–µ–Ω                    | 84         |
| –í—ã–±–æ—Ä–∫–∞ –≤—Å–µ—Ö –¥–∞–Ω–Ω—ã—Ö –∏–∑ —Ç–∞–±–ª–∏—Ü—ã                                           | 87         |
| –ó–∞–¥–∞–Ω–∏–µ. –†–∞–±–æ—Ç–∞ —Å –∞—Ä—Ö–∏–≤–Ω–æ–π —Ç–∞–±–ª–∏—Ü–µ–π, –æ–ø–µ—Ä–∞—Ç–æ—Ä UNION, —á–∞—Å—Ç—å 2             | 100        |
| –ü–æ—Å—Ç—Ä–æ–µ–Ω–∏–µ –ª–æ–≥–∏—á–µ—Å–∫–æ–π —Å—Ö–µ–º—ã –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö                                  | 100        |

---

‚ú≥ –®–∞–≥ 7. 

‚ùì*–ó–∞–¥–∞–Ω–∏–µ. –í—ã—á–∏—Å–ª–∏—Ç—å –ø—Ä–æ–≥—Ä–µ—Å—Å –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π –ø–æ –∫—É—Ä—Å—É. –ü—Ä–æ–≥—Ä–µ—Å—Å –≤—ã—á–∏—Å–ª—è–µ—Ç—Å—è –∫–∞–∫ –æ—Ç–Ω–æ—à–µ–Ω–∏–µ –≤–µ—Ä–Ω–æ –ø—Ä–æ–π–¥–µ–Ω–Ω—ã—Ö —à–∞–≥–æ–≤ –∫ –æ–±—â–µ–º—É –∫–æ–ª–∏—á–µ—Å—Ç–≤—É —à–∞–≥–æ–≤ –≤ –ø—Ä–æ—Ü–µ–Ω—Ç–∞—Ö, –æ–∫—Ä—É–≥–ª–µ–Ω–Ω–æ–µ –¥–æ —Ü–µ–ª–æ–≥–æ. –í –Ω–∞—à–µ–π –±–∞–∑–µ –¥–∞–Ω–Ω—ã–µ –æ —Ä–µ—à–µ–Ω–∏—è—Ö –∑–∞–Ω–µ—Å–µ–Ω—ã –Ω–µ –¥–ª—è –≤—Å–µ—Ö —à–∞–≥–æ–≤, –ø–æ—ç—Ç–æ–º—É –æ–±—â–µ–µ –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ —à–∞–≥–æ–≤ –æ–ø—Ä–µ–¥–µ–ª–∏—Ç—å –∫–∞–∫ –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ —Ä–∞–∑–ª–∏—á–Ω—ã—Ö —à–∞–≥–æ–≤ –≤ —Ç–∞–±–ª–∏—Ü–µ step_student.  
–¢–µ–º –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è–º, –∫–æ—Ç–æ—Ä—ã–µ –ø—Ä–æ—à–ª–∏ –≤—Å–µ —à–∞–≥–∏ (–ø—Ä–æ–≥—Ä–µ—Å—Å = 100%) –≤—ã–¥–∞—Ç—å "–°–µ—Ä—Ç–∏—Ñ–∏–∫–∞—Ç —Å –æ—Ç–ª–∏—á–∏–µ–º". –¢–µ–º, —É –∫–æ–≥–æ –ø—Ä–æ–≥—Ä–µ—Å—Å –±–æ–ª—å—à–µ –∏–ª–∏ —Ä–∞–≤–µ–Ω 80% - "–°–µ—Ä—Ç–∏—Ñ–∏–∫–∞—Ç". –î–ª—è –æ—Å—Ç–∞–ª—å–Ω—ã—Ö –∑–∞–ø–∏—Å–µ–π –≤ —Å—Ç–æ–ª–±—Ü–µ –†–µ–∑—É–ª—å—Ç–∞—Ç –∑–∞–¥–∞—Ç—å –ø—É—Å—Ç—É—é —Å—Ç—Ä–æ–∫—É ("").  
–ò–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é –æ—Ç—Å–æ—Ä—Ç–∏—Ä–æ–≤–∞—Ç—å –ø–æ —É–±—ã–≤–∞–Ω–∏—é –ø—Ä–æ–≥—Ä–µ—Å—Å–∞, –∑–∞—Ç–µ–º –ø–æ –∏–º–µ–Ω–∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è –≤ –∞–ª—Ñ–∞–≤–∏—Ç–Ω–æ–º –ø–æ—Ä—è–¥–∫–µ.*

*–§—Ä–∞–≥–º–µ–Ω—Ç –ª–æ–≥–∏—á–µ—Å–∫–æ–π —Å—Ö–µ–º—ã –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö:*

![](https://ucarecdn.com/e32cf2e7-200e-4ba9-9a7c-86244317d7fb/)

‚úî`–†–ï–®–ï–ù–ò–ï` ‚§µÔ∏è

```sql
SET 
  @max = (
    SELECT 
      COUNT(DISTINCT step_id) 
    FROM 
      step_student
  );
WITH table_result(s_n, result_student) AS (
  SELECT 
    student_name, 
    ROUND(
      COUNT(DISTINCT step_id) / @max * 100
    ) 
  FROM 
    student 
    JOIN step_student USING(student_id) 
  WHERE 
    result = "correct" 
  GROUP BY 
    student_name 
  ORDER BY 
    2 DESC
) 
SELECT 
  s_n AS –°—Ç—É–¥–µ–Ω—Ç, 
  result_student AS –ü—Ä–æ–≥—Ä–µ—Å—Å, 
  CASE WHEN result_student < 80 THEN '' WHEN result_student BETWEEN 80 
  AND 99 THEN '–°–µ—Ä—Ç–∏—Ñ–∏–∫–∞—Ç' ELSE '–°–µ—Ä—Ç–∏—Ñ–∏–∫–∞—Ç —Å –æ—Ç–ª–∏—á–∏–µ–º' END AS –†–µ–∑—É–ª—å—Ç–∞—Ç 
FROM 
  table_result 
ORDER BY 
  2 DESC, 
  1;
```

üîé `–†–ï–ó–£–õ–¨–¢–ê–¢` ‚§µÔ∏è

| –°—Ç—É–¥–µ–Ω—Ç    | –ü—Ä–æ–≥—Ä–µ—Å—Å | –†–µ–∑—É–ª—å—Ç–∞—Ç             |
|:---------------:|:---------------:|:---------------:|
| student_60 | 100      | –°–µ—Ä—Ç–∏—Ñ–∏–∫–∞—Ç —Å –æ—Ç–ª–∏—á–∏–µ–º |
| student_15 | 94       | –°–µ—Ä—Ç–∏—Ñ–∏–∫–∞—Ç            |
| student_18 | 94       | –°–µ—Ä—Ç–∏—Ñ–∏–∫–∞—Ç            |
|...| | |
| student_29 | 25       |                       |
| student_47 | 25       |                       |

Affected rows: 64

---

‚ú≥ –®–∞–≥ 8. –û–∫–æ–Ω–Ω—ã–µ —Ñ—É–Ω–∫—Ü–∏–∏, –æ–ø–µ—Ä–∞—Ç–æ—Ä OVER, ORDER BY

‚ùì*–ó–∞–¥–∞–Ω–∏–µ. –î–ª—è —Å—Ç—É–¥–µ–Ω—Ç–∞ —Å –∏–º–µ–Ω–µ–º student_61 –≤—ã–≤–µ—Å—Ç–∏ –≤—Å–µ –µ–≥–æ –ø–æ–ø—ã—Ç–∫–∏: –Ω–∞–∑–≤–∞–Ω–∏–µ —à–∞–≥–∞, —Ä–µ–∑—É–ª—å—Ç–∞—Ç –∏ –¥–∞—Ç—É –æ—Ç–ø—Ä–∞–≤–∫–∏ –ø–æ–ø—ã—Ç–∫–∏ (submission_time). –ò–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é –æ—Ç—Å–æ—Ä—Ç–∏—Ä–æ–≤–∞—Ç—å –ø–æ –¥–∞—Ç–µ –æ—Ç–ø—Ä–∞–≤–∫–∏ –ø–æ–ø—ã—Ç–∫–∏ –∏ —É–∫–∞–∑–∞—Ç—å, —Å–∫–æ–ª—å–∫–æ –º–∏–Ω—É—Ç –ø—Ä–æ—à–ª–æ –º–µ–∂–¥—É –æ—Ç–ø—Ä–∞–≤–∫–æ–π —Å–æ—Å–µ–¥–Ω–∏—Ö –ø–æ–ø—ã—Ç–æ–∫. –ù–∞–∑–≤–∞–Ω–∏–µ —à–∞–≥–∞ –æ–≥—Ä–∞–Ω–∏—á–∏—Ç—å 20 —Å–∏–º–≤–æ–ª–∞–º–∏ –∏ –¥–æ–±–∞–≤–∏—Ç—å "...". –°—Ç–æ–ª–±—Ü—ã –Ω–∞–∑–≤–∞—Ç—å –°—Ç—É–¥–µ–Ω—Ç, –®–∞–≥, –†–µ–∑—É–ª—å—Ç–∞—Ç, –î–∞—Ç–∞_–æ—Ç–ø—Ä–∞–≤–∫–∏, –†–∞–∑–Ω–∏—Ü–∞.*

*–§—Ä–∞–≥–º–µ–Ω—Ç –ª–æ–≥–∏—á–µ—Å–∫–æ–π —Å—Ö–µ–º—ã –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö:*

![](https://ucarecdn.com/7eeaa225-2f02-4721-9d0a-6c3e0beda68d/)

‚úî`–†–ï–®–ï–ù–ò–ï` ‚§µÔ∏è

```sql
WITH sd AS (
  SELECT 
    student_name, 
    step_id, 
    result, 
    submission_time AS –î–∞—Ç–∞, 
    submission_time - LAG(submission_time) OVER(
      ORDER BY 
        submission_time
    ) AS –†–∞–∑–Ω–∏—Ü–∞ 
  FROM 
    step_student 
    JOIN student USING(student_id) 
  WHERE 
    student_name LIKE 'student_61'
) 
SELECT 
  student_name AS –°—Ç—É–¥–µ–Ω—Ç, 
  concat(
    LEFT(step_name, 20), 
    '...'
  ) AS –®–∞–≥, 
  result AS –†–µ–∑—É–ª—å—Ç–∞—Ç, 
  FROM_UNIXTIME(–î–∞—Ç–∞) AS –î–∞—Ç–∞_–æ—Ç–ø—Ä–∞–≤–∫–∏, 
  IF(
    –†–∞–∑–Ω–∏—Ü–∞ IS NULL, 
    SEC_TO_TIME(0), 
    SEC_TO_TIME(–†–∞–∑–Ω–∏—Ü–∞)
  ) AS –†–∞–∑–Ω–∏—Ü–∞ 
FROM 
  step 
  JOIN sd ON sd.step_id = step.step_id 
ORDER BY 
  –î–∞—Ç–∞_–æ—Ç–ø—Ä–∞–≤–∫–∏;
```

üîé `–†–ï–ó–£–õ–¨–¢–ê–¢` ‚§µÔ∏è

| –°—Ç—É–¥–µ–Ω—Ç    | –®–∞–≥                     | –†–µ–∑—É–ª—å—Ç–∞—Ç | –î–∞—Ç–∞_–æ—Ç–ø—Ä–∞–≤–∫–∏       | –†–∞–∑–Ω–∏—Ü–∞          |
|:---------------:|:---------------:|:---------------:|:---------------:|:---------------:|
| student_61 | –í—ã–±–æ—Ä–∫–∞ –≤—Å–µ—Ö –¥–∞–Ω–Ω—ã—Ö ... | correct   | 2020-08-27 14:22:14 | 0:00:00          |
| student_61 | –í—ã–±–æ—Ä–∫–∞ –æ—Ç–¥–µ–ª—å–Ω—ã—Ö —Å—Ç... | correct   | 2020-08-27 14:23:53 | 0:01:39          |
| student_61 | –í—ã–±–æ—Ä–∫–∞ –æ—Ç–¥–µ–ª—å–Ω—ã—Ö —Å—Ç... | correct   | 2020-08-27 14:28:41 | 0:04:48          |
| student_61 | –í—ã–±–æ—Ä–∫–∞ –¥–∞–Ω–Ω—ã—Ö —Å —Å–æ–∑... | wrong     | 2020-08-27 14:33:57 | 0:05:16          |
| student_61 | –í—ã–±–æ—Ä–∫–∞ –¥–∞–Ω–Ω—ã—Ö —Å —Å–æ–∑... | wrong     | 2020-08-27 14:34:24 | 0:00:27          |
|...| | | | |
| student_61 | –í—ã–±–æ—Ä–∫–∞ –¥–∞–Ω–Ω—ã—Ö —Å —Å–æ—Ä... | correct   | 2020-08-27 16:14:15 | 0:01:24          |
| student_61 | –°–æ–µ–¥–∏–Ω–µ–Ω–∏–µ INNER JOI... | correct   | 2020-09-01 07:25:39 | 4 days, 15:11:24 |
| student_61 | –í–Ω–µ—à–Ω–µ–µ —Å–æ–µ–¥–∏–Ω–µ–Ω–∏–µ L... | wrong     | 2020-09-01 09:53:30 | 2:27:51          |
| student_61 | –í–Ω–µ—à–Ω–µ–µ —Å–æ–µ–¥–∏–Ω–µ–Ω–∏–µ L... | correct   | 2020-09-01 09:53:50 | 0:00:20          |
| student_61 | –ü–µ—Ä–µ–∫—Ä–µ—Å—Ç–Ω–æ–µ —Å–æ–µ–¥–∏–Ω–µ... | wrong     | 2020-09-01 10:45:30 | 0:51:40          |
| student_61 | –ü–µ—Ä–µ–∫—Ä–µ—Å—Ç–Ω–æ–µ —Å–æ–µ–¥–∏–Ω–µ... | wrong     | 2020-09-01 10:46:21 | 0:00:51          |
| student_61 | –ü–µ—Ä–µ–∫—Ä–µ—Å—Ç–Ω–æ–µ —Å–æ–µ–¥–∏–Ω–µ... | correct   | 2020-09-01 10:47:55 | 0:01:34          |

Affected rows: 43

---

‚ú≥ –®–∞–≥ 9. 

‚ùì*–ó–∞–¥–∞–Ω–∏–µ. –ü–æ—Å—á–∏—Ç–∞—Ç—å —Å—Ä–µ–¥–Ω–µ–µ –≤—Ä–µ–º—è, –∑–∞ –∫–æ—Ç–æ—Ä–æ–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–∏ –ø—Ä–æ—Ö–æ–¥—è—Ç —É—Ä–æ–∫ –ø–æ —Å–ª–µ–¥—É—é—â–µ–º—É –∞–ª–≥–æ—Ä–∏—Ç–º—É:*
*+–¥–ª—è –∫–∞–∂–¥–æ–≥–æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è –≤—ã—á–∏—Å–ª–∏—Ç—å –≤—Ä–µ–º—è –ø—Ä–æ—Ö–æ–∂–¥–µ–Ω–∏—è —à–∞–≥–∞ –∫–∞–∫ —Å—É–º–º—É –≤—Ä–µ–º–µ–Ω–∏, –ø–æ—Ç—Ä–∞—á–µ–Ω–Ω–æ–≥–æ –Ω–∞ –∫–∞–∂–¥—É—é –ø–æ–ø—ã—Ç–∫—É (–≤—Ä–µ–º—è –ø–æ–ø—ã—Ç–∫–∏ - —ç—Ç–æ —Ä–∞–∑–Ω–∏—Ü–∞ –º–µ–∂–¥—É –≤—Ä–µ–º–µ–Ω–µ–º –æ—Ç–ø—Ä–∞–≤–∫–∏ –∑–∞–¥–∞–Ω–∏—è –∏ –≤—Ä–µ–º–µ–Ω–µ–º –Ω–∞—á–∞–ª–∞ –ø–æ–ø—ã—Ç–∫–∏), –ø—Ä–∏ —ç—Ç–æ–º –ø–æ–ø—ã—Ç–∫–∏, –∫–æ—Ç–æ—Ä—ã–µ –¥–ª–∏–ª–∏—Å—å –±–æ–ª—å—à–µ 4 —á–∞—Å–æ–≤ –Ω–µ —É—á–∏—Ç—ã–≤–∞—Ç—å, —Ç–∞–∫ –∫–∞–∫ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –º–æ–≥ –ø—Ä–æ—Å—Ç–æ –æ—Å—Ç–∞–≤–∏—Ç—å –∑–∞–¥–∞–Ω–∏–µ –æ—Ç–∫—Ä—ã—Ç—ã–º –≤ –±—Ä–∞—É–∑–µ—Ä–µ, –∞ –≤–µ—Ä–Ω—É—Ç—å—Å—è –∫ –Ω–µ–º—É –Ω–∞ —Å–ª–µ–¥—É—é—â–∏–π –¥–µ–Ω—å;*
*+–¥–ª—è –∫–∞–∂–¥–æ–≥–æ —Å—Ç—É–¥–µ–Ω—Ç–∞ –ø–æ—Å—á–∏—Ç–∞—Ç—å –æ–±—â–µ–µ –≤—Ä–µ–º—è, –∫–æ—Ç–æ—Ä–æ–µ –æ–Ω –∑–∞—Ç—Ä–∞—Ç–∏–ª –Ω–∞ –∫–∞–∂–¥—ã–π —É—Ä–æ–∫;*
*+–≤—ã—á–∏—Å–ª–∏—Ç—å —Å—Ä–µ–¥–Ω–µ–µ –≤—Ä–µ–º—è –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è —É—Ä–æ–∫–∞ –≤ —á–∞—Å–∞—Ö, —Ä–µ–∑—É–ª—å—Ç–∞—Ç –æ–∫—Ä—É–≥–ª–∏—Ç—å –¥–æ 2-—Ö –∑–Ω–∞–∫–æ–≤ –ø–æ—Å–ª–µ –∑–∞–ø—è—Ç–æ–π;*
*+–≤—ã–≤–µ—Å—Ç–∏ –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é –ø–æ –≤–æ–∑—Ä–∞—Å—Ç–∞–Ω–∏—é –≤—Ä–µ–º–µ–Ω–∏, –ø—Ä–æ–Ω—É–º–µ—Ä–æ–≤–∞–≤ —Å—Ç—Ä–æ–∫–∏, –¥–ª—è –∫–∞–∂–¥–æ–≥–æ —É—Ä–æ–∫–∞ —É–∫–∞–∑–∞—Ç—å –Ω–æ–º–µ—Ä –º–æ–¥—É–ª—è –∏ –µ–≥–æ –ø–æ–∑–∏—Ü–∏—é –≤ –Ω–µ–º.*
*–°—Ç–æ–ª–±—Ü—ã —Ä–µ–∑—É–ª—å—Ç–∞—Ç–∞ –Ω–∞–∑–≤–∞—Ç—å –ù–æ–º–µ—Ä, –£—Ä–æ–∫, –°—Ä–µ–¥–Ω–µ–µ_–≤—Ä–µ–º—è.*

*–§—Ä–∞–≥–º–µ–Ω—Ç –ª–æ–≥–∏—á–µ—Å–∫–æ–π —Å—Ö–µ–º—ã –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö:*

![](https://ucarecdn.com/46f3ad63-48e6-43d0-94a0-3c6b1379d124/)

‚úî`–†–ï–®–ï–ù–ò–ï` ‚§µÔ∏è

```sql
WITH table1 AS (
  SELECT 
    lesson_id, 
    student_id, 
    SUM(submission_time - attempt_time) AS –í—Ä–µ–º—è 
  FROM 
    step 
    JOIN step_student USING(step_id) 
  WHERE 
    submission_time - attempt_time <= 14400 
  GROUP BY 
    lesson_id, 
    student_id
), 
table2 AS (
  SELECT 
    lesson_id, 
    round(
      AVG(–í—Ä–µ–º—è)/ 3600, 
      2
    ) AS –°—Ä–µ–¥–Ω–µ–µ_–≤—Ä–µ–º—è 
  FROM 
    table1 
  GROUP BY 
    lesson_id
) 
SELECT 
  ROW_NUMBER() OVER(
    ORDER BY 
      –°—Ä–µ–¥–Ω–µ–µ_–≤—Ä–µ–º—è
  ) AS –ù–æ–º–µ—Ä, 
  CONCAT(
    module_id, '.', lesson_position, ' ', 
    lesson_name
  ) AS –£—Ä–æ–∫, 
  –°—Ä–µ–¥–Ω–µ–µ_–≤—Ä–µ–º—è 
FROM 
  table2 
  JOIN lesson USING(lesson_id) 
ORDER BY 
  –°—Ä–µ–¥–Ω–µ–µ_–≤—Ä–µ–º—è;
```

üîé `–†–ï–ó–£–õ–¨–¢–ê–¢` ‚§µÔ∏è

| –ù–æ–º–µ—Ä | –£—Ä–æ–∫                                                        | –°—Ä–µ–¥–Ω–µ–µ_–≤—Ä–µ–º—è |
|:---------------:|:---------------:|:---------------:|
| 1     | 2.2 –ó–∞–ø—Ä–æ—Å—ã –Ω–∞ –≤—ã–±–æ—Ä–∫—É, —Å–æ–µ–¥–∏–Ω–µ–Ω–∏–µ —Ç–∞–±–ª–∏—Ü                   | 2.37          |
| 2     | 1.2 –í—ã–±–æ—Ä–∫–∞ –¥–∞–Ω–Ω—ã—Ö                                          | 2.65          |
| 3     | 2.4 –ë–∞–∑–∞ –¥–∞–Ω–Ω—ã—Ö "–ò–Ω—Ç–µ—Ä–Ω–µ—Ç-–º–∞–≥–∞–∑–∏–Ω –∫–Ω–∏–≥", –∑–∞–ø—Ä–æ—Å—ã –Ω–∞ –≤—ã–±–æ—Ä–∫—É | 3.65          |

Affected rows: 3

---

‚ú≥ –®–∞–≥ 10. –û–∫–æ–Ω–Ω—ã–µ —Ñ—É–Ω–∫—Ü–∏–∏, –æ–ø–µ—Ä–∞—Ç–æ—Ä OVER, PARTITION BY

‚ùì*–ó–∞–¥–∞–Ω–∏–µ. –í—ã—á–∏—Å–ª–∏—Ç—å —Ä–µ–π—Ç–∏–Ω–≥ –∫–∞–∂–¥–æ–≥–æ —Å—Ç—É–¥–µ–Ω—Ç–∞ –æ—Ç–Ω–æ—Å–∏—Ç–µ–ª—å–Ω–æ —Å—Ç—É–¥–µ–Ω—Ç–∞, –ø—Ä–æ—à–µ–¥—à–µ–≥–æ –Ω–∞–∏–±–æ–ª—å—à–µ–µ –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ —à–∞–≥–æ–≤ –≤ –º–æ–¥—É–ª–µ (–≤—ã—á–∏—Å–ª—è–µ—Ç—Å—è –∫–∞–∫ –æ—Ç–Ω–æ—à–µ–Ω–∏–µ –∫–æ–ª–∏—á–µ—Å—Ç–≤–∞ –ø—Ä–æ–π–¥–µ–Ω–Ω—ã—Ö —Å—Ç—É–¥–µ–Ω—Ç–æ–º —à–∞–≥–æ–≤ –∫ –º–∞–∫—Å–∏–º–∞–ª—å–Ω–æ–º—É –∫–æ–ª–∏—á–µ—Å—Ç–≤—É –ø—Ä–æ–π–¥–µ–Ω–Ω—ã—Ö —à–∞–≥–æ–≤, —É–º–Ω–æ–∂–µ–Ω–Ω–æ–µ –Ω–∞ 100). –í—ã–≤–µ—Å—Ç–∏ –Ω–æ–º–µ—Ä –º–æ–¥—É–ª—è, –∏–º—è —Å—Ç—É–¥–µ–Ω—Ç–∞, –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –ø—Ä–æ–π–¥–µ–Ω–Ω—ã—Ö –∏–º —à–∞–≥–æ–≤ –∏ –æ—Ç–Ω–æ—Å–∏—Ç–µ–ª—å–Ω—ã–π —Ä–µ–π—Ç–∏–Ω–≥. –û—Ç–Ω–æ—Å–∏—Ç–µ–ª—å–Ω—ã–π —Ä–µ–π—Ç–∏–Ω–≥ –æ–∫—Ä—É–≥–ª–∏—Ç—å –¥–æ –æ–¥–Ω–æ–≥–æ –∑–Ω–∞–∫–∞ –ø–æ—Å–ª–µ –∑–∞–ø—è—Ç–æ–π. –°—Ç–æ–ª–±—Ü—ã –Ω–∞–∑–≤–∞—Ç—å –ú–æ–¥—É–ª—å, –°—Ç—É–¥–µ–Ω—Ç, –ü—Ä–æ–π–¥–µ–Ω–æ_—à–∞–≥–æ–≤ –∏ –û—Ç–Ω–æ—Å–∏—Ç–µ–ª—å–Ω—ã–π_—Ä–µ–π—Ç–∏–Ω–≥  —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤–µ–Ω–Ω–æ. –ò–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é –æ—Ç—Å–æ—Ä—Ç–∏—Ä–æ–≤–∞—Ç—å —Å–Ω–∞—á–∞–ª–∞ –ø–æ –≤–æ–∑—Ä–∞—Å—Ç–∞–Ω–∏—é –Ω–æ–º–µ—Ä–∞ –º–æ–¥—É–ª—è, –ø–æ—Ç–æ–º –ø–æ —É–±—ã–≤–∞–Ω–∏—é –æ—Ç–Ω–æ—Å–∏—Ç–µ–ª—å–Ω–æ–≥–æ —Ä–µ–π—Ç–∏–Ω–≥–∞ –∏, –Ω–∞–∫–æ–Ω–µ—Ü, –ø–æ –∏–º–µ–Ω–∏ —Å—Ç—É–¥–µ–Ω—Ç–∞ –≤ –∞–ª—Ñ–∞–≤–∏—Ç–Ω–æ–º –ø–æ—Ä—è–¥–∫–µ.*

‚úî`–†–ï–®–ï–ù–ò–ï` ‚§µÔ∏è

```sql
WITH table1 AS (
  SELECT 
    module_id AS –ú–æ–¥—É–ª—å, 
    student_name AS –°—Ç—É–¥–µ–Ω—Ç, 
    COUNT(DISTINCT step_id) AS –ü—Ä–æ–π–¥–µ–Ω–æ_—à–∞–≥–æ–≤ 
  FROM 
    student 
    JOIN step_student USING(student_id) 
    JOIN step USING(step_id) 
    JOIN lesson USING(lesson_id) 
  WHERE 
    result = 'correct' 
  GROUP BY 
    module_id, 
    student_name
) 
SELECT 
  –ú–æ–¥—É–ª—å, 
  –°—Ç—É–¥–µ–Ω—Ç, 
  –ü—Ä–æ–π–¥–µ–Ω–æ_—à–∞–≥–æ–≤, 
  ROUND(
    (
      –ü—Ä–æ–π–¥–µ–Ω–æ_—à–∞–≥–æ–≤ / MAX(–ü—Ä–æ–π–¥–µ–Ω–æ_—à–∞–≥–æ–≤) OVER (PARTITION BY –ú–æ–¥—É–ª—å)
    ) * 100, 
    1
  ) AS –û—Ç–Ω–æ—Å–∏—Ç–µ–ª—å–Ω—ã–π_—Ä–µ–π—Ç–∏–Ω–≥ 
FROM 
  table1 
ORDER BY 
  –ú–æ–¥—É–ª—å, 
  –û—Ç–Ω–æ—Å–∏—Ç–µ–ª—å–Ω—ã–π_—Ä–µ–π—Ç–∏–Ω–≥ DESC, 
  –°—Ç—É–¥–µ–Ω—Ç;
```

üîé `–†–ï–ó–£–õ–¨–¢–ê–¢` ‚§µÔ∏è

| –ú–æ–¥—É–ª—å | –°—Ç—É–¥–µ–Ω—Ç    | –ü—Ä–æ–π–¥–µ–Ω–æ_—à–∞–≥–æ–≤ | –û—Ç–Ω–æ—Å–∏—Ç–µ–ª—å–Ω—ã–π_—Ä–µ–π—Ç–∏–Ω–≥ |
|:---------------:|:---------------:|:---------------:|:---------------:|
| 1      | student_1  | 11             | 100.0                 |
| 1      | student_10 | 11             | 100.0                 |
| 1      | student_11 | 11             | 100.0                 |
|...| | | |
| 1      | student_47 | 8              | 72.7                  |
| 2      | student_60 | 21             | 100.0                 |
| 2      | student_15 | 19             | 90.5                  |
| 2      | student_18 | 19             | 90.5                  |
| 2      | student_27 | 19             | 90.5                  |
| 2      | student_30 | 19             | 90.5                  |
| 2      | student_31 | 19             | 90.5                  |
| 2      | student_36 | 19             | 90.5                  |
| 2      | student_39 | 19             | 90.5                  |
| 2      | student_4  | 19             | 90.5                  |
| 2      | student_43 | 19             | 90.5                  |
| 2      | student_44 | 19             | 90.5                  |
| 2      | student_46 | 19             | 90.5                  |
| 2      | student_49 | 19             | 90.5                  |
|...| | | |
| 2      | student_48 | 5              | 23.8                  |
| 2      | student_42 | 4              | 19.0                  |
| 2      | student_61 | 3              | 14.3                  |
| 2      | student_13 | 2              | 9.5                   |
| 2      | student_26 | 2              | 9.5                   |

Affected rows: 95

---

‚ú≥ –®–∞–≥ 11. 

‚ùì*–ó–∞–¥–∞–Ω–∏–µ. –ü—Ä–æ–∞–Ω–∞–ª–∏–∑–∏—Ä–æ–≤–∞—Ç—å, –≤ –∫–∞–∫–æ–º –ø–æ—Ä—è–¥–∫–µ –∏ —Å –∫–∞–∫–∏–º –∏–Ω—Ç–µ—Ä–≤–∞–ª–æ–º –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –æ—Ç–ø—Ä–∞–≤–ª—è–ª –ø–æ—Å–ª–µ–¥–Ω–µ–µ –≤–µ—Ä–Ω–æ –≤—ã–ø–æ–ª–Ω–µ–Ω–Ω–æ–µ –∑–∞–¥–∞–Ω–∏–µ –∫–∞–∂–¥–æ–≥–æ —É—Ä–æ–∫–∞. –í –±–∞–∑–µ –∑–∞–Ω–µ—Å–µ–Ω—ã –ø–æ–ø—ã—Ç–∫–∏ —Å—Ç—É–¥–µ–Ω—Ç–æ–≤  –¥–ª—è —Ç—Ä–µ—Ö —É—Ä–æ–∫–æ–≤ –∫—É—Ä—Å–∞, –ø–æ—ç—Ç–æ–º—É –∞–Ω–∞–ª–∏–∑ –ø—Ä–æ–≤–æ–¥–∏—Ç—å —Ç–æ–ª—å–∫–æ –¥–ª—è —ç—Ç–∏—Ö —É—Ä–æ–∫–æ–≤.*
*–î–ª—è —Å—Ç—É–¥–µ–Ω—Ç–æ–≤ –ø—Ä–æ—à–µ–¥—à–∏—Ö –∫–∞–∫ –º–∏–Ω–∏–º—É–º –ø–æ –æ–¥–Ω–æ–º—É —à–∞–≥—É –≤ –∫–∞–∂–¥–æ–º —É—Ä–æ–∫–µ, –Ω–∞–π—Ç–∏ –ø–æ—Å–ª–µ–¥–Ω–∏–π –ø—Ä–æ–π–¥–µ–Ω–Ω—ã–π —à–∞–≥ –∫–∞–∂–¥–æ–≥–æ —É—Ä–æ–∫–∞ - –∫—Ä–∞–π–Ω–∏–π —à–∞–≥, –∏ —É–∫–∞–∑–∞—Ç—å:*
*+ –∏–º—è —Å—Ç—É–¥–µ–Ω—Ç–∞;*
*+ –Ω–æ–º–µ—Ä —É—Ä–æ–∫–∞, —Å–æ—Å—Ç–æ—è—â–∏–π –∏–∑ –Ω–æ–º–µ—Ä–∞ –º–æ–¥—É–ª—è –∏ —á–µ—Ä–µ–∑ —Ç–æ—á–∫—É –ø–æ–∑–∏—Ü–∏–∏ –∫–∞–∂–¥–æ–≥–æ —É—Ä–æ–∫–∞ –≤ –º–æ–¥—É–ª–µ;*
*+ –≤—Ä–µ–º—è –æ—Ç–ø—Ä–∞–≤–∫–∏  - –≤—Ä–µ–º—è –ø–æ–¥–∞—á–∏ —Ä–µ—à–µ–Ω–∏—è –Ω–∞ –ø—Ä–æ–≤–µ—Ä–∫—É;*
*+ —Ä–∞–∑–Ω–∏—Ü—É –≤–æ –≤—Ä–µ–º–µ–Ω–∏ –æ—Ç–ø—Ä–∞–≤–∫–∏ –º–µ–∂–¥—É —Ç–µ–∫—É—â–∏–º –∏ –ø—Ä–µ–¥—ã–¥—É—â–∏–º –∫—Ä–∞–π–Ω–∏–º —à–∞–≥–æ–º –≤ –¥–Ω—è—Ö, –ø—Ä–∏ —ç—Ç–æ–º –¥–ª—è –ø–µ—Ä–≤–æ–≥–æ —à–∞–≥–∞ –ø–æ—Å—Ç–∞–≤–∏—Ç—å –ø—Ä–æ—á–µ—Ä–∫ ("-"), –∞ –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –¥–Ω–µ–π –æ–∫—Ä—É–≥–ª–∏—Ç—å –¥–æ —Ü–µ–ª–æ–≥–æ –≤ –±–æ–ª—å—à—É—é —Å—Ç–æ—Ä–æ–Ω—É.*
*–°—Ç–æ–ª–±—Ü—ã –Ω–∞–∑–≤–∞—Ç—å  –°—Ç—É–¥–µ–Ω—Ç, –£—Ä–æ–∫,  –ú–∞–∫—Å_–≤—Ä–µ–º—è_–æ—Ç–ø—Ä–∞–≤–∫–∏ –∏ –ò–Ω—Ç–µ—Ä–≤–∞–ª  —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤–µ–Ω–Ω–æ. –û—Ç—Å–æ—Ä—Ç–∏—Ä–æ–≤–∞—Ç—å —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã –ø–æ –∏–º–µ–Ω–∏ —Å—Ç—É–¥–µ–Ω—Ç–∞ –≤ –∞–ª—Ñ–∞–≤–∏—Ç–Ω–æ–º –ø–æ—Ä—è–¥–∫–µ, –∞ –ø–æ—Ç–æ–º –ø–æ –≤–æ–∑—Ä–∞—Å—Ç–∞–Ω–∏—é –≤—Ä–µ–º–µ–Ω–∏ –æ—Ç–ø—Ä–∞–≤–∫–∏.*

*–§—Ä–∞–≥–º–µ–Ω—Ç –ª–æ–≥–∏—á–µ—Å–∫–æ–π —Å—Ö–µ–º—ã –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö:*

![](https://ucarecdn.com/83dcbaba-e030-4299-9c1b-9d25a3dd5d67/)

‚úî`–†–ï–®–ï–ù–ò–ï` ‚§µÔ∏è

```sql
WITH raw_table AS (
  SELECT 
    student_id, 
    step_position, 
    lesson_id, 
    submission_time, 
    MAX(submission_time) OVER(
      PARTITION BY lesson_id, student_id
    ) AS –ú–∞–∫—Å_–≤—Ä–µ–º—è_–æ—Ç–ø—Ä–∞–≤–∫–∏ 
  FROM 
    step_student 
    JOIN step USING(step_id) 
  WHERE 
    student_id IN(
      SELECT 
        student_id 
      FROM 
        step_student 
        JOIN step USING(step_id) 
      WHERE 
        result = 'correct' 
      GROUP BY 
        student_id 
      HAVING 
        COUNT(DISTINCT lesson_id) = 3
    ) 
    AND result = 'correct'
), 
filter_table AS (
  SELECT 
    student_id, 
    lesson_id, 
    from_unixtime(
      –ú–∞–∫—Å_–≤—Ä–µ–º—è_–æ—Ç–ø—Ä–∞–≤–∫–∏
    ) AS –ú–∞–∫—Å_–≤—Ä–µ–º—è_–æ—Ç–ø—Ä–∞–≤–∫–∏, 
    IFNULL(
      CEILING(
        (
          –ú–∞–∫—Å_–≤—Ä–µ–º—è_–æ—Ç–ø—Ä–∞–≤–∫–∏ - lag(
            –ú–∞–∫—Å_–≤—Ä–µ–º—è_–æ—Ç–ø—Ä–∞–≤–∫–∏
          ) OVER(
            PARTITION BY student_id 
            ORDER BY 
              –ú–∞–∫—Å_–≤—Ä–µ–º—è_–æ—Ç–ø—Ä–∞–≤–∫–∏
          )
        )/ 86400
      ), 
      '-'
    ) AS –ò–Ω—Ç–µ—Ä–≤–∞–ª 
  FROM 
    raw_table 
  WHERE 
    submission_time = –ú–∞–∫—Å_–≤—Ä–µ–º—è_–æ—Ç–ø—Ä–∞–≤–∫–∏
), 
res_table AS (
  SELECT 
    student_name AS –°—Ç—É–¥–µ–Ω—Ç, 
    concat(module_id, '.', lesson_position) AS –£—Ä–æ–∫, 
    –ú–∞–∫—Å_–≤—Ä–µ–º—è_–æ—Ç–ø—Ä–∞–≤–∫–∏, 
    –ò–Ω—Ç–µ—Ä–≤–∞–ª 
  FROM 
    filter_table 
    JOIN student USING(student_id) 
    JOIN lesson USING(lesson_id)
) 
SELECT 
  * 
FROM 
  res_table 
ORDER BY 
  –°—Ç—É–¥–µ–Ω—Ç, 
  –ú–∞–∫—Å_–≤—Ä–µ–º—è_–æ—Ç–ø—Ä–∞–≤–∫–∏;
```

üîé `–†–ï–ó–£–õ–¨–¢–ê–¢` ‚§µÔ∏è

| –°—Ç—É–¥–µ–Ω—Ç    | –£—Ä–æ–∫ | –ú–∞–∫—Å_–≤—Ä–µ–º—è_–æ—Ç–ø—Ä–∞–≤–∫–∏ | –ò–Ω—Ç–µ—Ä–≤–∞–ª |
|:---------------:|:---------------:|:---------------:|:---------------:|
| student_15 | 1.2  | 2020-05-20 12:35:57 | -        |
| student_15 | 2.4  | 2020-06-08 07:10:24 | 19       |
| student_15 | 2.2  | 2020-08-18 12:47:03 | 72       |
| student_18 | 1.2  | 2020-04-17 03:22:14 | -        |
| student_18 | 2.2  | 2020-06-18 07:25:44 | 63       |
| student_18 | 2.4  | 2020-06-18 07:34:14 | 1        |
| student_20 | 1.2  | 2020-05-28 12:08:53 | -        |
| student_20 | 2.2  | 2020-06-17 15:55:29 | 21       |
| student_20 | 2.4  | 2020-06-18 09:48:39 | 1        |
| student_23 | 1.2  | 2020-05-24 18:15:27 | -        |
| student_23 | 2.2  | 2020-06-01 04:37:16 | 8        |
| student_23 | 2.4  | 2020-06-01 04:42:36 | 1        |
| student_24 | 1.2  | 2020-04-14 16:16:22 | -        |
| student_24 | 2.2  | 2020-05-11 12:28:49 | 27       |
| student_24 | 2.4  | 2020-05-13 12:20:39 | 2        |
| student_27 | 1.2  | 2020-08-12 10:18:47 | -        |
| student_27 | 2.2  | 2020-08-14 17:14:51 | 3        |
| student_27 | 2.4  | 2020-08-20 12:23:34 | 6        |
| student_30 | 1.2  | 2020-08-10 08:38:49 | -        |
| student_30 | 2.2  | 2020-08-16 12:53:39 | 7        |
| student_30 | 2.4  | 2020-08-19 11:41:49 | 3        |
| student_31 | 1.2  | 2020-06-13 09:03:39 | -        |
| student_31 | 2.2  | 2020-07-02 16:43:36 | 20       |
| student_31 | 2.4  | 2020-07-05 17:18:56 | 4        |
| student_36 | 1.2  | 2020-08-04 07:25:30 | -        |
| student_36 | 2.2  | 2020-08-07 11:39:12 | 4        |
| student_36 | 2.4  | 2020-08-07 20:33:02 | 1        |
| student_39 | 1.2  | 2020-05-31 12:35:10 | -        |
| student_39 | 2.2  | 2020-06-02 09:47:15 | 2        |
| student_39 | 2.4  | 2020-06-02 17:06:41 | 1        |
| student_4  | 1.2  | 2020-05-31 17:46:27 | -        |
| student_4  | 2.2  | 2020-07-27 17:12:45 | 57       |
| student_4  | 2.4  | 2020-07-29 09:21:24 | 2        |
| student_43 | 1.2  | 2020-07-16 21:19:13 | -        |
| student_43 | 2.4  | 2020-08-06 13:02:44 | 21       |
| student_43 | 2.2  | 2020-08-08 20:11:52 | 3        |
| student_44 | 1.2  | 2020-05-26 14:23:39 | -        |
| student_44 | 2.2  | 2020-06-02 11:07:52 | 7        |
| student_44 | 2.4  | 2020-06-06 21:57:20 | 5        |
| student_46 | 1.2  | 2020-05-26 13:02:10 | -        |
| student_46 | 2.4  | 2020-06-03 20:30:01 | 9        |
| student_46 | 2.2  | 2020-06-03 20:54:34 | 1        |
| student_49 | 1.2  | 2020-07-11 16:31:12 | -        |
| student_49 | 2.2  | 2020-07-15 05:00:03 | 4        |
| student_49 | 2.4  | 2020-07-16 04:57:51 | 1        |
| student_50 | 1.2  | 2020-07-01 08:16:41 | -        |
| student_50 | 2.2  | 2020-08-10 08:26:49 | 41       |
| student_50 | 2.4  | 2020-09-09 12:44:00 | 31       |
| student_51 | 1.2  | 2020-09-03 07:24:26 | -        |
| student_51 | 2.2  | 2020-09-07 19:31:01 | 5        |
| student_51 | 2.4  | 2020-09-10 13:12:11 | 3        |
| student_52 | 1.2  | 2020-08-24 18:30:55 | -        |
| student_52 | 2.2  | 2020-09-07 13:51:02 | 14       |
| student_52 | 2.4  | 2020-09-07 22:16:19 | 1        |
| student_53 | 1.2  | 2020-07-11 09:32:33 | -        |
| student_53 | 2.2  | 2020-07-17 12:34:54 | 7        |
| student_53 | 2.4  | 2020-07-19 05:09:32 | 2        |
| student_56 | 1.2  | 2020-07-15 12:20:48 | -        |
| student_56 | 2.2  | 2020-08-06 10:22:13 | 22       |
| student_56 | 2.4  | 2020-08-20 09:18:46 | 14       |
| student_59 | 1.2  | 2020-08-17 19:29:09 | -        |
| student_59 | 2.2  | 2020-08-21 10:35:18 | 4        |
| student_59 | 2.4  | 2020-08-22 10:39:29 | 2        |
| student_60 | 1.2  | 2020-09-01 12:54:58 | -        |
| student_60 | 2.2  | 2020-09-02 15:34:45 | 2        |
| student_60 | 2.4  | 2020-09-03 10:53:13 | 1        |
| student_9  | 1.2  | 2020-05-01 05:40:11 | -        |
| student_9  | 2.2  | 2020-05-05 09:29:20 | 5        |
| student_9  | 2.4  | 2020-05-06 10:52:38 | 2        |

Affected rows: 69

---

‚ú≥ –®–∞–≥ 12. 

‚ùì*–ó–∞–¥–∞–Ω–∏–µ. –î–ª—è —Å—Ç—É–¥–µ–Ω—Ç–∞ —Å –∏–º–µ–Ω–µ–º student_59 –≤—ã–≤–µ—Å—Ç–∏ —Å–ª–µ–¥—É—é—â—É—é –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é –ø–æ –≤—Å–µ–º –µ–≥–æ –ø–æ–ø—ã—Ç–∫–∞–º:*
*+ –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è –æ —à–∞–≥–µ: –Ω–æ–º–µ—Ä –º–æ–¥—É–ª—è, —Å–∏–º–≤–æ–ª '.', –ø–æ–∑–∏—Ü–∏—è —É—Ä–æ–∫–∞ –≤ –º–æ–¥—É–ª–µ, —Å–∏–º–≤–æ–ª '.', –ø–æ–∑–∏—Ü–∏—è —à–∞–≥–∞ –≤ –º–æ–¥—É–ª–µ;*
*+ –ø–æ—Ä—è–¥–∫–æ–≤—ã–π –Ω–æ–º–µ—Ä –ø–æ–ø—ã—Ç–∫–∏ –¥–ª—è –∫–∞–∂–¥–æ–≥–æ —à–∞–≥–∞ - –æ–ø—Ä–µ–¥–µ–ª—è–µ—Ç—Å—è –ø–æ –≤–æ–∑—Ä–∞—Å—Ç–∞–Ω–∏—é –≤—Ä–µ–º–µ–Ω–∏ –æ—Ç–ø—Ä–∞–≤–∫–∏ –ø–æ–ø—ã—Ç–∫–∏;*
*+ —Ä–µ–∑—É–ª—å—Ç–∞—Ç –ø–æ–ø—ã—Ç–∫–∏;*
*+ –≤—Ä–µ–º—è –ø–æ–ø—ã—Ç–∫–∏ (–ø—Ä–µ–æ–±—Ä–∞–∑–æ–≤–∞–Ω–Ω–æ–µ –∫ —Ñ–æ—Ä–º–∞—Ç—É –≤—Ä–µ–º–µ–Ω–∏) - –æ–ø—Ä–µ–¥–µ–ª—è–µ—Ç—Å—è –∫–∞–∫ —Ä–∞–∑–Ω–æ—Å—Ç—å –º–µ–∂–¥—É –≤—Ä–µ–º–µ–Ω–µ–º –æ—Ç–ø—Ä–∞–≤–∫–∏ –ø–æ–ø—ã—Ç–∫–∏ –∏ –≤—Ä–µ–º–µ–Ω–∏ –µ–µ –Ω–∞—á–∞–ª–∞, –≤ —Å–ª—É—á–∞–µ –µ—Å–ª–∏ –ø–æ–ø—ã—Ç–∫–∞ –¥–ª–∏–ª–∞—Å—å –±–æ–ª–µ–µ 1 —á–∞—Å–∞, —Ç–æ –≤—Ä–µ–º—è –ø–æ–ø—ã—Ç–∫–∏ –∑–∞–º–µ–Ω–∏—Ç—å –Ω–∞ —Å—Ä–µ–¥–Ω–µ–µ –≤—Ä–µ–º—è –≤—Å–µ—Ö –ø–æ–ø—ã—Ç–æ–∫ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è –ø–æ –≤—Å–µ–º —à–∞–≥–∞–º –±–µ–∑ —É—á–µ—Ç–∞ —Ç–µ—Ö, –∫–æ—Ç–æ—Ä—ã–µ –¥–ª–∏–ª–∏—Å—å –±–æ–ª—å—à–µ 1 —á–∞—Å–∞;*
*+ –æ—Ç–Ω–æ—Å–∏—Ç–µ–ª—å–Ω–æ–µ –≤—Ä–µ–º—è –ø–æ–ø—ã—Ç–∫–∏  - –æ–ø—Ä–µ–¥–µ–ª—è–µ—Ç—Å—è –∫–∞–∫ –æ—Ç–Ω–æ—à–µ–Ω–∏–µ –≤—Ä–µ–º–µ–Ω–∏ –ø–æ–ø—ã—Ç–∫–∏ (—Å —É—á–µ—Ç–æ–º –∑–∞–º–µ–Ω—ã –≤—Ä–µ–º–µ–Ω–∏ –ø–æ–ø—ã—Ç–∫–∏) –∫ —Å—É–º–º–∞—Ä–Ω–æ–º—É –≤—Ä–µ–º–µ–Ω–∏ –≤—Å–µ—Ö –ø–æ–ø—ã—Ç–æ–∫  —à–∞–≥–∞, –æ–∫—Ä—É–≥–ª–µ–Ω–Ω–æ–µ –¥–æ –¥–≤—É—Ö –∑–Ω–∞–∫–æ–≤ –ø–æ—Å–ª–µ –∑–∞–ø—è—Ç–æ–π .*
*–°—Ç–æ–ª–±—Ü—ã –Ω–∞–∑–≤–∞—Ç—å  –°—Ç—É–¥–µ–Ω—Ç,  –®–∞–≥, –ù–æ–º–µ—Ä_–ø–æ–ø—ã—Ç–∫–∏, –†–µ–∑—É–ª—å—Ç–∞—Ç, –í—Ä–µ–º—è_–ø–æ–ø—ã—Ç–∫–∏ –∏ –û—Ç–Ω–æ—Å–∏—Ç–µ–ª—å–Ω–æ–µ_–≤—Ä–µ–º—è. –ò–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é –æ—Ç—Å–æ—Ä—Ç–∏—Ä–æ–≤–∞—Ç—å —Å–Ω–∞—á–∞–ª–∞ –ø–æ –≤–æ–∑—Ä–∞—Å—Ç–∞–Ω–∏—é id —à–∞–≥–∞, –∞ –∑–∞—Ç–µ–º –ø–æ –≤–æ–∑—Ä–∞—Å—Ç–∞–Ω–∏—é –Ω–æ–º–µ—Ä–∞ –ø–æ–ø—ã—Ç–∫–∏ (–æ–ø—Ä–µ–¥–µ–ª—è–µ—Ç—Å—è –ø–æ –≤—Ä–µ–º–µ–Ω–∏ –æ—Ç–ø—Ä–∞–≤–∫–∏ –ø–æ–ø—ã—Ç–∫–∏).  
–í–∞–∂–Ω–æ. –í—Å–µ –≤—ã—á–∏—Å–ª–µ–Ω–∏—è –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç—å –≤ —Å–µ–∫—É–Ω–¥–∞—Ö, –æ–∫—Ä—É–≥–ª—è—Ç—å –∏ –ø–µ—Ä–µ–≤–æ–¥–∏—Ç—å –≤–æ –≤—Ä–µ–º–µ–Ω–Ω–æ–π —Ñ–æ—Ä–º–∞—Ç —Ç–æ–ª—å–∫–æ –¥–ª—è –≤—ã–≤–æ–¥–∞ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–∞.*

*–§—Ä–∞–≥–º–µ–Ω—Ç –ª–æ–≥–∏—á–µ—Å–∫–æ–π —Å—Ö–µ–º—ã –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö:*

![](https://ucarecdn.com/a1d75640-3d9e-4f16-9f02-2868a5a9570e/)

‚úî`–†–ï–®–ï–ù–ò–ï` ‚§µÔ∏è

```sql
WITH res_tab AS(
  SELECT 
    student_name AS –°—Ç—É–¥–µ–Ω—Ç, 
    CONCAT(
      module_id, '.', lesson_position, '.', 
      step_position
    ) AS –®–∞–≥, 
    ROW_NUMBER() OVER(
      PARTITION BY step_id 
      ORDER BY 
        submission_time
    ) AS –ù–æ–º–µ—Ä_–ø–æ–ø—ã—Ç–∫–∏, 
    result AS –†–µ–∑—É–ª—å—Ç–∞—Ç, 
    CASE WHEN submission_time - attempt_time > 3600 THEN (
      SELECT 
        AVG(submission_time - attempt_time) 
      FROM 
        step_student 
        JOIN student ON step_student.student_id = student.student_id 
        AND student_name = 'student_59' 
      WHERE 
        submission_time - attempt_time <= 3600
    ) ELSE submission_time - attempt_time END AS timestamp_attempt, 
    step_id, 
    submission_time 
  FROM 
    step_student 
    JOIN student ON step_student.student_id = student.student_id 
    AND student_name = 'student_59' 
    JOIN step USING(step_id) 
    JOIN lesson USING(lesson_id)
) 
SELECT 
  –°—Ç—É–¥–µ–Ω—Ç, 
  –®–∞–≥, 
  –ù–æ–º–µ—Ä_–ø–æ–ø—ã—Ç–∫–∏, 
  –†–µ–∑—É–ª—å—Ç–∞—Ç, 
  SEC_TO_TIME(
    round(timestamp_attempt)
  ) AS –í—Ä–µ–º—è_–ø–æ–ø—ã—Ç–∫–∏, 
  ROUND(
    timestamp_attempt / (
      SUM(timestamp_attempt) OVER(PARTITION BY –®–∞–≥)
    ) * 100, 
    2
  ) AS –û—Ç–Ω–æ—Å–∏—Ç–µ–ª—å–Ω–æ–µ_–≤—Ä–µ–º—è 
FROM 
  res_tab 
ORDER BY 
  step_id, 
  submission_time;
```

üîé `–†–ï–ó–£–õ–¨–¢–ê–¢` ‚§µÔ∏è

| –°—Ç—É–¥–µ–Ω—Ç    | –®–∞–≥    | –ù–æ–º–µ—Ä_–ø–æ–ø—ã—Ç–∫–∏ | –†–µ–∑—É–ª—å—Ç–∞—Ç | –í—Ä–µ–º—è_–ø–æ–ø—ã—Ç–∫–∏ | –û—Ç–Ω–æ—Å–∏—Ç–µ–ª—å–Ω–æ–µ_–≤—Ä–µ–º—è |
|:---------------:|:---------------:|:---------------:|:---------------:|:---------------:|:---------------:|
| student_59 | 1.2.2  | 1             | correct   | 0:00:28       | 100.00              |
| student_59 | 1.2.3  | 1             | correct   | 0:01:11       | 100.00              |
| student_59 | 1.2.4  | 1             | correct   | 0:06:09       | 100.00              |
| student_59 | 1.2.5  | 1             | correct   | 0:02:24       | 100.00              |
| student_59 | 1.2.6  | 1             | wrong     | 0:09:42       | 90.37               |
| student_59 | 1.2.6  | 2             | wrong     | 0:00:05       | 0.78                |
| student_59 | 1.2.6  | 3             | wrong     | 0:00:23       | 3.57                |
| student_59 | 1.2.6  | 4             | wrong     | 0:00:10       | 1.55                |
| student_59 | 1.2.6  | 5             | correct   | 0:00:20       | 3.11                |
|...| | | | | |
| student_59 | 2.4.7  | 1             | correct   | 0:21:18       | 100.00              |
| student_59 | 2.4.8  | 1             | correct   | 0:33:02       | 100.00              |
| student_59 | 2.4.9  | 1             | wrong     | 0:18:12       | 71.75               |
| student_59 | 2.4.9  | 2             | correct   | 0:07:10       | 28.25               |
| student_59 | 2.4.10 | 1             | correct   | 0:05:32       | 100.00              |
| student_59 | 2.4.11 | 1             | correct   | 0:40:27       | 100.00              |
| student_59 | 2.4.12 | 1             | correct   | 0:07:10       | 100.00              |
| student_59 | 2.4.13 | 1             | correct   | 0:07:15       | 100.00              |

Affected rows: 58

---

‚ú≥ –®–∞–≥ 13. 

‚ùì*–ó–∞–¥–∞–Ω–∏–µ. Online –∫—É—Ä—Å –æ–±—É—á–∞—é—â–∏–µ—Å—è –º–æ–≥—É—Ç –ø—Ä–æ—Ö–æ–¥–∏—Ç—å –ø–æ —Ä–∞–∑–ª–∏—á–Ω—ã–º —Ç—Ä–∞–µ–∫—Ç–æ—Ä–∏—è–º, –ø—Ä–æ—Å–ª–µ–¥–∏—Ç—å –∑–∞ –∫–æ—Ç–æ—Ä—ã–º–∏ –º–æ–∂–Ω–æ –ø–æ —Å–ø–æ—Å–æ–±—É —Ä–µ—à–µ–Ω–∏—è –∏–º–∏ –∑–∞–¥–∞–Ω–∏–π —à–∞–≥–æ–≤ –∫—É—Ä—Å–∞. –ë–æ–ª—å—à–∏–Ω—Å—Ç–≤–æ –æ–±—É—á–∞—é—â–∏—Ö—Å—è –∑–∞ –Ω–µ—Å–∫–æ–ª—å–∫–æ –ø–æ–ø—ã—Ç–æ–∫ –ø–æ–ª—É—á–∞—é—Ç –ø—Ä–∞–≤–∏–ª—å–Ω—ã–π –æ—Ç–≤–µ—Ç –∏ –ø–µ—Ä–µ—Ö–æ–¥—è—Ç –∫ —Å–ª–µ–¥—É—é—â–µ–º—É —à–∞–≥—É. –ù–æ –µ—Å—Ç—å —Ç–∞–∫–∏–µ, —á—Ç–æ –æ—Å—Ç–∞—é—Ç—Å—è –Ω–∞ —à–∞–≥–µ, –≤—ã–ø–æ–ª–Ω—è—è –Ω–µ—Å–∫–æ–ª—å–∫–æ –≤–µ—Ä–Ω—ã—Ö –ø–æ–ø—ã—Ç–æ–∫, –∏–ª–∏ –ø–µ—Ä–µ—Ö–æ–¥—è—Ç –∫ —Å–ª–µ–¥—É—é—â–µ–º—É, –æ—Å—Ç–∞–≤–∏–≤ –Ω–µ—Ä–µ—à–µ–Ω–Ω—ã–µ —à–∞–≥–∏.  
–í—ã–¥–µ–ª–∏–≤ —ç—Ç–∏ "–Ω–µ–æ–±—ã—á–Ω—ã–µ" –¥–µ–π—Å—Ç–≤–∏—è –æ–±—É—á–∞—é—â–∏—Ö—Å—è, –º–æ–∂–Ω–æ –ø—Ä–æ—Å–ª–µ–¥–∏—Ç—å –∏—Ö —Ç—Ä–∞–µ–∫—Ç–æ—Ä–∏—é —Ä–∞–±–æ—Ç—ã —Å –∫—É—Ä—Å–æ–º –∏ –ø—Ä–æ–∞–Ω–∞–ª–∏–∑–∏—Ä–æ–≤–∞—Ç—å –∑–∞–¥–∞–Ω–∏—è, –¥–ª—è –∫–æ—Ç–æ—Ä—ã—Ö —ç—Ç–∏ –¥–µ–π—Å—Ç–≤–∏—è –≤—ã–ø–æ–ª–Ω—è–ª–∏—Å—å, –∞ –∑–∞—Ç–µ–º –∏—Ö –∫–∞–∫-—Ç–æ –∏–∑–º–µ–Ω–∏—Ç—å.   
–î–ª—è —ç—Ç–æ–π —Ü–µ–ª–∏ –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ –≤—ã–¥–µ–ª–∏—Ç—å –≥—Ä—É–ø–ø—ã –æ–±—É—á–∞—é—â–∏—Ö—Å—è –ø–æ —Å–ø–æ—Å–æ–±—É –ø—Ä–æ—Ö–æ–∂–¥–µ–Ω–∏—è —à–∞–≥–æ–≤:*
*+ I –≥—Ä—É–ø–ø–∞ - —ç—Ç–æ —Ç–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–∏, –∫–æ—Ç–æ—Ä—ã–µ –ø–æ—Å–ª–µ –≤–µ—Ä–Ω–æ–π –ø–æ–ø—ã—Ç–∫–∏ —Ä–µ—à–µ–Ω–∏—è —à–∞–≥–∞ –¥–µ–ª–∞—é—Ç –Ω–µ–≤–µ—Ä–Ω—É—é (—Å–∫–æ—Ä–µ–µ –≤—Å–µ–≥–æ –¥–ª—è —Ç–æ–≥–æ, —á—Ç–æ–±—ã –ø–æ—ç–∫—Å–ø–µ—Ä–∏–º–µ–Ω—Ç–∏—Ä–æ–≤–∞—Ç—å –∏–ª–∏ –ø—Ä–æ–≤–µ—Ä–∏—Ç—å, –∫–∞–∫ —Ä–∞–±–æ—Ç–∞—é—Ç –ø—Ä–∏–º–µ—Ä—ã);*
*+ II –≥—Ä—É–ø–ø–∞ - —ç—Ç–æ —Ç–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–∏, –∫–æ—Ç–æ—Ä—ã–µ –¥–µ–ª–∞—é—Ç –±–æ–ª—å—à–µ –æ–¥–Ω–æ–π –≤–µ—Ä–Ω–æ–π –ø–æ–ø—ã—Ç–∫–∏ –¥–ª—è –æ–¥–Ω–æ–≥–æ —à–∞–≥–∞ (–≤–æ–∑–º–æ–∂–Ω–æ, —É–ª—É—á—à–∞—é—Ç —Å–≤–æ–µ —Ä–µ—à–µ–Ω–∏–µ –∏–ª–∏ –ø—Ä–æ–±—É—é—Ç –¥—Ä—É–≥–æ–π –≤–∞—Ä–∏–∞–Ω—Ç);*
*+ III –≥—Ä—É–ø–ø–∞ - —ç—Ç–æ —Ç–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–∏, –∫–æ—Ç–æ—Ä—ã–µ –Ω–µ —Å–º–æ–≥–ª–∏ —Ä–µ—à–∏—Ç—å –∑–∞–¥–∞–Ω–∏–µ –∫–∞–∫–æ–≥–æ-—Ç–æ —à–∞–≥–∞ (—É –Ω–∏—Ö –≤—Å–µ –ø–æ–ø—ã—Ç–∫–∏ –ø–æ —ç—Ç–æ–º—É —à–∞–≥—É - –Ω–µ–≤–µ—Ä–Ω—ã–µ).*
*–í—ã–≤–µ—Å—Ç–∏ –≥—Ä—É–ø–ø—É (I, II, III), –∏–º—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è, –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ —à–∞–≥–æ–≤, –∫–æ—Ç–æ—Ä—ã–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –≤—ã–ø–æ–ª–Ω–∏–ª –ø–æ —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤—É—é—â–µ–º—É —Å–ø–æ—Å–æ–±—É. –°—Ç–æ–ª–±—Ü—ã –Ω–∞–∑–≤–∞—Ç—å –ì—Ä—É–ø–ø–∞, –°—Ç—É–¥–µ–Ω—Ç, –ö–æ–ª–∏—á–µ—Å—Ç–≤–æ_—à–∞–≥–æ–≤. –û—Ç—Å–æ—Ä—Ç–∏—Ä–æ–≤–∞—Ç—å –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é –ø–æ –≤–æ–∑—Ä–∞—Å—Ç–∞–Ω–∏—é –Ω–æ–º–µ—Ä–æ–≤ –≥—Ä—É–ø–ø, –ø–æ—Ç–æ–º –ø–æ —É–±—ã–≤–∞–Ω–∏—é –∫–æ–ª–∏—á–µ—Å—Ç–≤–∞ —à–∞–≥–æ–≤ –∏, –Ω–∞–∫–æ–Ω–µ—Ü, –ø–æ –∏–º–µ–Ω–∏ —Å—Ç—É–¥–µ–Ω—Ç–∞ –≤ –∞–ª—Ñ–∞–≤–∏—Ç–Ω–æ–º –ø–æ—Ä—è–¥–∫–µ.*

*–§—Ä–∞–≥–º–µ–Ω—Ç –ª–æ–≥–∏—á–µ—Å–∫–æ–π —Å—Ö–µ–º—ã –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö:*

![](https://ucarecdn.com/c91b0e6e-cd41-495e-857e-89c3630da9ce/)

‚úî`–†–ï–®–ï–ù–ò–ï` ‚§µÔ∏è

```sql
WITH qr AS (
  SELECT 
    student_name, 
    step_id, 
    count(result) AS sm 
  FROM 
    step_student 
    INNER JOIN student USING(student_id) 
  WHERE 
    result = "correct" 
  GROUP BY 
    1, 
    2 
  HAVING 
    count(result) > 1
) 
SELECT 
  "I" AS –ì—Ä—É–ø–ø–∞, 
  student_name AS –°—Ç—É–¥–µ–Ω—Ç, 
  count(step_id) AS –ö–æ–ª–∏—á–µ—Å—Ç–≤–æ_—à–∞–≥–æ–≤ 
FROM 
  (
    SELECT 
      student_name, 
      step_id, 
      IF(
        result = "correct" 
        AND submission_time < MAX(submission_time) OVER (
          PARTITION BY student_name, step_id
        ), 
        IF(
          LEAD(result) OVER (
            PARTITION BY student_id, 
            step_id 
            ORDER BY 
              submission_time
          ) = "wrong", 
          1, 
          0
        ), 
        0
      ) AS change_res 
    FROM 
      step_student 
      INNER JOIN student USING(student_id)
  ) qr1 
WHERE 
  change_res = 1 
GROUP BY 
  1, 
  2 
UNION 
SELECT 
  "II" AS –ì—Ä—É–ø–ø–∞, 
  student_name AS –°—Ç—É–¥–µ–Ω—Ç, 
  count(step_id) AS –ö–æ–ª–∏—á–µ—Å—Ç–≤–æ_—à–∞–≥–æ–≤ 
FROM 
  qr 
GROUP BY 
  1, 
  2 
UNION 
SELECT 
  "III" AS –ì—Ä—É–ø–ø–∞, 
  student_name AS –°—Ç—É–¥–µ–Ω—Ç, 
  count(DISTINCT step_id) AS –ö–æ–ª–∏—á–µ—Å—Ç–≤–æ_—à–∞–≥–æ–≤ 
FROM 
  (
    SELECT 
      student_id, 
      step_id, 
      SUM(new_result) OVER (PARTITION BY student_id, step_id) AS sum_result 
    FROM 
      (
        SELECT 
          student_id, 
          step_id, 
          IF(result = "wrong", 0, 1) AS new_result 
        FROM 
          step_student
      ) qr_1
  ) qr_2 
  INNER JOIN student USING(student_id) 
WHERE 
  sum_result = 0 
GROUP BY 
  student_id 
ORDER BY 
  –ì—Ä—É–ø–ø–∞, 
  –ö–æ–ª–∏—á–µ—Å—Ç–≤–æ_—à–∞–≥–æ–≤ DESC, 
  –°—Ç—É–¥–µ–Ω—Ç;
```

üîé `–†–ï–ó–£–õ–¨–¢–ê–¢` ‚§µÔ∏è

| –ì—Ä—É–ø–ø–∞ | –°—Ç—É–¥–µ–Ω—Ç    | –ö–æ–ª–∏—á–µ—Å—Ç–≤–æ_—à–∞–≥–æ–≤ |
|:---------------:|:---------------:|:---------------:|
| I      | student_15 | 2                |
| I      | student_53 | 2                |
| I      | student_11 | 1                |
|...| | |
| I      | student_9  | 1                |
| II     | student_53 | 4                |
| II     | student_62 | 4                |
| II     | student_34 | 3                |
|...| | |
| II     | student_59 | 1                |
| III    | student_24 | 3                |
| III    | student_33 | 1                |
| III    | student_42 | 1                |
|...| | |
| III    | student_64 | 1                |

Affected rows: 32

---